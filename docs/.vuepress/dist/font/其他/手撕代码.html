<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é˜²æŠ– | niping</title>
    <meta name="description" content="æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b8bd58f1.css" as="style"><link rel="preload" href="/assets/js/app.7836fe28.js" as="script"><link rel="preload" href="/assets/js/53.98ecd027.js" as="script"><link rel="prefetch" href="/assets/js/10.c433b941.js"><link rel="prefetch" href="/assets/js/11.78f91ed6.js"><link rel="prefetch" href="/assets/js/12.df5475c2.js"><link rel="prefetch" href="/assets/js/13.41d08b96.js"><link rel="prefetch" href="/assets/js/14.abcfa551.js"><link rel="prefetch" href="/assets/js/15.205c88f3.js"><link rel="prefetch" href="/assets/js/16.989479ab.js"><link rel="prefetch" href="/assets/js/17.35992cfd.js"><link rel="prefetch" href="/assets/js/18.ea4e034b.js"><link rel="prefetch" href="/assets/js/19.e889c3e2.js"><link rel="prefetch" href="/assets/js/2.4b506110.js"><link rel="prefetch" href="/assets/js/20.28fbfba3.js"><link rel="prefetch" href="/assets/js/21.34c60ffc.js"><link rel="prefetch" href="/assets/js/22.a8091b60.js"><link rel="prefetch" href="/assets/js/23.facd3e00.js"><link rel="prefetch" href="/assets/js/24.ab71a30c.js"><link rel="prefetch" href="/assets/js/25.9ac3cb6f.js"><link rel="prefetch" href="/assets/js/26.b99ab8b7.js"><link rel="prefetch" href="/assets/js/27.181d22b1.js"><link rel="prefetch" href="/assets/js/28.4e55ec8d.js"><link rel="prefetch" href="/assets/js/29.46f4b066.js"><link rel="prefetch" href="/assets/js/3.0ccaa1d3.js"><link rel="prefetch" href="/assets/js/30.e508f399.js"><link rel="prefetch" href="/assets/js/31.55a6e3ed.js"><link rel="prefetch" href="/assets/js/32.4a3aab84.js"><link rel="prefetch" href="/assets/js/33.c3d819b6.js"><link rel="prefetch" href="/assets/js/34.fa39303b.js"><link rel="prefetch" href="/assets/js/35.4b3326b2.js"><link rel="prefetch" href="/assets/js/36.74987247.js"><link rel="prefetch" href="/assets/js/37.a8655aa5.js"><link rel="prefetch" href="/assets/js/38.2de28a47.js"><link rel="prefetch" href="/assets/js/39.3cb80cc3.js"><link rel="prefetch" href="/assets/js/4.8a9ecca9.js"><link rel="prefetch" href="/assets/js/40.a4843f87.js"><link rel="prefetch" href="/assets/js/41.79f42584.js"><link rel="prefetch" href="/assets/js/42.67c05d6b.js"><link rel="prefetch" href="/assets/js/43.3389b7f0.js"><link rel="prefetch" href="/assets/js/44.fe39fe73.js"><link rel="prefetch" href="/assets/js/45.074d929e.js"><link rel="prefetch" href="/assets/js/46.26c07509.js"><link rel="prefetch" href="/assets/js/47.6e51d026.js"><link rel="prefetch" href="/assets/js/48.567ae907.js"><link rel="prefetch" href="/assets/js/49.5c7f31b4.js"><link rel="prefetch" href="/assets/js/5.3285a9a3.js"><link rel="prefetch" href="/assets/js/50.c3a88b26.js"><link rel="prefetch" href="/assets/js/51.5d229e3b.js"><link rel="prefetch" href="/assets/js/52.07d764b4.js"><link rel="prefetch" href="/assets/js/54.cc309f5b.js"><link rel="prefetch" href="/assets/js/55.21586719.js"><link rel="prefetch" href="/assets/js/56.182245b3.js"><link rel="prefetch" href="/assets/js/57.ae874f8f.js"><link rel="prefetch" href="/assets/js/58.ed53320d.js"><link rel="prefetch" href="/assets/js/59.ce5dd494.js"><link rel="prefetch" href="/assets/js/6.dd55117b.js"><link rel="prefetch" href="/assets/js/60.97469c61.js"><link rel="prefetch" href="/assets/js/61.e220c125.js"><link rel="prefetch" href="/assets/js/62.4701028d.js"><link rel="prefetch" href="/assets/js/63.b0b429c7.js"><link rel="prefetch" href="/assets/js/64.0bd3de2c.js"><link rel="prefetch" href="/assets/js/65.2b015bc7.js"><link rel="prefetch" href="/assets/js/66.533a402b.js"><link rel="prefetch" href="/assets/js/67.126f5e8b.js"><link rel="prefetch" href="/assets/js/68.652b5360.js"><link rel="prefetch" href="/assets/js/69.75774077.js"><link rel="prefetch" href="/assets/js/7.322e74d0.js"><link rel="prefetch" href="/assets/js/70.bdade440.js"><link rel="prefetch" href="/assets/js/71.1387a4ba.js"><link rel="prefetch" href="/assets/js/72.69372169.js"><link rel="prefetch" href="/assets/js/73.fa8efea0.js"><link rel="prefetch" href="/assets/js/74.343fce91.js"><link rel="prefetch" href="/assets/js/75.c193bd6b.js"><link rel="prefetch" href="/assets/js/76.fbdb7da9.js"><link rel="prefetch" href="/assets/js/77.4696d95e.js"><link rel="prefetch" href="/assets/js/78.bd60bd08.js"><link rel="prefetch" href="/assets/js/79.022ab51b.js"><link rel="prefetch" href="/assets/js/8.b7ac6d7e.js"><link rel="prefetch" href="/assets/js/80.abec6d3e.js"><link rel="prefetch" href="/assets/js/81.7beed379.js"><link rel="prefetch" href="/assets/js/82.a2648f48.js"><link rel="prefetch" href="/assets/js/83.2a2354b0.js"><link rel="prefetch" href="/assets/js/84.94e2858b.js"><link rel="prefetch" href="/assets/js/85.bbd550d2.js"><link rel="prefetch" href="/assets/js/86.6d1399f0.js"><link rel="prefetch" href="/assets/js/87.37589e20.js"><link rel="prefetch" href="/assets/js/88.97333aa4.js"><link rel="prefetch" href="/assets/js/89.6cdbe3c7.js"><link rel="prefetch" href="/assets/js/9.765a7ba6.js"><link rel="prefetch" href="/assets/js/90.ff06779b.js"><link rel="prefetch" href="/assets/js/91.1526493e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8bd58f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">niping</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">å‰ç«¯</a></div><div class="nav-item"><a href="/computer/" class="nav-link">è®¡ç®—æœº</a></div><div class="nav-item"><a href="/other/" class="nav-link">ä¸ªäººå­¦ä¹ ç¬”è®°</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å…³äºæˆ‘</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">å‰ç«¯</a></div><div class="nav-item"><a href="/computer/" class="nav-link">è®¡ç®—æœº</a></div><div class="nav-item"><a href="/other/" class="nav-link">ä¸ªäººå­¦ä¹ ç¬”è®°</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å…³äºæˆ‘</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>æµè§ˆå™¨ç½‘ç»œ</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>å…¶ä»–</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/font/å…¶ä»–/Nginxåå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡.html" class="sidebar-link">Nginxåå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡</a></li><li><a href="/font/å…¶ä»–/PCç«¯ä¸ç§»åŠ¨ç«¯å¼€å‘åŒºåˆ«.html" class="sidebar-link">PCç«¯ä¸ç§»åŠ¨ç«¯å¼€å‘åŒºåˆ«</a></li><li><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html" class="active sidebar-link">æ‰‹æ’•ä»£ç </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#é˜²æŠ–" class="sidebar-link">é˜²æŠ–</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#èŠ‚æµ" class="sidebar-link">èŠ‚æµ</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#æ·±æ‹·è´" class="sidebar-link">æ·±æ‹·è´</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#instanceof" class="sidebar-link">instanceof</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#new" class="sidebar-link">new</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#call" class="sidebar-link">call</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#apply" class="sidebar-link">apply</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#bind" class="sidebar-link">bind</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#å®ç°ä¸€ä¸ªevent" class="sidebar-link">å®ç°ä¸€ä¸ªEvent</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#ç»§æ‰¿" class="sidebar-link">ç»§æ‰¿</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#promise" class="sidebar-link">Promise</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#json-parse" class="sidebar-link">JSON.parse</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#json-stringify" class="sidebar-link">JSON.stringify</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#å‡½æ•°æŸ¯é‡ŒåŒ–" class="sidebar-link">å‡½æ•°æŸ¯é‡ŒåŒ–</a></li><li class="sidebar-sub-header"><a href="/font/å…¶ä»–/æ‰‹æ’•ä»£ç .html#æ•°ç»„æ‰å¹³åŒ–" class="sidebar-link">æ•°ç»„æ‰å¹³åŒ–</a></li></ul></li><li><a href="/font/å…¶ä»–/å®ç°ä¸€ä¸ªEvent.html" class="sidebar-link">å®ç°ä¸€ä¸ªEvent</a></li><li><a href="/font/å…¶ä»–/å®ç°æ·±å…‹éš†.html" class="sidebar-link">å®ç°æ·±å…‹éš†</a></li><li><a href="/font/å…¶ä»–/å‰ç«¯å·¥ç¨‹åŒ–.html" class="sidebar-link">å‰ç«¯å·¥ç¨‹åŒ–</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="é˜²æŠ–"><a href="#é˜²æŠ–" aria-hidden="true" class="header-anchor">#</a> é˜²æŠ–</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// é˜²æŠ–å‡½æ•°ES6</span>
<span class="token keyword">const</span> <span class="token function-variable function">debounce</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//ES5</span>
<span class="token keyword">function</span> <span class="token function">debounce1</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timeout <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="èŠ‚æµ"><a href="#èŠ‚æµ" aria-hidden="true" class="header-anchor">#</a> èŠ‚æµ</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//æ‰‹å†™èŠ‚æµ</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> prev <span class="token operator">&gt;</span> wait<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      prev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//å°çº¢ä¹¦ç‰ˆæœ¬</span>
<span class="token keyword">function</span> <span class="token function">throttle2</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> wait<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">clearTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>tId<span class="token punctuation">)</span>
  fn<span class="token punctuation">.</span>tId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" aria-hidden="true" class="header-anchor">#</a> æ·±æ‹·è´</h2> <p>è¯¦æƒ…è¯·è·³è½¬<a href="/font/å…¶ä»–/å®ç°æ·±å…‹éš†.html">å®ç°æ·±å…‹éš†</a>ä¸€æ–‡</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//ä¹ä¸ç‰ˆ</span>
<span class="token keyword">var</span> newObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span> someObj <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//ç®€å•ç‰ˆå¯¹è±¡æ·±åº¦å…‹éš†</span>
<span class="token keyword">function</span> <span class="token function">deepclone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> newObj <span class="token operator">=</span> obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> temple <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'object'</span> <span class="token operator">?</span> <span class="token function">deepclone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
      newObj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> temple<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="instanceof"><a href="#instanceof" aria-hidden="true" class="header-anchor">#</a> instanceof</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">instanceOf</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token keyword">let</span> right <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> right<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="new"><a href="#new" aria-hidden="true" class="header-anchor">#</a> new</h2> <p><code>new</code>æ“ä½œç¬¦åšäº†è¿™äº›äº‹ï¼š</p> <ul><li>å®ƒåˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ã€‚</li> <li>å®ƒä¼šè¢«æ‰§è¡Œ<code>[[Prototype]]</code>ï¼ˆä¹Ÿå°±æ˜¯<code>__proto__</code>ï¼‰é“¾æ¥ã€‚</li> <li>å®ƒä½¿<code>this</code>æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚ã€‚</li> <li>é€šè¿‡<code>new</code>åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡å°†æœ€ç»ˆè¢«<code>[[Prototype]]</code>é“¾æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„<code>prototype</code>å¯¹è±¡ä¸Šã€‚</li> <li>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹<code>Object</code>(åŒ…å«<code>Functoin, Array, Date, RegExg, Error</code>)ï¼Œé‚£ä¹ˆ<code>new</code>è¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨å°†è¿”å›è¯¥å¯¹è±¡å¼•ç”¨ã€‚</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// å®ç°ä¸€ä¸ªnewæ“ä½œç¬¦</span>
<span class="token keyword">function</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token parameter">func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>func<span class="token punctuation">.</span>prototype <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> func<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> ret <span class="token operator">!==</span> <span class="token string">'function'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> ret <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> ret <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="call"><a href="#call" aria-hidden="true" class="header-anchor">#</a> call</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//æ‰‹å†™ä¸€ä¸ªcall</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">call2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="apply"><a href="#apply" aria-hidden="true" class="header-anchor">#</a> apply</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// æ‰‹å†™ä¸€ä¸ªapply</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">apply2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arguemnts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="bind"><a href="#bind" aria-hidden="true" class="header-anchor">#</a> bind</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// æ‰‹å†™bind</span>
<span class="token comment">//ç®€å•ç‰ˆ</span>
<span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//ä¸€èˆ¬ç‰ˆ</span>
<span class="token keyword">function</span> <span class="token function">bind2</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arg <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newArg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arg <span class="token operator">=</span> arg<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>newArg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">context</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="å®ç°ä¸€ä¸ªevent"><a href="#å®ç°ä¸€ä¸ªevent" aria-hidden="true" class="header-anchor">#</a> å®ç°ä¸€ä¸ªEvent</h2> <p>è¯·è·³è½¬<a href="/font/å…¶ä»–/å®ç°ä¸€ä¸ªEvent.html">å®ç°ä¸€ä¸ªEvent</a>ä¸€æ–‡</p> <h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" aria-hidden="true" class="header-anchor">#</a> ç»§æ‰¿</h2> <h3 id="æ„é€ å‡½æ•°æ–¹å¼"><a href="#æ„é€ å‡½æ•°æ–¹å¼" aria-hidden="true" class="header-anchor">#</a> æ„é€ å‡½æ•°æ–¹å¼</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * å€ŸåŠ©æ„é€ å‡½æ•°å®ç°ç»§æ‰¿
 */</span>
<span class="token keyword">function</span> <span class="token function">Parent1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'parent1'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Parent1</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent1</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'child1'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ğŸ˜‹ä¸Šæ–¹ä»£ç ä¸­ï¼Œæœ€é‡è¦çš„é‚£è¡Œä»£ç ï¼šåœ¨å­ç±»çš„æ„é€ å‡½æ•°é‡Œå†™äº†<code>Parent1.call(this);</code>ï¼Œæ„æ€æ˜¯ï¼š<strong>è®©Parent1çš„æ„é€ å‡½æ•°åœ¨child1çš„æ„é€ å‡½æ•°ä¸­æ‰§è¡Œ</strong>ã€‚å‘ç”Ÿçš„å˜åŒ–æ˜¯ï¼š<strong>æ”¹å˜thisçš„æŒ‡å‘</strong>ï¼Œparentçš„å®ä¾‹ --&gt; æ”¹ä¸ºæŒ‡å‘childçš„å®ä¾‹ã€‚å¯¼è‡´ parent1çš„å®ä¾‹çš„å±æ€§æŒ‚åœ¨åˆ°äº†child1çš„å®ä¾‹ä¸Šï¼Œè¿™å°±å®ç°äº†ç»§æ‰¿ã€‚è¿™ç§æ–¹å¼ï¼Œè™½ç„¶æ”¹å˜äº† this çš„æŒ‡å‘ï¼Œä½†æ˜¯ï¼Œ<strong>Child1 æ— æ³•ç»§æ‰¿ Parent1 çš„åŸå‹</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ç»™ Parent1 çš„åŸå‹å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼ŒåŸå‹çš„æ–¹æ³•æ˜¯æ— æ³•è¢«ç»§æ‰¿çš„ã€‚</p> <h3 id="åŸå‹é“¾æ–¹å¼"><a href="#åŸå‹é“¾æ–¹å¼" aria-hidden="true" class="header-anchor">#</a> åŸå‹é“¾æ–¹å¼</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * å€ŸåŠ©åŸå‹é“¾å®ç°ç»§æ‰¿
 */</span>
<span class="token keyword">function</span> <span class="token function">Parent2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'parent2'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'child2'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child2</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Child2.prototype = Parent2.prototype;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ğŸ˜‹ä¸Šæ–¹ä»£ç ä¸­ï¼Œæœ€é‡è¦çš„é‚£è¡Œï¼šæ¯ä¸ªå‡½æ•°éƒ½æœ‰<code>prototype</code>å±æ€§ï¼Œäºæ˜¯ï¼Œæ„é€ å‡½æ•°ä¹Ÿæœ‰è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ç°åœ¨ï¼Œ<strong>æˆ‘ä»¬æŠŠParent2çš„å®ä¾‹èµ‹å€¼ç»™äº†Child2çš„prototye</strong>ï¼Œä»è€Œå®ç°<strong>ç»§æ‰¿</strong>ã€‚æ­¤æ—¶ï¼Œ<code>Child</code>æ„é€ å‡½æ•°ã€<code>Parent</code>çš„å®ä¾‹ã€<code>Child</code>çš„å®ä¾‹æ„æˆä¸€ä¸ªä¸‰è§’å…³ç³»ã€‚äºæ˜¯ï¼š</p> <ul><li><code>new Child2.__proto__ === new Parent2()</code>çš„ç»“æœä¸ºtrue</li></ul> <h3 id="ç»„åˆæ–¹å¼-å¯„ç”Ÿç»„åˆå¼"><a href="#ç»„åˆæ–¹å¼-å¯„ç”Ÿç»„åˆå¼" aria-hidden="true" class="header-anchor">#</a> ç»„åˆæ–¹å¼(å¯„ç”Ÿç»„åˆå¼)</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * ç»„åˆæ–¹å¼(å¯„ç”Ÿç»„åˆå¼)
 */</span>
<span class="token keyword">function</span> <span class="token function">Parent3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'parent3'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent3</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'Child3'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//Object.createæ˜¯åˆ›å»ºäº†çˆ¶ç±»åŸå‹çš„å‰¯æœ¬ï¼Œä¸çˆ¶ç±»åŸå‹å®Œå…¨éš”ç¦»</span>
<span class="token class-name">Child3</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent3</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ³¨æ„è®°å¾—æŠŠå­ç±»çš„æ„é€ æŒ‡å‘å­ç±»æœ¬èº«</span>
<span class="token class-name">Child3</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child3<span class="token punctuation">;</span>
<span class="token comment">//ä¸ç”¨ Child3.prototype = new Parent3() çš„åŸå› æ˜¯ä¼šè°ƒç”¨2æ¬¡çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼ˆå¦ä¸€æ¬¡æ˜¯callï¼‰ï¼Œä¼šå­˜åœ¨ä¸€ä»½å¤šä½™çš„çˆ¶ç±»å®ä¾‹å±æ€§ã€‚</span>
<span class="token comment">//è¿™ä¸€æ­¥ä¸ç”¨ Child3.prototype =Parent3.prototype çš„åŸå› æ˜¯æ€•å…±äº«å†…å­˜ï¼Œä¿®æ”¹çˆ¶ç±»åŸå‹å¯¹è±¡å°±ä¼šå½±å“å­ç±»ã€‚</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>ğŸ˜‹è¿™ç§æ–¹å¼ï¼Œèƒ½è§£å†³ä¹‹å‰ä¸¤ç§æ–¹å¼çš„é—®é¢˜ï¼šæ—¢å¯ä»¥ç»§æ‰¿çˆ¶ç±»åŸå‹çš„å†…å®¹ï¼Œä¹Ÿä¸ä¼šé€ æˆåŸå‹é‡Œå±æ€§çš„ä¿®æ”¹ã€‚</p> <p>è¯¦æƒ…è¯·è·³è½¬<a href="/font/JS/æ„é€ å‡½æ•°ã€åŸå‹ã€ç»§æ‰¿å’ŒåŸå‹é“¾.html#javascriptå¸¸ç”¨å…«ç§ç»§æ‰¿æ–¹æ¡ˆ">jså…«å¤§ç»§æ‰¿æ–¹æ¡ˆ</a>ä¸€æ–‡</p> <h2 id="promise"><a href="#promise" aria-hidden="true" class="header-anchor">#</a> Promise</h2> <p>ä»¥ä¸‹è½¬è½½è‡ªï¼š<a href="https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-15" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-15<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>æˆ‘ä»¬æ¥è¿‡ä¸€é<code>Promise/A+</code>è§„èŒƒï¼š</p> <ul><li>ä¸‰ç§çŠ¶æ€<code>pending| fulfilled(resolved) | rejected</code></li> <li>å½“å¤„äº<code>pending</code>çŠ¶æ€çš„æ—¶å€™ï¼Œå¯ä»¥è½¬ç§»åˆ°<code>fulfilled(resolved)</code>æˆ–è€…<code>rejected</code>çŠ¶æ€</li> <li>å½“å¤„äº<code>fulfilled(resolved)</code>çŠ¶æ€æˆ–è€…<code>rejected</code>çŠ¶æ€çš„æ—¶å€™ï¼Œå°±ä¸å¯å˜ã€‚</li></ul> <ol><li>å¿…é¡»æœ‰ä¸€ä¸ª<code>then</code>å¼‚æ­¥æ‰§è¡Œæ–¹æ³•ï¼Œ<code>then</code>æ¥å—ä¸¤ä¸ªå‚æ•°ä¸”å¿…é¡»è¿”å›ä¸€ä¸ªpromiseï¼š</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// onFulfilled ç”¨æ¥æ¥æ”¶promiseæˆåŠŸçš„å€¼</span>
<span class="token comment">// onRejected ç”¨æ¥æ¥æ”¶promiseå¤±è´¥çš„åŸå› </span>
promise1<span class="token operator">=</span>promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_8-1-promiseçš„æµç¨‹å›¾åˆ†æ"><a href="#_8-1-promiseçš„æµç¨‹å›¾åˆ†æ" aria-hidden="true" class="header-anchor">#</a> 8.1 <code>Promise</code>çš„æµç¨‹å›¾åˆ†æ</h3> <p><img src="/assets/img/1567408890776.8fa795e3.png" alt="1567408890776"></p> <p>æ¥å›é¡¾ä¸‹<code>Promise</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>æ“ä½œæˆåŠŸ<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// success</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// failure</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_8-2-é¢è¯•å¤Ÿç”¨ç‰ˆ"><a href="#_8-2-é¢è¯•å¤Ÿç”¨ç‰ˆ" aria-hidden="true" class="header-anchor">#</a> 8.2 é¢è¯•å¤Ÿç”¨ç‰ˆ</h3> <blockquote><p>æ¥æºï¼š<a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fforthealllight%2Fblog%2Fissues%2F4" target="_blank" rel="noopener noreferrer">å®ç°ä¸€ä¸ªå®Œç¾ç¬¦åˆPromise/A+è§„èŒƒçš„Promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myPromise</span><span class="token punctuation">(</span><span class="token parameter">constructor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">&quot;pending&quot;</span> <span class="token comment">//å®šä¹‰çŠ¶æ€æ”¹å˜å‰çš„åˆå§‹çŠ¶æ€</span>
    self<span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰çŠ¶æ€ä¸ºresolvedçš„æ—¶å€™çš„çŠ¶æ€</span>
    self<span class="token punctuation">.</span>reason<span class="token operator">=</span><span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰çŠ¶æ€ä¸ºrejectedçš„æ—¶å€™çš„çŠ¶æ€</span>
    <span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//ä¸¤ä¸ª===&quot;pending&quot;ï¼Œä¿è¯äº†çŠ¶æ€çš„æ”¹å˜æ˜¯ä¸å¯é€†çš„</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status<span class="token operator">===</span><span class="token string">&quot;pending&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          self<span class="token punctuation">.</span>value<span class="token operator">=</span>value<span class="token punctuation">;</span>
          self<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">&quot;resolved&quot;</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//ä¸¤ä¸ª===&quot;pending&quot;ï¼Œä¿è¯äº†çŠ¶æ€çš„æ”¹å˜æ˜¯ä¸å¯é€†çš„</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status<span class="token operator">===</span><span class="token string">&quot;pending&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          self<span class="token punctuation">.</span>reason<span class="token operator">=</span>reason<span class="token punctuation">;</span>
          self<span class="token punctuation">.</span>status<span class="token operator">=</span><span class="token string">&quot;rejected&quot;</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//æ•è·æ„é€ å¼‚å¸¸</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
       <span class="token function">constructor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>åŒæ—¶ï¼Œéœ€è¦åœ¨<code>myPromise</code>çš„åŸå‹ä¸Šå®šä¹‰é“¾å¼è°ƒç”¨çš„<code>then</code>æ–¹æ³•ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>myPromise<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onFullfilled<span class="token punctuation">,</span>onRejected</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">let</span> self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
   <span class="token keyword">switch</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">&quot;resolved&quot;</span><span class="token punctuation">:</span>
        <span class="token function">onFullfilled</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;rejected&quot;</span><span class="token punctuation">:</span>
        <span class="token function">onRejected</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span>       
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æµ‹è¯•ä¸€ä¸‹ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> p<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">myPromise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//è¾“å‡º1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_8-3-å¤§å‚ä¸“ä¾›ç‰ˆ"><a href="#_8-3-å¤§å‚ä¸“ä¾›ç‰ˆ" aria-hidden="true" class="header-anchor">#</a> 8.3 å¤§å‚ä¸“ä¾›ç‰ˆ</h3> <p>ç›´æ¥è´´å‡ºæ¥å§ï¼Œè¿™ä¸ªç‰ˆæœ¬è¿˜ç®—å¥½ç†è§£</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">&quot;pending&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">FULFILLED</span> <span class="token operator">=</span> <span class="token string">&quot;fulfilled&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">&quot;rejected&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Promise</span><span class="token punctuation">(</span><span class="token parameter">excutor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// ç¼“å­˜å½“å‰promiseå®ä¾‹å¯¹è±¡</span>
    that<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">PENDING</span><span class="token punctuation">;</span> <span class="token comment">// åˆå§‹çŠ¶æ€</span>
    that<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// fulfilledçŠ¶æ€æ—¶ è¿”å›çš„ä¿¡æ¯</span>
    that<span class="token punctuation">.</span>reason <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// rejectedçŠ¶æ€æ—¶ æ‹’ç»çš„åŸå› </span>
    that<span class="token punctuation">.</span>onFulfilledCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨fulfilledçŠ¶æ€å¯¹åº”çš„onFulfilledå‡½æ•°</span>
    that<span class="token punctuation">.</span>onRejectedCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨rejectedçŠ¶æ€å¯¹åº”çš„onRejectedå‡½æ•°</span>

    <span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// valueæˆåŠŸæ€æ—¶æ¥æ”¶çš„ç»ˆå€¼</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å®è·µä¸­è¦ç¡®ä¿ onFulfilled å’Œ onRejected æ–¹æ³•å¼‚æ­¥æ‰§è¡Œï¼Œä¸”åº”è¯¥åœ¨ then æ–¹æ³•è¢«è°ƒç”¨çš„é‚£ä¸€è½®äº‹ä»¶å¾ªç¯ä¹‹åçš„æ–°æ‰§è¡Œæ ˆä¸­æ‰§è¡Œã€‚</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// è°ƒç”¨resolve å›è°ƒå¯¹åº”onFulfilledå‡½æ•°</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// åªèƒ½ç”±pendingçŠ¶æ€ =&gt; fulfilledçŠ¶æ€ (é¿å…è°ƒç”¨å¤šæ¬¡resolve reject)</span>
                that<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">FULFILLED</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
                that<span class="token punctuation">.</span>onFulfilledCallbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// reasonå¤±è´¥æ€æ—¶æ¥æ”¶çš„æ‹’å› </span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// è°ƒç”¨reject å›è°ƒå¯¹åº”onRejectedå‡½æ•°</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// åªèƒ½ç”±pendingçŠ¶æ€ =&gt; rejectedçŠ¶æ€ (é¿å…è°ƒç”¨å¤šæ¬¡resolve reject)</span>
                that<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">REJECTED</span><span class="token punctuation">;</span>
                that<span class="token punctuation">.</span>reason <span class="token operator">=</span> reason<span class="token punctuation">;</span>
                that<span class="token punctuation">.</span>onRejectedCallbacks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ•è·åœ¨excutoræ‰§è¡Œå™¨ä¸­æŠ›å‡ºçš„å¼‚å¸¸</span>
    <span class="token comment">// new Promise((resolve, reject) =&gt; {</span>
    <span class="token comment">//     throw new Error('error in excutor')</span>
    <span class="token comment">// })</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token function">excutor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onFulfilled<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> newPromise<span class="token punctuation">;</span>
    <span class="token comment">// å¤„ç†å‚æ•°é»˜è®¤å€¼ ä¿è¯å‚æ•°åç»­èƒ½å¤Ÿç»§ç»­æ‰§è¡Œ</span>
    onFulfilled <span class="token operator">=</span>
        <span class="token keyword">typeof</span> onFulfilled <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function-variable function">onFulfilled</span> <span class="token punctuation">:</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> value<span class="token punctuation">;</span>
    onRejected <span class="token operator">=</span>
        <span class="token keyword">typeof</span> onRejected <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function-variable function">onRejected</span> <span class="token punctuation">:</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> reason<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">FULFILLED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æˆåŠŸæ€</span>
        <span class="token keyword">return</span> newPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span><span class="token punctuation">{</span>
                    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">resolvePromise</span><span class="token punctuation">(</span>newPromise<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ–°çš„promise resolve ä¸Šä¸€ä¸ªonFulfilledçš„è¿”å›å€¼</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ•è·å‰é¢onFulfilledä¸­æŠ›å‡ºçš„å¼‚å¸¸ then(onFulfilled, onRejected);</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">REJECTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// å¤±è´¥æ€</span>
        <span class="token keyword">return</span> newPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">onRejected</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">resolvePromise</span><span class="token punctuation">(</span>newPromise<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç­‰å¾…æ€</span>
        <span class="token comment">// å½“å¼‚æ­¥è°ƒç”¨resolve/rejectedæ—¶ å°†onFulfilled/onRejectedæ”¶é›†æš‚å­˜åˆ°é›†åˆä¸­</span>
        <span class="token keyword">return</span> newPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            that<span class="token punctuation">.</span>onFulfilledCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">resolvePromise</span><span class="token punctuation">(</span>newPromise<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            that<span class="token punctuation">.</span>onRejectedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">onRejected</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">resolvePromise</span><span class="token punctuation">(</span>newPromise<span class="token punctuation">,</span> x<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br></div></div><h2 id="json-parse"><a href="#json-parse" aria-hidden="true" class="header-anchor">#</a> JSON.parse</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//ç¬¬ä¸€ç§ï¼šä½¿ç”¨evalï¼Œå®ƒä¼šæ‰§è¡ŒJSä»£ç ï¼Œæœ‰XSSæ¼æ´ã€‚</span>
<span class="token keyword">var</span> jsonStr1 <span class="token operator">=</span> <span class="token string">'{&quot;a&quot;:&quot;1&quot;, &quot;b&quot;:2}'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> json <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj å°±æ˜¯ json ååºåˆ—åŒ–ä¹‹åå¾—åˆ°çš„å¯¹è±¡</span>

<span class="token comment">//ç¬¬äºŒç§ï¼Œä½¿ç”¨new Function</span>
<span class="token keyword">var</span> jsonStr2 <span class="token operator">=</span> <span class="token string">'{ &quot;age&quot;: 20, &quot;name&quot;: &quot;jack&quot; }'</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'return '</span> <span class="token operator">+</span> jsonStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="json-stringify"><a href="#json-stringify" aria-hidden="true" class="header-anchor">#</a> JSON.stringify</h2> <p>è½¬è½½è‡ªï¼š<a href="https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-1" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p><code>JSON.stringify(value[, replacer [, space]])</code>ï¼š</p></blockquote> <ul><li><code>Boolean | Number| String</code> ç±»å‹ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚</li> <li><code>undefined</code>ã€ä»»æ„å‡½æ•°ä»¥åŠ<code>symbol</code>ï¼Œä¼šè¢«å¿½ç•¥ï¼ˆå‡ºç°åœ¨éæ•°ç»„å¯¹è±¡çš„å±æ€§å€¼ä¸­æ—¶ï¼‰ï¼Œæˆ–è€…è¢«è½¬æ¢æˆ <code>null</code>ï¼ˆå‡ºç°åœ¨æ•°ç»„ä¸­æ—¶ï¼‰ã€‚</li> <li>ä¸å¯æšä¸¾çš„å±æ€§ä¼šè¢«å¿½ç•¥</li> <li>å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å±æ€§å€¼é€šè¿‡æŸç§é—´æ¥çš„æ–¹å¼æŒ‡å›è¯¥å¯¹è±¡æœ¬èº«ï¼Œå³å¾ªç¯å¼•ç”¨ï¼Œå±æ€§ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/string|undefined|function/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            obj <span class="token operator">=</span> <span class="token string">'&quot;'</span> <span class="token operator">+</span> obj <span class="token operator">+</span> <span class="token string">'&quot;'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> json <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">let</span> arr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> v <span class="token operator">=</span> obj<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> v<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/string|undefined|function/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                v <span class="token operator">=</span> <span class="token string">'&quot;'</span> <span class="token operator">+</span> v <span class="token operator">+</span> <span class="token string">'&quot;'</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                v <span class="token operator">=</span> <span class="token function">jsonStringify</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            json<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr <span class="token operator">?</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">:</span> <span class="token string">'&quot;'</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">'&quot;:'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">String</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>arr <span class="token operator">?</span> <span class="token string">&quot;[&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;{&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">String</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>arr <span class="token operator">?</span> <span class="token string">&quot;]&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x <span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;{&quot;x&quot;:5}&quot;</span>
<span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[1,&quot;false&quot;,false]&quot;</span>
<span class="token function">jsonStringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>b<span class="token punctuation">:</span> <span class="token keyword">undefined</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;{&quot;b&quot;:&quot;undefined&quot;}&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="å‡½æ•°æŸ¯é‡ŒåŒ–"><a href="#å‡½æ•°æŸ¯é‡ŒåŒ–" aria-hidden="true" class="header-anchor">#</a> å‡½æ•°æŸ¯é‡ŒåŒ–</h2> <p>ä»¥ä¸‹éƒ¨åˆ†è½¬è½½è‡ª<a href="https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-12" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5c9c3989e51d454e3a3902b6#heading-12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–ï¼Ÿ</strong></p> <blockquote><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰æ˜¯æŠŠæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æ¢æˆæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°ï¼ˆæœ€åˆå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°ä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ã€‚</p></blockquote> <p><strong>å‡½æ•°æŸ¯é‡ŒåŒ–çš„ä¸»è¦ä½œç”¨å’Œç‰¹ç‚¹å°±æ˜¯å‚æ•°å¤ç”¨ã€æå‰è¿”å›å’Œå»¶è¿Ÿæ‰§è¡Œã€‚</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * å‡½æ•°æŸ¯é‡ŒåŒ– ES5å®ç°
 */</span>
<span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> args <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    newArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newArgs<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">curry</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span> newArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * ES6å®ç°
 */</span>
<span class="token keyword">function</span> <span class="token function">currying</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">currying</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>args2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">multiFn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> b <span class="token operator">*</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> multi <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>multiFn<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">multi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="æ•°ç»„æ‰å¹³åŒ–"><a href="#æ•°ç»„æ‰å¹³åŒ–" aria-hidden="true" class="header-anchor">#</a> æ•°ç»„æ‰å¹³åŒ–</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ES6å°±æœ‰è‡ªå¸¦çš„flat()APIå¯ä¾›æ‰å¹³åŒ–ä½¿ç”¨</span>
<span class="token comment">//æ ‡å‡†ç‰ˆ</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">flat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      arr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//é€’å½’å»å¤„ç†æ•°ç»„å…ƒç´ </span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//éæ•°ç»„ç›´æ¥pushè¿›å»</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">;</span> <span class="token comment">//é€’å½’å‡ºå£</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.7836fe28.js" defer></script><script src="/assets/js/53.98ecd027.js" defer></script>
  </body>
</html>
