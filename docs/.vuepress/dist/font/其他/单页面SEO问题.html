<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前言 | niping</title>
    <meta name="description" content="欢迎来到我的博客">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b8bd58f1.css" as="style"><link rel="preload" href="/assets/js/app.2eb27204.js" as="script"><link rel="preload" href="/assets/js/49.927e655a.js" as="script"><link rel="prefetch" href="/assets/js/10.03359ecf.js"><link rel="prefetch" href="/assets/js/100.66b5c54d.js"><link rel="prefetch" href="/assets/js/101.91ce4843.js"><link rel="prefetch" href="/assets/js/11.ed7c3ae5.js"><link rel="prefetch" href="/assets/js/12.207d7637.js"><link rel="prefetch" href="/assets/js/13.10d0214c.js"><link rel="prefetch" href="/assets/js/14.bdd4b9c8.js"><link rel="prefetch" href="/assets/js/15.998dce4e.js"><link rel="prefetch" href="/assets/js/16.7a807bb7.js"><link rel="prefetch" href="/assets/js/17.530fae3d.js"><link rel="prefetch" href="/assets/js/18.f71fd5e4.js"><link rel="prefetch" href="/assets/js/19.1d5f93e4.js"><link rel="prefetch" href="/assets/js/2.0e7d93bd.js"><link rel="prefetch" href="/assets/js/20.83959210.js"><link rel="prefetch" href="/assets/js/21.cd08d95c.js"><link rel="prefetch" href="/assets/js/22.58eb444a.js"><link rel="prefetch" href="/assets/js/23.f1adac14.js"><link rel="prefetch" href="/assets/js/24.d593f419.js"><link rel="prefetch" href="/assets/js/25.e797deac.js"><link rel="prefetch" href="/assets/js/26.7a5cbe4f.js"><link rel="prefetch" href="/assets/js/27.af9d4ec8.js"><link rel="prefetch" href="/assets/js/28.574942c0.js"><link rel="prefetch" href="/assets/js/29.b7233bdc.js"><link rel="prefetch" href="/assets/js/3.67d6bbf7.js"><link rel="prefetch" href="/assets/js/30.dd8a1972.js"><link rel="prefetch" href="/assets/js/31.7060eb3f.js"><link rel="prefetch" href="/assets/js/32.e686a812.js"><link rel="prefetch" href="/assets/js/33.8fdba319.js"><link rel="prefetch" href="/assets/js/34.66b826ff.js"><link rel="prefetch" href="/assets/js/35.32256365.js"><link rel="prefetch" href="/assets/js/36.856ee677.js"><link rel="prefetch" href="/assets/js/37.12777a7b.js"><link rel="prefetch" href="/assets/js/38.f90777c3.js"><link rel="prefetch" href="/assets/js/39.b2d741a4.js"><link rel="prefetch" href="/assets/js/4.d17fba99.js"><link rel="prefetch" href="/assets/js/40.7385502d.js"><link rel="prefetch" href="/assets/js/41.912a84d8.js"><link rel="prefetch" href="/assets/js/42.f3bd36e8.js"><link rel="prefetch" href="/assets/js/43.09eb4bb8.js"><link rel="prefetch" href="/assets/js/44.af48a221.js"><link rel="prefetch" href="/assets/js/45.ff17fb2c.js"><link rel="prefetch" href="/assets/js/46.9124d2d3.js"><link rel="prefetch" href="/assets/js/47.03b8ff54.js"><link rel="prefetch" href="/assets/js/48.00d60a1e.js"><link rel="prefetch" href="/assets/js/5.8808b997.js"><link rel="prefetch" href="/assets/js/50.22800eb8.js"><link rel="prefetch" href="/assets/js/51.d77d207e.js"><link rel="prefetch" href="/assets/js/52.6abb3cfb.js"><link rel="prefetch" href="/assets/js/53.b5a5764a.js"><link rel="prefetch" href="/assets/js/54.403f2fd5.js"><link rel="prefetch" href="/assets/js/55.3afc47a0.js"><link rel="prefetch" href="/assets/js/56.d273913f.js"><link rel="prefetch" href="/assets/js/57.7c518bc0.js"><link rel="prefetch" href="/assets/js/58.ffd2c7cd.js"><link rel="prefetch" href="/assets/js/59.ca06a7e4.js"><link rel="prefetch" href="/assets/js/6.4e6fcd83.js"><link rel="prefetch" href="/assets/js/60.13c62aca.js"><link rel="prefetch" href="/assets/js/61.d32d7414.js"><link rel="prefetch" href="/assets/js/62.e00bc07a.js"><link rel="prefetch" href="/assets/js/63.9eed3a2c.js"><link rel="prefetch" href="/assets/js/64.5149b8ab.js"><link rel="prefetch" href="/assets/js/65.0563f671.js"><link rel="prefetch" href="/assets/js/66.28fb11ea.js"><link rel="prefetch" href="/assets/js/67.d82e606d.js"><link rel="prefetch" href="/assets/js/68.0d819a57.js"><link rel="prefetch" href="/assets/js/69.6ed405bb.js"><link rel="prefetch" href="/assets/js/7.4988de5c.js"><link rel="prefetch" href="/assets/js/70.fde65128.js"><link rel="prefetch" href="/assets/js/71.54229bfa.js"><link rel="prefetch" href="/assets/js/72.a5d24409.js"><link rel="prefetch" href="/assets/js/73.2aa49855.js"><link rel="prefetch" href="/assets/js/74.5d90599f.js"><link rel="prefetch" href="/assets/js/75.3e51266e.js"><link rel="prefetch" href="/assets/js/76.aeb915bd.js"><link rel="prefetch" href="/assets/js/77.eec9c301.js"><link rel="prefetch" href="/assets/js/78.955bca69.js"><link rel="prefetch" href="/assets/js/79.471c3418.js"><link rel="prefetch" href="/assets/js/8.035ae6ea.js"><link rel="prefetch" href="/assets/js/80.b01f23a5.js"><link rel="prefetch" href="/assets/js/81.77769db1.js"><link rel="prefetch" href="/assets/js/82.fa92cb25.js"><link rel="prefetch" href="/assets/js/83.23996f3c.js"><link rel="prefetch" href="/assets/js/84.672c55ed.js"><link rel="prefetch" href="/assets/js/85.bc98237b.js"><link rel="prefetch" href="/assets/js/86.e2cf5953.js"><link rel="prefetch" href="/assets/js/87.a094728a.js"><link rel="prefetch" href="/assets/js/88.25a5c8e4.js"><link rel="prefetch" href="/assets/js/89.c730c66c.js"><link rel="prefetch" href="/assets/js/9.df2b2daa.js"><link rel="prefetch" href="/assets/js/90.9b5fd611.js"><link rel="prefetch" href="/assets/js/91.4027b8e8.js"><link rel="prefetch" href="/assets/js/92.2b191a56.js"><link rel="prefetch" href="/assets/js/93.75671ff6.js"><link rel="prefetch" href="/assets/js/94.ff083b70.js"><link rel="prefetch" href="/assets/js/95.95effb05.js"><link rel="prefetch" href="/assets/js/96.f1b6baa9.js"><link rel="prefetch" href="/assets/js/97.1c1724b3.js"><link rel="prefetch" href="/assets/js/98.0f5972a0.js"><link rel="prefetch" href="/assets/js/99.8df94d86.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8bd58f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">niping</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>浏览器网络</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>其他</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/font/其他/Nginx反向代理与负载均衡.html" class="sidebar-link">Nginx反向代理与负载均衡</a></li><li><a href="/font/其他/PC端与移动端开发区别.html" class="sidebar-link">PC端与移动端开发区别</a></li><li><a href="/font/其他/手撕代码.html" class="sidebar-link">手撕代码</a></li><li><a href="/font/其他/实现一个Event.html" class="sidebar-link">实现一个Event</a></li><li><a href="/font/其他/实现深克隆.html" class="sidebar-link">实现深克隆</a></li><li><a href="/font/其他/前端工程化.html" class="sidebar-link">前端工程化</a></li><li><a href="/font/其他/单页面SEO问题.html" class="active sidebar-link">单页面SEO问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font/其他/单页面SEO问题.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/font/其他/单页面SEO问题.html#搜索引擎的工作原理" class="sidebar-link">搜索引擎的工作原理</a></li><li class="sidebar-sub-header"><a href="/font/其他/单页面SEO问题.html#seo介绍" class="sidebar-link">SEO介绍</a></li><li class="sidebar-sub-header"><a href="/font/其他/单页面SEO问题.html#为什么说单页面的seo不友好" class="sidebar-link">为什么说单页面的SEO不友好</a></li><li class="sidebar-sub-header"><a href="/font/其他/单页面SEO问题.html#如何解决单页面seo不友好的问题" class="sidebar-link">如何解决单页面SEO不友好的问题</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p>作者：木子水吉</p> <p>链接：https://juejin.im/post/5d9848306fb9a04ddf2c341b</p> <p>来源：掘金著作权归作者所有。</p> <h2 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h2> <p>大家可能都知道单页面的SEO不友好，但是你有没有思考过为什么单页面的SEO不友好呢？在单页面盛行的今天，有哪些策略来规避掉这一缺点呢？很好奇有木有？那就跟我一起开启探索之旅吧~</p> <h2 id="搜索引擎的工作原理"><a href="#搜索引擎的工作原理" aria-hidden="true" class="header-anchor">#</a> 搜索引擎的工作原理</h2> <p>在搜索引擎网站的后台会有一个非常庞大的数据库，里面存储了海量的关键词，而每个关键词又对应着很多网址，这些网址是被称之为“搜索引擎蜘蛛”或“网络爬虫”程序从茫茫的互联网上一点一点下载收集而来的。随着各种各样网站的出现，这些勤劳的“蜘蛛”每天在互联网上爬行，从一个链接到另一个链接，下载其中的内容，进行分析提炼，找到其中的关键词，如果“蜘蛛”认为关键词在数据库中没有而对用户是有用的便存入后台的数据库中。反之，如果“蜘蛛”认为是垃圾信息或重复信息，就舍弃不要，继续爬行，寻找最新的、有用的信息保存起来提供用户搜索。当用户搜索时，就能检索出与关键字相关的网址显示给访客。一个关键词对用多个网址，因此就出现了排序的问题，相应的当与关键词最吻合的网址就会排在前面了。在“蜘蛛”抓取网页内容，提炼关键词的这个过程中，就存在一个问题：“蜘蛛”能否看懂。如果网站内容是flash和js等，那么它是看不懂的，会犯迷糊，即使关键字再贴切也没用。相应的，如果网站内容可以被搜索引擎能识别，那么搜索引擎就会提高该网站的权重，增加对该网站的友好度。</p> <h2 id="seo介绍"><a href="#seo介绍" aria-hidden="true" class="header-anchor">#</a> SEO介绍</h2> <p>SEO是搜索引擎优化(Search Engine Optimization)的英文缩写,意指在了解搜索引擎自然排名机制的基础上,对网站进行内部及外部的调整优化,改进网站在搜索引擎中的关键词自然排名,获得更多的流量,从而达成网站销售以及品牌建设的预期目标.</p> <p>SEO的主要工作是通过了解各类搜索引擎如何抓取互联网页面,如何进行索引以及如何确定其对某一特定关键词的搜索结果排名等技术,来对网页进行相关的优化,使其提高搜索引擎排名,从而提高访问量,最终提升网站的销售能力或宣传能力的技术.增加网站曝光率,提高整站权重,让用户更容易搜索到你的网站,进而带来客观的流量.通过这一策略引流的优点是: 1. 低成本; 2. 持久性; 3. 不需要承担&quot;无效点击&quot;的风险.</p> <p>这里简单写一点SEO的优化方向:</p> <ol><li>网站设计优化</li></ol> <ul><li>网站主标题关键词优化，必须选择好关键词，一般以“一个核心词+三五个长尾词”组合成标题。</li> <li>网站布局的优化。一般来说，企业产品网站，主要是F型布局，内容繁多的网站以“扁平结构”布局为主。</li> <li>代码优化，就是板块、栏目代码，最好使用对应的简拼或者全拼。</li></ul> <ol><li>网站内容优化</li></ol> <ul><li>分析栏目关键词，有哪些长尾词，挖掘出来，做成表格的形式。然后，逐个分析长尾词都有哪些内容有关，形成二级长尾词。</li> <li>根据挖掘的长尾词，分析用户需求，挖掘与之有关的内容，整理出文章，发布在网站上，一定确保高质量文章。</li></ul> <h2 id="为什么说单页面的seo不友好"><a href="#为什么说单页面的seo不友好" aria-hidden="true" class="header-anchor">#</a> 为什么说单页面的SEO不友好</h2> <p>因为单页面的情况下的页面中的很多内容都是根据匹配到的路由动态生成并展示出来的,而且很多页面内容是通过ajax异步获取的,网络抓取工具并不会等待异步请求完成后再行抓取页面内容,对于网络抓取工来说去准确模拟相关的行为获取复合数据是很困难的,它们更擅长对静态资源的抓取和分析.</p> <h2 id="如何解决单页面seo不友好的问题"><a href="#如何解决单页面seo不友好的问题" aria-hidden="true" class="header-anchor">#</a> 如何解决单页面SEO不友好的问题</h2> <p>明白了问题出在哪里,“搜索引擎蜘蛛”或“网络爬虫”程序更擅长对静态资源的抓取和更新,那我们就要采取相应策略生成尽可能多的静态资源,来让网络爬虫获取更多的数据,从而提升网站的搜索排名.目前市面上用的比较多的就是以下两种策略: 预渲染和SSR(服务端渲染).</p> <p>简单介绍下SEO的一些优化策略:</p> <h3 id="预渲染"><a href="#预渲染" aria-hidden="true" class="header-anchor">#</a> 预渲染</h3> <p>预渲染是基于<code>prerender-spa-plugin</code>在项目构建时,通过无头浏览器模拟浏览器请求,将得到的数据插入给出的模板中,从而生成已经包含数据的html,这样有了更多的静态资源,网络爬虫可以抓取到更多的网站信息,提升网站的搜索排名.我最近在使用react做官网,考虑到单页面的SEO的问题和官网大多都是静态资源,采用了预渲染技术,想在这里跟大家分享一下.</p> <p>这里的预渲染是使用<code>prerender-spa-plugin</code>模块,结合<code>webpack</code>来生成一些路由对应的静态页面.我的项目是使用<code>create-react-app</code>脚手架构建的,在<code>config-overrides.js</code>里来进行自定义的webpack配置.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 在create-react-app 2.x以下的的版本里,   </span>
<span class="token comment">// 在config-overrides.js是这样配置预渲染的</span>
<span class="token keyword">const</span> PrerenderSPAPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'prerender-spa-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">override</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> env</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span>plugins <span class="token operator">=</span> config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">PrerenderSPAPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        routes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token string">'about'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        staticDir<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'build'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// create-react-app 2.x 以上的ban版本是这样配置的</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> override<span class="token punctuation">,</span> fixBabelImports<span class="token punctuation">,</span> addLessLoader<span class="token punctuation">,</span> addWebpackAlias<span class="token punctuation">,</span> addWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'customize-cra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> PrerenderSPAPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'prerender-spa-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 除了单独定义一个功能函数你还可以使用</span>
<span class="token comment">// customize-cra提供的addWebpackPlugin来添加插件</span>
<span class="token comment">// 感兴趣的小伙伴可以自行百度使用方法</span>
<span class="token keyword">const</span> <span class="token function-variable function">addConfigPlugin</span> <span class="token operator">=</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在这里我们还可以很方便的对config扩展别的配置项</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        config<span class="token punctuation">.</span>plugins <span class="token operator">=</span> config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">PrerenderSPAPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                routes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token string">'about'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                staticDir<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'build'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> config
<span class="token punctuation">}</span>
<span class="token comment">// 我的理解override函数的本质还是处理config对象并返回</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span>  <span class="token function">override</span><span class="token punctuation">(</span>
    addConfigPlugin<span class="token punctuation">,</span>
    <span class="token comment">// 这里是按需加载antd</span>
    <span class="token function">fixBabelImports</span><span class="token punctuation">(</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>        
        libraryName<span class="token punctuation">:</span> <span class="token string">'antd'</span><span class="token punctuation">,</span>        
        libraryDirectory<span class="token punctuation">:</span> <span class="token string">'es'</span><span class="token punctuation">,</span>       
        style<span class="token punctuation">:</span> <span class="token string">'css'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p><code>create-react-app</code>官方文档关于预渲染也提供了相应的解决方案<a href="https://create-react-app.dev/docs/pre-rendering-into-static-html-files" target="_blank" rel="noopener noreferrer">戳这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="ssr-服务端渲染"><a href="#ssr-服务端渲染" aria-hidden="true" class="header-anchor">#</a> SSR(服务端渲染)</h3> <p>服务端渲染就是先向后端服务器请求数据,然后生成完整首屏html返回给浏览器, 服务端渲染返回给客户端的是已经获取了异步数据并执行JavaScript脚本的最终HTML,网络爬虫可以抓取到完整的页面信息,SSR另一个很大的作用是加速首屏渲染,因为无需等待所有的JavaScript都完成下载并执行,才显示服务端渲染的标记,所以用户会更快地看到完整渲染的页面.</p> <p><strong>SSR相比预渲染的优势</strong></p> <ol><li>更快的构建速度,SSR是动态插入数据,并不会在构建时就去预加载数据,而是在输入url后在服务端请求,拿到返回的数据插入模板后再返回给客户端.</li> <li>嵌套路由下的个性化页面加载,个性化页面无法进行预渲染,SSR可以解决.</li> <li>更好的SEO.</li> <li>更快地首屏加载速度(请求业务数据,和将数据render成html片段都在服务端进行了,浏览器负责加载资源,请求CDN资源,css渲染,到达时间缩短.)</li></ol> <p>这里推荐一个基于Vue.js的服务端渲染应用框架<a href="https://zh.nuxtjs.org/" target="_blank" rel="noopener noreferrer">Nuxt.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,想要了解的可自行查看官方文档.</p> <p>我这里的代码示例就采用最基础简洁的技术来实现一个简单的Vue SSR的示例.完整版的实现<a href="https://github.com/muzishuiji/vue-ssr" target="_blank" rel="noopener noreferrer">戳这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 一个基础版本的ssr的实现</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Vue <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> vueServerRender<span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-server-renderer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 生成一个render函数</span>
<span class="token keyword">const</span> Renderer <span class="token operator">=</span> vueServerRender<span class="token punctuation">.</span><span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 定义一个基础的模板页面</span>
    template<span class="token punctuation">:</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./src/index.template.html'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建一个vue组件</span>
    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'this is vue ssr basic demo'</span><span class="token punctuation">,</span>
            url<span class="token punctuation">:</span> req<span class="token punctuation">.</span>url
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        template<span class="token punctuation">:</span><span class="token string">'&lt;div&gt; {{name}}, current url is: {{url}}&lt;/div&gt;'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'SSR test#'</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 将vue实例和对应的传参转换成html字符串</span>
    Renderer<span class="token punctuation">.</span><span class="token function">renderToString</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> context<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> html</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
            res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'server error'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 返回渲染完成的页面</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8008</span><span class="token punctuation">;</span>
<span class="token comment">// 运行服务器端</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`server started at localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>结合<code>vue-server-renderer</code>开发一个SSR项目,还是有一定挑战的,我也是折腾了一番才成功运行,会踩到的坑就是vue生成的Virtual Dom与服务端渲染的内容不匹配的问题.</p> <p><img src="/assets/img/1571366805523.d0eb9857.png" alt="1571366805523"></p> <p>遇到这个问题需要检查<code>./entry-client.js</code>中有没有进行状态同步</p> <p><img src="/assets/img/1571366822301.c4441ca8.png" alt="1571366822301"></p> <p>如果你们想要动手实现一个不急于Nuxt框架的SSR项目,我的建议是先去查看官方文档<a href="https://zh.nuxtjs.org/guide" target="_blank" rel="noopener noreferrer">Nuxt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,然后尝试自己实现一个小型项目,遇到问题可以参考我的实现<a href="https://github.com/muzishuiji/vue-ssr-demo" target="_blank" rel="noopener noreferrer">vue-ssr-demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,还有一个尤大写的一个demo,这个demo实现的功能更强大,更完善,但是很多模块的版本比较低,有些新版本的api可能会有所变化,有些模块依赖node@9以下的版本,想要正确运行可能需要费点功夫<a href="https://github.com/vuejs/vue-hackernews-2.0" target="_blank" rel="noopener noreferrer">vue-hackernews-2.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间: </span> <span class="time">10/18/2019, 10:25:57 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.2eb27204.js" defer></script><script src="/assets/js/49.927e655a.js" defer></script>
  </body>
</html>
