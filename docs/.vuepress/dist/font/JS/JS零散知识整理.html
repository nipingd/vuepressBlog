<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DOM事件流 | niping</title>
    <meta name="description" content="欢迎来到我的博客">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b8bd58f1.css" as="style"><link rel="preload" href="/assets/js/app.d8b5cad2.js" as="script"><link rel="preload" href="/assets/js/23.9a0a7c29.js" as="script"><link rel="prefetch" href="/assets/js/10.2096d897.js"><link rel="prefetch" href="/assets/js/11.af93e5e5.js"><link rel="prefetch" href="/assets/js/12.f92fcc1d.js"><link rel="prefetch" href="/assets/js/13.57736ac6.js"><link rel="prefetch" href="/assets/js/14.8a1d7cbf.js"><link rel="prefetch" href="/assets/js/15.a767fd92.js"><link rel="prefetch" href="/assets/js/16.19ea3934.js"><link rel="prefetch" href="/assets/js/17.1958a327.js"><link rel="prefetch" href="/assets/js/18.59b4b6d5.js"><link rel="prefetch" href="/assets/js/19.09724bd3.js"><link rel="prefetch" href="/assets/js/2.d45d9e8b.js"><link rel="prefetch" href="/assets/js/20.3e3c3d93.js"><link rel="prefetch" href="/assets/js/21.4e432f2d.js"><link rel="prefetch" href="/assets/js/22.aa24324d.js"><link rel="prefetch" href="/assets/js/24.4af8c1c6.js"><link rel="prefetch" href="/assets/js/25.d69c442b.js"><link rel="prefetch" href="/assets/js/26.3ee33bf7.js"><link rel="prefetch" href="/assets/js/27.e2b45ff9.js"><link rel="prefetch" href="/assets/js/28.a57809f3.js"><link rel="prefetch" href="/assets/js/29.1e68b208.js"><link rel="prefetch" href="/assets/js/3.aad3f233.js"><link rel="prefetch" href="/assets/js/30.d2a81dee.js"><link rel="prefetch" href="/assets/js/31.19a6935a.js"><link rel="prefetch" href="/assets/js/32.8b1228a7.js"><link rel="prefetch" href="/assets/js/33.f7c5fc61.js"><link rel="prefetch" href="/assets/js/34.7fd369a7.js"><link rel="prefetch" href="/assets/js/35.dff5e4e1.js"><link rel="prefetch" href="/assets/js/36.88ba2355.js"><link rel="prefetch" href="/assets/js/37.8f6e9d78.js"><link rel="prefetch" href="/assets/js/38.d725525a.js"><link rel="prefetch" href="/assets/js/39.b940e6a6.js"><link rel="prefetch" href="/assets/js/4.036ead63.js"><link rel="prefetch" href="/assets/js/40.b0a1905c.js"><link rel="prefetch" href="/assets/js/41.b6bc0d3e.js"><link rel="prefetch" href="/assets/js/42.25135ec9.js"><link rel="prefetch" href="/assets/js/43.be689c08.js"><link rel="prefetch" href="/assets/js/44.971c1e41.js"><link rel="prefetch" href="/assets/js/45.0d203a3d.js"><link rel="prefetch" href="/assets/js/46.80e3cbd1.js"><link rel="prefetch" href="/assets/js/47.6cd332b9.js"><link rel="prefetch" href="/assets/js/48.e7fd3f5d.js"><link rel="prefetch" href="/assets/js/49.b47c8642.js"><link rel="prefetch" href="/assets/js/5.a6b22bbd.js"><link rel="prefetch" href="/assets/js/50.073c6e17.js"><link rel="prefetch" href="/assets/js/51.c86d9a1a.js"><link rel="prefetch" href="/assets/js/52.5e4e977a.js"><link rel="prefetch" href="/assets/js/53.a00c0316.js"><link rel="prefetch" href="/assets/js/54.f3c67876.js"><link rel="prefetch" href="/assets/js/55.8fec17a9.js"><link rel="prefetch" href="/assets/js/56.7d8c2666.js"><link rel="prefetch" href="/assets/js/57.0943517f.js"><link rel="prefetch" href="/assets/js/58.b09d9a8e.js"><link rel="prefetch" href="/assets/js/59.5b3e08a5.js"><link rel="prefetch" href="/assets/js/6.9d7fee54.js"><link rel="prefetch" href="/assets/js/60.82af44f9.js"><link rel="prefetch" href="/assets/js/61.4164289c.js"><link rel="prefetch" href="/assets/js/62.3cd927bb.js"><link rel="prefetch" href="/assets/js/63.477d38f5.js"><link rel="prefetch" href="/assets/js/64.1302e64a.js"><link rel="prefetch" href="/assets/js/65.48e4a7b3.js"><link rel="prefetch" href="/assets/js/66.4d87dd6f.js"><link rel="prefetch" href="/assets/js/67.d66bebbe.js"><link rel="prefetch" href="/assets/js/68.e27f00dd.js"><link rel="prefetch" href="/assets/js/69.2bc365e1.js"><link rel="prefetch" href="/assets/js/7.0c2087f6.js"><link rel="prefetch" href="/assets/js/70.60d07a42.js"><link rel="prefetch" href="/assets/js/71.ce989bba.js"><link rel="prefetch" href="/assets/js/72.b0d43699.js"><link rel="prefetch" href="/assets/js/73.37182451.js"><link rel="prefetch" href="/assets/js/74.20f0e58a.js"><link rel="prefetch" href="/assets/js/75.d2885695.js"><link rel="prefetch" href="/assets/js/76.119af0a8.js"><link rel="prefetch" href="/assets/js/77.8970f2f9.js"><link rel="prefetch" href="/assets/js/78.bb2ba9f6.js"><link rel="prefetch" href="/assets/js/8.771ea007.js"><link rel="prefetch" href="/assets/js/9.53a0606c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8bd58f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">niping</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>JS</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/font/JS/this、new、apply、call与bind.html" class="sidebar-link">this、new、apply、call与bind</a></li><li><a href="/font/JS/JS单线程、异步、同步.html" class="sidebar-link">JS单线程、异步、同步</a></li><li><a href="/font/JS/常用正则表达式备忘录.html" class="sidebar-link">常用正则表达式备忘录</a></li><li><a href="/font/JS/Object.defineProperty与Proxy理解整理.html" class="sidebar-link">Object.defineProperty与Proxy理解整理</a></li><li><a href="/font/JS/柯里化.html" class="sidebar-link">柯里化</a></li><li><a href="/font/JS/JS技巧.html" class="sidebar-link">JS技巧</a></li><li><a href="/font/JS/闭包.html" class="sidebar-link">闭包</a></li><li><a href="/font/JS/作用域与作用域链.html" class="sidebar-link">作用域与作用域链</a></li><li><a href="/font/JS/JS运行机制总结.html" class="sidebar-link">JS运行机制总结</a></li><li><a href="/font/JS/赋值、浅拷贝与深拷贝.html" class="sidebar-link">赋值、浅拷贝与深拷贝</a></li><li><a href="/font/JS/构造函数、原型、继承和原型链.html" class="sidebar-link">构造函数、原型、继承和原型链</a></li><li><a href="/font/JS/原生JS知识.html" class="sidebar-link">原生JS知识</a></li><li><a href="/font/JS/防抖与节流.html" class="sidebar-link">防抖与节流</a></li><li><a href="/font/JS/类型转换比较问题.html" class="sidebar-link">类型转换比较问题</a></li><li><a href="/font/JS/JS中有趣的事实.html" class="sidebar-link">JS中有趣的事实</a></li><li><a href="/font/JS/正则表达式必知必会.html" class="sidebar-link">正则表达式必知必会</a></li><li><a href="/font/JS/空对象与空数组相加问题.html" class="sidebar-link">空对象与空数组相加问题</a></li><li><a href="/font/JS/JS面试题.html" class="sidebar-link">JS面试题</a></li><li><a href="/font/JS/JS零散知识整理.html" class="active sidebar-link">JS零散知识整理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#dom事件流" class="sidebar-link">DOM事件流</a></li><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#事件委托" class="sidebar-link">事件委托</a></li><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#mouseover和mouseenter的区别" class="sidebar-link">mouseover和mouseenter的区别</a></li><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#js的各种位置，比如clientheight-scrollheight-offsetheight-以及scrolltop-offsettop-clienttop的区别？" class="sidebar-link">js的各种位置，比如clientHeight,scrollHeight,offsetHeight ,以及scrollTop, offsetTop,clientTop的区别？</a></li><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#js中的垃圾回收机制" class="sidebar-link">JS中的垃圾回收机制</a></li><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#settimeout、setinterval和requestanimationframe之间的区别" class="sidebar-link">setTimeout、setInterval和requestAnimationFrame之间的区别</a></li><li class="sidebar-sub-header"><a href="/font/JS/JS零散知识整理.html#简单实现node的events模块" class="sidebar-link">简单实现Node的Events模块</a></li></ul></li><li><a href="/font/JS/前端模块化.html" class="sidebar-link">前端模块化</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>浏览器网络</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="dom事件流"><a href="#dom事件流" aria-hidden="true" class="header-anchor">#</a> DOM事件流</h2> <p>DOM事件流讲的就是：浏览器在于当前页面做交互时，这个事件是怎么传递到页面上的。</p> <p>类似于Android里面的事件传递。</p> <p>完整的事件流，分三个阶段：</p> <ul><li>（1）捕获：从 window 对象传到 目标元素。</li> <li>（2）目标阶段：事件通过捕获，到达目标元素，这个阶段就是目标阶段。</li> <li>（3）冒泡：从<strong>目标元素</strong>传到 Window 对象。</li></ul> <p><img src="/assets/img/1566891643389.3e64255b.png" alt="1566891643389"></p> <p><img src="/assets/img/1566891656508.1d080f82.png" alt="1566891656508"></p> <p><img src="/assets/img/1566891724163.2234ac68.png" alt="1566891724163"></p> <p><img src="/assets/img/1566891699627.204a4f02.png" alt="1566891699627"></p> <p>事件捕获：是一种自顶向下的事件类型，从DOM层次的顶端沿着子节点依次向下延伸，直到目标节点。</p> <p>事件冒泡：和事件捕获正好相反，从目标节点开始沿着父节点逐层向上传播。</p> <p>W3C中阻止事件默认行为：**e.preventDefault()**方法，阻止事件冒泡：**e.stopPropogation()**方法，阻止元素的同类型事件：<strong>e.stopImmediatePropagation()</strong></p> <p>IE中，阻止事件默认行为：event.returnValue=false ,阻止事件冒泡：event.cancelBubble=true</p> <h2 id="事件委托"><a href="#事件委托" aria-hidden="true" class="header-anchor">#</a> 事件委托</h2> <p>简介：事件委托指的是，不在事件的发生地（直接dom）上设置监听函数，而是在其父元素上设置监听函数，通过事件冒泡，父元素可以监听到子元素上事件的触发，通过判断事件发生元素DOM的类型，来做出不同的响应。</p> <p>举例：最经典的就是ul和li标签的事件监听，比如我们在添加事件时候，采用事件委托机制，不会在li标签上直接添加，而是在ul父元素上添加。</p> <p>好处：比较合适动态元素的绑定，新添加的子元素也会有监听函数，也可以有事件触发机制。</p> <h3 id="event-currenttarget和event-target"><a href="#event-currenttarget和event-target" aria-hidden="true" class="header-anchor">#</a> <strong>event.currentTarget和event.target</strong></h3> <p><a href="https://www.cnblogs.com/yzhihao/p/9398917.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/yzhihao/p/9398917.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="mouseover和mouseenter的区别"><a href="#mouseover和mouseenter的区别" aria-hidden="true" class="header-anchor">#</a> mouseover和mouseenter的区别</h2> <p>mouseover：当鼠标移入元素或其子元素都会触发事件，所以有一个重复触发😋，<strong>冒泡</strong>的过程。对应的移除事件是mouseout</p> <p>mouseenter：当鼠标移除元素本身（不包含元素的子元素）会触发事件，也就是不会冒泡，对应的移除事件是mouseleave</p> <p><a href="https://www.w3school.com.cn/tiy/t.asp?f=jquery_event_mouseenter_mouseover" target="_blank" rel="noopener noreferrer">https://www.w3school.com.cn/tiy/t.asp?f=jquery_event_mouseenter_mouseover<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="js的各种位置，比如clientheight-scrollheight-offsetheight-以及scrolltop-offsettop-clienttop的区别？"><a href="#js的各种位置，比如clientheight-scrollheight-offsetheight-以及scrolltop-offsettop-clienttop的区别？" aria-hidden="true" class="header-anchor">#</a> js的各种位置，比如clientHeight,scrollHeight,offsetHeight ,以及scrollTop, offsetTop,clientTop的区别？</h2> <p>clientHeight：表示的是可视区域的高度，不包含border和滚动条</p> <p>offsetHeight：表示可视区域的高度，包含了border和滚动条</p> <p>scrollHeight：表示了所有区域的高度，包含了因为滚动被隐藏的部分。</p> <p>clientTop：表示边框border的厚度，在未指定的情况下一般为0</p> <p>scrollTop：滚动后被隐藏的高度，获取对象相对于由offsetParent属性指定的父坐标(css定位的元素或body元素)距离顶端的高度。</p> <p>scrollHeight: 获取对象的滚动高度。</p> <p>scrollWidth:获取对象的滚动宽度 。</p> <p>scrollLeft:设置或获取位于对象左边界和窗口中目前可见内容的最左端之间的距离</p> <p>scrollTop:设置或获取位于对象最顶端和窗口中可见内容的最顶端之间的距离</p> <p>offsetHeight:获取对象相对于版面或由父坐标 offsetParent 属性指定的父坐标的高度</p> <p>offsetLeft:获取对象相对于版面或由 offsetParent 属性指定的父坐标的计算左侧位置</p> <p>offsetTop:获取对象相对于版面或由 offsetTop 属性指定的父坐标的计算顶端位置</p> <p>event.clientX 相对文档的水平座标</p> <p>event.clientY 相对文档的垂直座标</p> <p>event.offsetX 相对容器的水平坐标</p> <p>event.offsetY 相对容器的垂直坐标</p> <p>document.documentElement.scrollTop 垂直方向滚动的值</p> <p>event.clientX+document.documentElement.scrollTop 相对文档的水平座标+垂直方向滚动的量</p> <p>这里是JavaScript中建造迁移转变代码的常用属性</p> <p>网页可见区域宽： document.body.clientWidth;</p> <p>网页可见区域高： document.body.clientHeight;</p> <p>网页可见区域宽： document.body.offsetWidth   （包含边线的宽）;</p> <p>网页可见区域高： document.body.offsetHeight （包含边线的宽）;</p> <p>网页正文全文宽： document.body.scrollWidth;</p> <p>网页正文全文高： document.body.scrollHeight;</p> <p>网页被卷去的高： document.body.scrollTop;</p> <p>网页被卷去的左： document.body.scrollLeft;</p> <p>网页正文项目组上： window.screenTop;</p> <p>网页正文项目组左： window.screenLeft;</p> <p>屏幕辨别率的高： window.screen.height;</p> <p>屏幕辨别率的宽： window.screen.width;</p> <p>屏幕可用工作区高度： window.screen.availHeight;</p> <h2 id="js中的垃圾回收机制"><a href="#js中的垃圾回收机制" aria-hidden="true" class="header-anchor">#</a> JS中的垃圾回收机制</h2> <p>必要性：由于字符串、对象和数组没有固定大小，所有当他们的大小已知时，才能对他们进行动态的存储分配。JavaScript程序每次创建字符串、数组或对象时，解释器都必须分配内存来存储那个实体。只要像这样动态地分配了内存，最终都要释放这些内存以便他们能够被再用，否则，JavaScript的解释器将会消耗完系统中所有可用的内存，造成系统崩溃。</p> <p>这段话解释了为什么需要系统需要垃圾回收，JS不像C/C++，他有自己的一套垃圾回收机制（Garbage Collection）。JavaScript的解释器可以检测到何时程序不再使用一个对象了，当他确定了一个对象是无用的时候，他就知道不再需要这个对象，可以把它所占用的内存释放掉了。例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b<span class="token operator">=</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a<span class="token operator">=</span>b<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>//这时，会释放掉&quot;hello world&quot;，释放内存以便再引用</p> <p>垃圾回收的方法：标记清除、计数引用。</p> <p>标记清除</p> <p>这是最常见的垃圾回收方式，当变量进入环境时，就标记这个变量为”进入环境“,从逻辑上讲，永远不能释放进入环境的变量所占的内存，永远不能释放进入环境变量所占用的内存，只要执行流程进入相应的环境，就可能用到他们。当离开环境时，就标记为离开环境。</p> <p>垃圾回收器在运行的时候会给存储在内存中的变量都加上标记（所有都加），然后去掉环境变量中的变量，以及被环境变量中的变量所引用的变量（条件性去除标记），删除所有被标记的变量，删除的变量无法在环境变量中被访问所以会被删除，最后垃圾回收器，完成了内存的清除工作，并回收他们所占用的内存。</p> <p>引用计数法</p> <p>另一种不太常见的方法就是引用计数法，引用计数法的意思就是每个值没引用的次数，当声明了一个变量，并用一个引用类型的值赋值给改变量，则这个值的引用次数为1,；相反的，如果包含了对这个值引用的变量又取得了另外一个值，则原先的引用值引用次数就减1，当这个值的引用次数为0的时候，说明没有办法再访问这个值了，因此就把所占的内存给回收进来，这样垃圾收集器再次运行的时候，就会释放引用次数为0的这些值。</p> <p>用引用计数法会存在内存泄露，下面来看原因：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">problem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> objA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> objB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	objA<span class="token punctuation">.</span>someOtherObject <span class="token operator">=</span> objB<span class="token punctuation">;</span>
	objB<span class="token punctuation">.</span>anotherObject <span class="token operator">=</span> objA<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在这个例子里面，objA和objB通过各自的属性相互引用，这样的话，两个对象的引用次数都为2，在采用引用计数的策略中，由于函数执行之后，这两个对象都离开了作用域，函数执行完成之后，因为计数不为0，这样的相互引用如果大量存在就会导致内存泄露。</p> <p>特别是在DOM对象中，也容易存在这种问题：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> element<span class="token operator">=</span>document<span class="token punctuation">.</span>getElementById（’‘）；
<span class="token keyword">var</span> myObj<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myObj<span class="token punctuation">.</span>element<span class="token operator">=</span>element<span class="token punctuation">;</span>
element<span class="token punctuation">.</span>someObject<span class="token operator">=</span>myObj<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这样就不会有垃圾回收的过程。</p> <h2 id="settimeout、setinterval和requestanimationframe之间的区别"><a href="#settimeout、setinterval和requestanimationframe之间的区别" aria-hidden="true" class="header-anchor">#</a> setTimeout、setInterval和requestAnimationFrame之间的区别</h2> <p>这里有一篇文章讲的是requestAnimationFrame：<a href="http://www.cnblogs.com/xiaohuochai/p/5777186.html" target="_blank" rel="noopener noreferrer">http://www.cnblogs.com/xiaohuochai/p/5777186.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>与setTimeout和setInterval不同，requestAnimationFrame不需要设置时间间隔，</p> <p>RAF采用的是系统时间间隔，不会因为前面的任务，不会影响RAF，但是如果前面的任务多的话，
会响应setTimeout和setInterval真正运行时的时间间隔。</p> <div class="tip custom-block"><p class="custom-block-title">特点：</p> <p>（1）requestAnimationFrame会把每一帧中的所有DOM操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率。</p> <p>（2）在隐藏或不可见的元素中，requestAnimationFrame将不会进行重绘或回流，这当然就意味着更少的CPU、GPU和内存使用量</p> <p>（3）requestAnimationFrame是由浏览器专门为动画提供的API，在运行时浏览器会自动优化方法的调用，并且如果页面不是激活状态下的话，动画会自动暂停，有效节省了CPU开销。</p></div> <h2 id="简单实现node的events模块"><a href="#简单实现node的events模块" aria-hidden="true" class="header-anchor">#</a> 简单实现Node的Events模块</h2> <h3 id="参考回答："><a href="#参考回答：" aria-hidden="true" class="header-anchor">#</a> 参考回答：</h3> <p>简介：观察者模式或者说订阅模式，它定义了对象间的一种一对多的关系，让多个观察者对象同时监听某一个主题对象，当一个对象发生改变时，所有依赖于它的对象都将得到通知。</p> <p>node中的Events模块就是通过观察者模式来实现的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> events <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'events'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> eventEmitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">events<span class="token punctuation">.</span>EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
eventEmitter<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
eventEmitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">,</span> <span class="token string">'Jony yu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这样，eventEmitter发出say事件，通过On接收，并且输出结果，这就是一个订阅模式的实现，下面我们来简单的实现一个Events模块的EventEmitter。</p> <p>(1)实现简单的Event模块的emit和on方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Events</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">on</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> callBack</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handles <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>callBack<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">emit</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">eventName<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> o <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>handles<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>这样我们就定义了Events，现在我们可以开始来调用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> events <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
events<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> nama<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
events<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">,</span> <span class="token string">'Jony yu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>//结果就是通过emit调用之后，输出了Jony yu</p> <p>(2)每个对象是独立的</p> <p>因为是通过new的方式，每次生成的对象都是不相同的，因此：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> event1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> event2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
event1<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Jony event1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
event2<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Jony event2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
event1<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
event2<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'say'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>//event1、event2之间的事件监听互相不影响</p> <p>//输出结果为'Jony event1' 'Jony event2'</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.d8b5cad2.js" defer></script><script src="/assets/js/23.9a0a7c29.js" defer></script>
  </body>
</html>
