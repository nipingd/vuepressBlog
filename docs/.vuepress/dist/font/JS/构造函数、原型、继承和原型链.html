<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构造函数 | niping</title>
    <meta name="description" content="欢迎来到我的博客">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b8bd58f1.css" as="style"><link rel="preload" href="/assets/js/app.e80300b8.js" as="script"><link rel="preload" href="/assets/js/7.4fa5ddfe.js" as="script"><link rel="prefetch" href="/assets/js/10.ee8f4a87.js"><link rel="prefetch" href="/assets/js/100.335be2c9.js"><link rel="prefetch" href="/assets/js/101.095f7657.js"><link rel="prefetch" href="/assets/js/102.9be07e45.js"><link rel="prefetch" href="/assets/js/103.56d1dd45.js"><link rel="prefetch" href="/assets/js/104.83514ec7.js"><link rel="prefetch" href="/assets/js/11.2c0a3ee9.js"><link rel="prefetch" href="/assets/js/12.3c61c465.js"><link rel="prefetch" href="/assets/js/13.1fd6c1fa.js"><link rel="prefetch" href="/assets/js/14.fd72de6e.js"><link rel="prefetch" href="/assets/js/15.d0a9a6cf.js"><link rel="prefetch" href="/assets/js/16.3f3d7ea3.js"><link rel="prefetch" href="/assets/js/17.7f129077.js"><link rel="prefetch" href="/assets/js/18.1665a47e.js"><link rel="prefetch" href="/assets/js/19.64e485dd.js"><link rel="prefetch" href="/assets/js/2.12473037.js"><link rel="prefetch" href="/assets/js/20.4b82ce5a.js"><link rel="prefetch" href="/assets/js/21.142ab7fe.js"><link rel="prefetch" href="/assets/js/22.3cc372c7.js"><link rel="prefetch" href="/assets/js/23.eaa35e87.js"><link rel="prefetch" href="/assets/js/24.ebad5a11.js"><link rel="prefetch" href="/assets/js/25.24c1e1af.js"><link rel="prefetch" href="/assets/js/26.ac406c26.js"><link rel="prefetch" href="/assets/js/27.e031670e.js"><link rel="prefetch" href="/assets/js/28.9ac62515.js"><link rel="prefetch" href="/assets/js/29.e892e692.js"><link rel="prefetch" href="/assets/js/3.16c6c8d9.js"><link rel="prefetch" href="/assets/js/30.1f8b3f83.js"><link rel="prefetch" href="/assets/js/31.008f0fab.js"><link rel="prefetch" href="/assets/js/32.00b5996f.js"><link rel="prefetch" href="/assets/js/33.11cbcbbd.js"><link rel="prefetch" href="/assets/js/34.b3c8c496.js"><link rel="prefetch" href="/assets/js/35.6cde299f.js"><link rel="prefetch" href="/assets/js/36.1cc947fa.js"><link rel="prefetch" href="/assets/js/37.013ea82c.js"><link rel="prefetch" href="/assets/js/38.0eb1e924.js"><link rel="prefetch" href="/assets/js/39.24f0c31b.js"><link rel="prefetch" href="/assets/js/4.19714d75.js"><link rel="prefetch" href="/assets/js/40.c5d53d65.js"><link rel="prefetch" href="/assets/js/41.f8fff5a7.js"><link rel="prefetch" href="/assets/js/42.d1afef40.js"><link rel="prefetch" href="/assets/js/43.ac501aa0.js"><link rel="prefetch" href="/assets/js/44.334ee760.js"><link rel="prefetch" href="/assets/js/45.53770e63.js"><link rel="prefetch" href="/assets/js/46.d78e0e07.js"><link rel="prefetch" href="/assets/js/47.66cc8ece.js"><link rel="prefetch" href="/assets/js/48.f241dbab.js"><link rel="prefetch" href="/assets/js/49.4c7d25d8.js"><link rel="prefetch" href="/assets/js/5.0b47af80.js"><link rel="prefetch" href="/assets/js/50.4e55f665.js"><link rel="prefetch" href="/assets/js/51.a240bdb7.js"><link rel="prefetch" href="/assets/js/52.91af45df.js"><link rel="prefetch" href="/assets/js/53.57109bf5.js"><link rel="prefetch" href="/assets/js/54.f5b2fed8.js"><link rel="prefetch" href="/assets/js/55.625dae36.js"><link rel="prefetch" href="/assets/js/56.e611c653.js"><link rel="prefetch" href="/assets/js/57.21c9b267.js"><link rel="prefetch" href="/assets/js/58.ddbcd7ab.js"><link rel="prefetch" href="/assets/js/59.36c441ca.js"><link rel="prefetch" href="/assets/js/6.33441478.js"><link rel="prefetch" href="/assets/js/60.a632bb1d.js"><link rel="prefetch" href="/assets/js/61.f659cd2a.js"><link rel="prefetch" href="/assets/js/62.718a0b39.js"><link rel="prefetch" href="/assets/js/63.a6feaf48.js"><link rel="prefetch" href="/assets/js/64.3a8be603.js"><link rel="prefetch" href="/assets/js/65.c905e664.js"><link rel="prefetch" href="/assets/js/66.d86df139.js"><link rel="prefetch" href="/assets/js/67.a9b7eb15.js"><link rel="prefetch" href="/assets/js/68.b28c879b.js"><link rel="prefetch" href="/assets/js/69.a7f8c137.js"><link rel="prefetch" href="/assets/js/70.97a39da7.js"><link rel="prefetch" href="/assets/js/71.d79d89f6.js"><link rel="prefetch" href="/assets/js/72.6885324b.js"><link rel="prefetch" href="/assets/js/73.c16e711d.js"><link rel="prefetch" href="/assets/js/74.bc821747.js"><link rel="prefetch" href="/assets/js/75.e2212883.js"><link rel="prefetch" href="/assets/js/76.65c9f619.js"><link rel="prefetch" href="/assets/js/77.6871537f.js"><link rel="prefetch" href="/assets/js/78.80d4194c.js"><link rel="prefetch" href="/assets/js/79.955a49b5.js"><link rel="prefetch" href="/assets/js/8.43cf8d33.js"><link rel="prefetch" href="/assets/js/80.4ebb1da7.js"><link rel="prefetch" href="/assets/js/81.b9e106b3.js"><link rel="prefetch" href="/assets/js/82.633f166c.js"><link rel="prefetch" href="/assets/js/83.e432fbf4.js"><link rel="prefetch" href="/assets/js/84.31570108.js"><link rel="prefetch" href="/assets/js/85.e39018b6.js"><link rel="prefetch" href="/assets/js/86.41e3787e.js"><link rel="prefetch" href="/assets/js/87.d444d422.js"><link rel="prefetch" href="/assets/js/88.268d5961.js"><link rel="prefetch" href="/assets/js/89.5d093cc1.js"><link rel="prefetch" href="/assets/js/9.bfb96b1b.js"><link rel="prefetch" href="/assets/js/90.82f8cab4.js"><link rel="prefetch" href="/assets/js/91.e2e10bbd.js"><link rel="prefetch" href="/assets/js/92.84a7d80a.js"><link rel="prefetch" href="/assets/js/93.8c5a44bb.js"><link rel="prefetch" href="/assets/js/94.4e09a758.js"><link rel="prefetch" href="/assets/js/95.a4d94238.js"><link rel="prefetch" href="/assets/js/96.2dea0f7c.js"><link rel="prefetch" href="/assets/js/97.02747d31.js"><link rel="prefetch" href="/assets/js/98.7df022c0.js"><link rel="prefetch" href="/assets/js/99.fdc20299.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8bd58f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">niping</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>JS</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/font/JS/this、new、apply、call与bind.html" class="sidebar-link">this、new、apply、call与bind</a></li><li><a href="/font/JS/JS单线程、异步、同步.html" class="sidebar-link">JS单线程、异步、同步</a></li><li><a href="/font/JS/常用正则表达式备忘录.html" class="sidebar-link">常用正则表达式备忘录</a></li><li><a href="/font/JS/Object.defineProperty与Proxy理解整理.html" class="sidebar-link">Object.defineProperty与Proxy理解整理</a></li><li><a href="/font/JS/柯里化.html" class="sidebar-link">柯里化</a></li><li><a href="/font/JS/JS技巧.html" class="sidebar-link">JS技巧</a></li><li><a href="/font/JS/闭包.html" class="sidebar-link">闭包</a></li><li><a href="/font/JS/作用域与作用域链.html" class="sidebar-link">作用域与作用域链</a></li><li><a href="/font/JS/JS运行机制总结.html" class="sidebar-link">JS运行机制总结</a></li><li><a href="/font/JS/赋值、浅拷贝与深拷贝.html" class="sidebar-link">赋值、浅拷贝与深拷贝</a></li><li><a href="/font/JS/构造函数、原型、继承和原型链.html" class="active sidebar-link">构造函数、原型、继承和原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#构造函数" class="sidebar-link">构造函数</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#原型" class="sidebar-link">原型</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#原型链" class="sidebar-link">原型链</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#原型链继承" class="sidebar-link">原型链继承</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#javascript常用八种继承方案" class="sidebar-link">JavaScript常用八种继承方案</a></li></ul></li><li><a href="/font/JS/原生JS知识.html" class="sidebar-link">原生JS知识</a></li><li><a href="/font/JS/防抖与节流.html" class="sidebar-link">防抖与节流</a></li><li><a href="/font/JS/类型转换比较问题.html" class="sidebar-link">类型转换比较问题</a></li><li><a href="/font/JS/JS中有趣的事实.html" class="sidebar-link">JS中有趣的事实</a></li><li><a href="/font/JS/正则表达式必知必会.html" class="sidebar-link">正则表达式必知必会</a></li><li><a href="/font/JS/空对象与空数组相加问题.html" class="sidebar-link">空对象与空数组相加问题</a></li><li><a href="/font/JS/JS面试题.html" class="sidebar-link">JS面试题</a></li><li><a href="/font/JS/JS零散知识整理.html" class="sidebar-link">JS零散知识整理</a></li><li><a href="/font/JS/前端模块化.html" class="sidebar-link">前端模块化</a></li><li><a href="/font/JS/JS操作DOM常用API总结.html" class="sidebar-link">JS操作DOM常用API总结</a></li><li><a href="/font/JS/JS工具函数大全.html" class="sidebar-link">JS工具函数大全</a></li><li><a href="/font/JS/内存泄漏.html" class="sidebar-link">内存泄漏</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>浏览器网络</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="构造函数"><a href="#构造函数" aria-hidden="true" class="header-anchor">#</a> 构造函数</h2> <h3 id="什么是构造函数"><a href="#什么是构造函数" aria-hidden="true" class="header-anchor">#</a> 什么是构造函数</h3> <p>😋<code>constructor</code> <strong>返回创建实例对象时构造函数的引用</strong>。<strong>此属性的值是对函数本身的引用，而不是一个包含函数名称的字符串。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Parent<span class="token punctuation">;</span> <span class="token comment">// true</span>
p<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>构造函数本身就是一个函数，与普通函数没有任何区别，不过为了规范一般将其<strong>首字母大写</strong>。构造函数和普通函数的区别在于，<strong>使用 <code>new</code> 生成实例的函数就是构造函数，直接调用的就是普通函数</strong>。</p> <p>那是不是意味着<strong>普通函数创建的实例没有 <code>constructor</code> 属性呢？不一定。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 普通函数</span>
<span class="token keyword">function</span> <span class="token function">parent2</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">parent2</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// undefined</span>

<span class="token comment">// 普通函数</span>
<span class="token keyword">function</span> <span class="token function">parent3</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        age<span class="token punctuation">:</span> age
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token function">parent3</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p3<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="symbol-是构造函数吗"><a href="#symbol-是构造函数吗" aria-hidden="true" class="header-anchor">#</a> Symbol 是构造函数吗</h3> <p>MDN 是这样介绍 <code>Symbol</code> 的:</p> <p><strong><code>Symbol</code> 是基本数据类型</strong>，但作为构造函数来说它并不完整，因为它不支持语法 <code>new Symbol()</code>，Chrome 认为其不是构造函数，如果要生成实例直接使用 <code>Symbol()</code> 即可。（来自 MDN）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Symbol is not a constructor </span>

<span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Symbol(123)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>🐂虽然是基本数据类型，但  <code>Symbol(123)</code> 实例可以获取 <code>constructor</code> 属性值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> sym <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Symbol(123)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> sym<span class="token punctuation">.</span>constructor <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ƒ Symbol() { [native code] }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里的  <code>constructor</code> 属性来自哪里？其实是 <code>Symbol</code> 原型上的，即 <code>Symbol.prototype.constructor</code> 返回创建实例原型的函数， 默认为 <code>Symbol</code> 函数。</p> <h3 id="constructor-值只读吗"><a href="#constructor-值只读吗" aria-hidden="true" class="header-anchor">#</a> constructor 值只读吗</h3> <p>这个得分情况，对于引用类型来说 <code>constructor</code> 属性值是可以修改的，但是对于基本类型来说是只读的。</p> <p>引用类型情况其值可修改这个很好理解，比如原型链继承方案中，就需要对 <code>constructor</code>重新赋值进行修正。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">method</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 设置 Bar 的 prototype 属性为 Foo 的实例对象</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'Hello World'</span><span class="token punctuation">;</span>

<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span>
<span class="token comment">// true</span>

<span class="token comment">// 修正 Bar.prototype.constructor 为 Bar 本身</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Bar<span class="token punctuation">;</span>

<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 创建 Bar 的一个新实例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><img src="/assets/img/1559390882695.60f2e5d8.png" alt="1559390882695"></p> <p>对于基本类型来说是只读的，比如 <code>1、“muyiy”、true、Symbol</code>，当然 <code>null</code> 和 <code>undefined</code>是没有 <code>constructor</code> 属性的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span>    types <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;muyiy&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> types<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>constructor <span class="token operator">=</span> Type<span class="token punctuation">;</span>
    types<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>constructor<span class="token punctuation">,</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Type</span><span class="token punctuation">,</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> types<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// function Number() { [native code] }, false, 1</span>
<span class="token comment">// function String() { [native code] }, false, muyiy</span>
<span class="token comment">// function Boolean() { [native code] }, false, true</span>
<span class="token comment">// function Symbol() { [native code] }, false, Symbol(123)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>为什么呢？因为创建他们的是只读的原生构造函数（<code>native constructors</code>），这个例子也说明了依赖一个对象的 <code>constructor</code> 属性并不安全。</p> <h2 id="原型"><a href="#原型" aria-hidden="true" class="header-anchor">#</a> 原型</h2> <h3 id="prototype"><a href="#prototype" aria-hidden="true" class="header-anchor">#</a> prototype</h3> <p><code>JavaScript</code> 是一种<strong>基于原型的语言</strong> (prototype-based language)，这个和 <code>Java</code> 等基于类的语言不一样。</p> <p>🌟每个对象拥有一个<strong>原型对象</strong>，<strong>对象以其原型为模板，从原型继承方法和属性，这些属性和方法定义在对象的构造器函数的 <code>prototype</code> 属性上，而非对象实例本身。</strong></p> <p><img src="/assets/img/1559391894598.ed499b04.png" alt="1559391894598"></p> <p>从上面这张图可以发现，<code>Parent</code> 对象有一个原型对象 <code>Parent.prototype</code>，其上有两个属性，分别是 <code>constructor</code> 和 <code>__proto__</code>，其中 <code>__proto__</code> 已被弃用。</p> <p>构造函数 <code>Parent</code> 有一个指向原型的指针，原型 <code>Parent.prototype</code> 有一个指向构造函数的指针 <code>Parent.prototype.constructor</code>，如上图所示，其实就是一个循环引用。</p> <p><img src="data:image/png;base64,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" alt="1559391962083"></p> <h3 id="proto"><a href="#proto" aria-hidden="true" class="header-anchor">#</a> <strong>proto</strong></h3> <p>上图可以看到  Parent 原型（ <code>Parent.prototype</code> ）上有 <code>__proto__</code> 属性，这是一个<strong>访问器属性</strong>（即 getter 函数和 setter 函数），通过它可以访问到对象的内部 <code>[[Prototype]]</code> (一个对象或  <code>null</code> )。</p> <p><code>__proto__</code> 发音 dunder prototype，最先被 Firefox使用，后来在 ES6 被列为 Javascript 的标准内建属性。</p> <p><code>[[Prototype]]</code> 是对象的一个内部属性，外部代码无法直接访问。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>遵循 ECMAScript 标准，someObject.[[Prototype]] 符号用于指向 someObject 的原型。</p></div> <p><img src="/assets/img/1559392153206.291dceea.png" alt="1559392153206"></p> <p>这里用 <code>p.__proto__</code> 获取对象的原型，<code>__proto__</code> 是每个实例上都有的属性，<code>prototype</code> 是构造函数的属性，这两个并不一样，但  <code>p.__proto__</code> 和 <code>Parent.prototype</code> 指向同一个对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype
<span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>所以构造函数  <code>Parent</code>、<code>Parent.prototype</code> 和 <code>p</code> 的关系如下图。</p> <p><img src="/assets/img/1559392289979.8e77ea4b.png" alt="1559392289979"></p> <h3 id="注意点"><a href="#注意点" aria-hidden="true" class="header-anchor">#</a> 注意点</h3> <p><code>__proto__</code> 属性在 <code>ES6</code> 时才被标准化，以确保 Web 浏览器的兼容性，但是不推荐使用，除了标准化的原因之外还有性能问题。为了更好的支持，推荐使用 <code>Object.getPrototypeOf()</code>。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>通过改变一个对象的 <code>[[Prototype]]</code> 属性来改变和继承属性会对性能造成非常严重的影响，并且性能消耗的时间也不是简单的花费在 <code>obj.__proto__ = ...</code> 语句上, 它还会影响到所有继承自该 <code>[[Prototype]]</code> 的对象，如果你关心性能，你就不应该修改一个对象的 <code>[[Prototype]]</code>。</p></div> <p>如果要读取或修改对象的 <code>[[Prototype]]</code> 属性，建议使用如下方案，但是此时设置对象的 <code>[[Prototype]]</code> 依旧是一个缓慢的操作，如果性能是一个问题，就要避免这种操作。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 获取</span>
Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Reflect<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 修改</span>
Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Reflect<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果要创建一个新对象，同时继承另一个对象的  <code>[[Prototype]]</code> ，推荐使用 <code>Object.create()</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    age<span class="token punctuation">:</span> <span class="token number">50</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里 <code>child</code> 是一个新的空对象，有一个指向对象 p 的指针 <code>__proto__</code>。</p> <h2 id="原型链"><a href="#原型链" aria-hidden="true" class="header-anchor">#</a> 原型链</h2> <p>每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中继承方法和属性，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>。这种关系被称为<strong>原型链 (prototype chain)</strong>，😋通过原型链一个对象会拥有定义在其他对象中的属性和方法。</p> <p>我们看下面一个例子</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
parent<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Parent<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里 <code>parent.constructor</code> 指向 <code>Parent</code>，那是不是意味着 <code>parent</code> 实例存在 <code>constructor</code>属性呢？并不是。</p> <p>我们打印下 <code>parent</code> 值就知道了。</p> <p><img src="/assets/img/1559393278296.d8bae465.png" alt="1559393278296"></p> <p>由图可以看到实例对象 <code>p</code> 本身没有 <code>constructor</code> 属性，是通过原型链向上查找 <code>__proto__</code>，最终查找到 <code>constructor</code> 属性，该属性指向 <code>Parent</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">;</span>    <span class="token comment">// Parent {age: 50}</span>
p<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// true</span>
p<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// true</span>
p<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>下图展示了原型链的运作机制。</p> <p><img src="data:image/png;base64,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" alt="1559394033162"></p> <p><img src="/assets/img/1559394058160.55e8115a.png" alt="1559394058160"></p> <p><img src="/assets/img/1559394070193.2b501119.png" alt="1559394070193"></p> <p><img src="/assets/img/1559394082367.f8e70469.png" alt="1559394082367"></p> <h3 id="小结"><a href="#小结" aria-hidden="true" class="header-anchor">#</a> 小结</h3> <ul><li><p><code>Symbol</code> 作为构造函数来说并不完整，因为不支持语法 <code>new Symbol()</code>，但其原型上拥有 <code>constructor</code> 属性，即 <code>Symbol.prototype.constructor</code>。</p></li> <li><p>引用类型 <code>constructor</code> 属性值是可以修改的，但是对于基本类型来说是只读的，当然 <code>null</code> 和 <code>undefined</code> 没有 <code>constructor</code> 属性。</p></li> <li><p><code>__proto__</code> 是每个实例上都有的属性，<code>prototype</code> 是构造函数的属性，这两个并不一样，但  <code>p.__proto__</code> 和 <code>Parent.prototype</code> 指向同一个对象。</p></li> <li><p><code>__proto__</code> 属性在 <code>ES6</code> 时被标准化，但因为性能问题并不推荐使用，推荐使用 <code>Object.getPrototypeOf()</code>。</p></li> <li><p>每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中继承方法和属性，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这就是原型链。</p></li></ul> <p><img src="/assets/img/1559396015465.529636d7.png" alt="1559396015465"></p> <p>我们介绍了原型链的概念，即每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中<strong>继承方法和属性</strong>，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这种关系被称为**原型链 **(prototype chain)。</p> <p>根据规范不建议直接使用 <code>__proto__</code>，推荐使用 <code>Object.getPrototypeOf()</code>，不过为了行文方便逻辑清晰，下面都以 <code>__proto__</code> 代替。</p> <p>注意上面的说法，原型上的方法和属性被 <strong>继承</strong> 到新对象中，并不是被复制到新对象，我们看下面这个例子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'muyiy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 相当于 foo.__proto__ = Foo.prototype</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><img src="/assets/img/1559396199933.c22fc3c3.png" alt="1559396199933"></p> <p>原型上的属性和方法定义在 <code>prototype</code> 对象上，而非对象实例本身。<strong>当访问一个对象的属性 / 方法时，它不仅仅在该对象上查找，还会查找该对象的原型，以及该对象的原型的原型，一层一层向上查找，直到找到一个名字匹配的属性 / 方法或到达原型链的末尾（<code>null</code>）。</strong></p> <div class="tip custom-block"><p class="custom-block-title">比如调用 `foo.valueOf()` 会发生什么？</p> <ul><li>首先检查 <code>foo</code> 对象是否具有可用的 <code>valueOf()</code> 方法。</li> <li>如果没有，则检查 <code>foo</code> 对象的原型对象（即 <code>Foo.prototype</code>）是否具有可用的 <code>valueof()</code> 方法。</li> <li>如果没有，则检查 <code>Foo.prototype</code> 所指向的对象的原型对象（即 <code>Object.prototype</code>）是否具有可用的 <code>valueOf()</code> 方法。这里有这个方法，于是该方法被调用。</li></ul></div> <p><img src="/assets/img/1559396278219.a9388aa3.png" alt="1559396278219"></p> <h3 id="prototype-和-proto"><a href="#prototype-和-proto" aria-hidden="true" class="header-anchor">#</a> prototype 和 __ proto __</h3> <p>上篇文章介绍了 <code>prototype</code> 和 <code>__proto__</code> 的区别，其中原型对象 <code>prototype</code> 是构造函数的属性，<code>__proto__</code> 是每个实例上都有的属性，这两个并不一样，但 <code>foo.__proto__</code> 和 <code>Foo.prototype</code> 指向同一个对象。</p> <p>这次我们再深入一点，原型链的构建是依赖于 <code>prototype</code> 还是 <code>__proto__</code> 呢？</p> <p><img src="/assets/img/1559396594173.d274986e.png" alt="1559396594173"></p> <p><code>Foo.prototype</code> 中的 <code>prototype</code> 并没有构建成一条原型链，其只是指向原型链中的某一处。原型链的构建依赖于 <code>__proto__</code>，如上图通过 <code>foo.__proto__</code> 指向 <code>Foo.prototype</code>，<code>foo.__proto__.__proto__</code> 指向 <code>Bichon.prototype</code>，如此一层一层最终链接到 <code>null</code>。</p> <div class="tip custom-block"><p class="custom-block-title">可以这么理解 Foo:</p> <p>我是一个 constructor，我也是一个 function，我身上有着 prototype 的 reference，只要随时调用 foo = new Foo()，我就会将 <code>foo.__proto__</code> 指向到我的 prototype 对象。</p></div> <p>不要使用 <code>Bar.prototype = Foo</code>，因为这不会执行 <code>Foo</code> 的原型，而是指向函数 <code>Foo</code>。 因此原型链将会回溯到 <code>Function.prototype</code> 而不是 <code>Foo.prototype</code>，因此 <code>method</code> 方法将不会在 Bar 的原型链上。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'foo'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'method'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'bar'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Foo<span class="token punctuation">;</span> <span class="token comment">// Bar.prototype 指向到函数</span>
<span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span>

bar<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Uncaught TypeError: bar.method is not a function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><img src="/assets/img/1559396959116.224b6488.png" alt="1559396959116"></p> <h3 id="instanceof-原理及实现"><a href="#instanceof-原理及实现" aria-hidden="true" class="header-anchor">#</a> instanceof 原理及实现</h3> <p><code>instanceof</code> 运算符用来检测 <code>constructor.prototype</code> 是否存在于参数 <code>object</code> 的原型链上。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 
<span class="token keyword">function</span> <span class="token constant">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

o <span class="token keyword">instanceof</span> <span class="token class-name">C</span><span class="token punctuation">;</span> <span class="token comment">// true，因为 Object.getPrototypeOf(o) === C.prototype</span>
o <span class="token keyword">instanceof</span> <span class="token class-name">D</span><span class="token punctuation">;</span> <span class="token comment">// false，因为 D.prototype 不在 o 的原型链上</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>instanceof 原理就是一层一层查找 <code>__proto__</code>，如果和 <code>constructor.prototype</code> 相等则返回 true，如果一直没有查找成功则返回 false。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>instance<span class="token punctuation">.</span><span class="token punctuation">[</span>__proto__<span class="token operator">...</span><span class="token punctuation">]</span> <span class="token operator">===</span> instance<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>prototype
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>知道了原理后我们来实现 instanceof，代码如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">instance_of</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token constant">R</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//L 表示左表达式，R 表示右表达式</span>
   <span class="token keyword">var</span> <span class="token constant">O</span> <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span><span class="token comment">// 取 R 的显示原型</span>
   <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span><span class="token comment">// 取 L 的隐式原型</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
       <span class="token comment">// Object.prototype.__proto__ === null</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">O</span> <span class="token operator">===</span> <span class="token constant">L</span><span class="token punctuation">)</span><span class="token comment">// 这里重点：当 O 严格等于 L 时，返回 true </span>
         <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
       <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span> 
   <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>

<span class="token comment">// 测试</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 
<span class="token keyword">function</span> <span class="token constant">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">instance_of</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> <span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">instance_of</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> <span class="token constant">D</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="原型链继承"><a href="#原型链继承" aria-hidden="true" class="header-anchor">#</a> 原型链继承</h2> <p>原型链继承的本质是<strong>重写原型对象，代之以一个新类型的实例</strong>。如下代码，新原型 <code>Cat</code> 不仅有 <code>new Animal()</code> <strong>实例</strong>上的全部属性和方法，并且由于指向了 <code>Animal</code> 原型，所以还继承了<code>Animal</code> <strong>原型</strong>上的属性和方法。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 这里是关键，创建 Animal 的实例，并将该实例赋值给 Cat.prototype</span>
<span class="token comment">// 相当于 Cat.prototype.__proto__ = Animal.prototype</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'cat'</span><span class="token punctuation">;</span> <span class="token comment">// 创建 instance 的自身属性 value</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cat is runing</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">原型链继承方案有以下缺点：</p> <ul><li>1、多个实例对引用类型的操作会被篡改</li> <li>2、子类型的原型上的 constructor 属性被重写了</li> <li>3、给子类型原型添加属性和方法必须在替换原型之后</li> <li>4、创建子类型实例时无法向父类型的构造函数传参</li></ul></div> <h3 id="问题-1"><a href="#问题-1" aria-hidden="true" class="header-anchor">#</a> 问题 1</h3> <p>原型链继承方案中，原型实际上会变成另一个类型的实例，如下代码，<code>Cat.prototype</code> 变成了 <code>Animal</code> 的一个实例，所以 <code>Animal</code> 的实例属性 <code>names</code> 就变成了 <code>Cat.prototype</code> 的属性。</p> <p>而原型属性上的引用类型值会被所有实例共享，所以多个实例对引用类型的操作会被篡改。如下代码，改变了 <code>instance1.names</code> 后影响了 <code>instance2</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;cat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dog&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>names<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;tiger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;cat&quot;, &quot;dog&quot;, &quot;tiger&quot;]</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;cat&quot;, &quot;dog&quot;, &quot;tiger&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="问题-2"><a href="#问题-2" aria-hidden="true" class="header-anchor">#</a> 问题 2</h3> <p>子类型原型上的 constructor 属性被重写了，执行 <code>Cat.prototype = new Animal()</code> 后原型被覆盖，<code>Cat.prototype</code> 上丢失了 constructor 属性， <code>Cat.prototype</code> 指向了 <code>Animal.prototype</code>，而 <code>Animal.prototype.constructor</code> 指向了 <code>Animal</code>，所以 <code>Cat.prototype.constructor</code> 指向了 <code>Animal</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Animal
<span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/1559485740685.b5a077ee.png" alt="1559485740685"></p> <p>解决办法就是重写 <code>Cat.prototype.constructor</code> 属性，指向自己的构造函数 <code>Cat</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// 新增，重写 Cat.prototype 的 constructor 属性，指向自己的构造函数 Cat</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Cat<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="/assets/img/1559485762895.bae621e7.png" alt="1559485762895"></p> <h3 id="问题-3"><a href="#问题-3" aria-hidden="true" class="header-anchor">#</a> 问题 3</h3> <p>给子类型原型添加属性和方法必须在替换原型之后，原因在第二点已经解释过了，因为子类型的原型会被覆盖。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Cat<span class="token punctuation">;</span> 

<span class="token comment">// 新增</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'cat'</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="属性遮蔽"><a href="#属性遮蔽" aria-hidden="true" class="header-anchor">#</a> 属性遮蔽</h3> <p>改造上面的代码，在 <code>Cat.prototype</code> 上添加 <code>run</code> 方法，但是 <code>Animal.prototype</code> 上也有一个 <code>run</code> 方法，不过它不会被访问到，这种情况称为属性遮蔽 (property shadowing)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Cat<span class="token punctuation">;</span> 

<span class="token comment">// 新增</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'cat cat cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'cat'</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cat cat cat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>那如何访问被遮蔽的属性呢？通过 <code>__proto__</code> 调用原型链上的属性即可。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 接上</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined is runing</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="小结-2"><a href="#小结-2" aria-hidden="true" class="header-anchor">#</a> 小结</h3> <ul><li><p>每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中<strong>继承方法和属性</strong>，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这种关系被称为<strong>原型链</strong></p></li> <li><p>当访问一个对象的属性 / 方法时，它不仅仅在该对象上查找，还会查找该对象的原型，以及该对象的原型的原型，一层一层向上查找，直到找到一个名字匹配的属性 / 方法或到达原型链的末尾（<code>null</code>）。</p></li> <li><p>原型链的构建依赖于 <code>__proto__</code>，一层一层最终链接到 <code>null</code>。</p></li> <li><p>instanceof 原理就是一层一层查找 <code>__proto__</code>，如果和 <code>constructor.prototype</code> 相等则返回 true，如果一直没有查找成功则返回 false。</p></li> <li><p>原型链继承的本质是<strong>重写原型对象，代之以一个新类型的实例</strong>。</p></li></ul> <h2 id="javascript常用八种继承方案"><a href="#javascript常用八种继承方案" aria-hidden="true" class="header-anchor">#</a> JavaScript常用八种继承方案</h2> <h3 id="_1、原型链继承"><a href="#_1、原型链继承" aria-hidden="true" class="header-anchor">#</a> 1、原型链继承</h3> <p>构造函数、原型和实例之间的关系：每个构造函数都有一个原型对象，原型对象都包含一个指向构造函数的指针，而实例都包含一个原型对象的指针。</p> <p>继承的本质就是<strong>复制，即重写原型对象，代之以一个新类型的实例</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>property<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这里是关键，创建SuperType的实例，并将该实例赋值给SubType.prototype</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSubValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">getSuperValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><img src="/assets/img/1560435925530.f06c234e.png" alt="1560435925530"></p> <p>原型链方案存在的缺点：🐂<strong>多个实例对引用类型的操作会被篡改</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green,black&quot;</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green,black&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_2、借用构造函数继承"><a href="#_2、借用构造函数继承" aria-hidden="true" class="header-anchor">#</a> 2、借用构造函数继承</h3> <p>使用父类的构造函数来增强子类<strong>实例</strong>，等同于复制父类的实例给子类（不使用原型）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span>  <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span>  <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//继承自SuperType</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;red,green,blue,black&quot;</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;red,green,blue&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>核心代码是<code>SuperType.call(this)</code>，创建子类实例时调用<code>SuperType</code>构造函数，于是<code>SubType</code>的每个实例都会将SuperType中的属性复制一份。</p> <div class="tip custom-block"><p class="custom-block-title">缺点：</p> <ul><li>😋只能继承父类的<strong>实例</strong>属性和方法，不能继承原型属性/方法</li> <li>无法实现复用，每个子类都有父类实例函数的副本，影响性能</li></ul></div> <h3 id="_3、组合继承"><a href="#_3、组合继承" aria-hidden="true" class="header-anchor">#</a> 3、组合继承</h3> <p>组合上述两种方法就是组合继承。<strong>用原型链实现对原型属性和方法的继承</strong>，<strong>用借用构造函数技术来实现实例属性的继承。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 继承属性</span>
  <span class="token comment">// 第二次调用SuperType()</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 继承方法</span>
<span class="token comment">// 构建原型链</span>
<span class="token comment">// 第一次调用SuperType()</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 重写SubType.prototype的constructor属性，指向自己的构造函数SubType</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span> 
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green,black&quot;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;Nicholas&quot;;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//29</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;Greg&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green&quot;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;Greg&quot;;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//27</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><img src="/assets/img/1560435535094.6f540c93.png" alt="1560435535094"></p> <div class="tip custom-block"><p class="custom-block-title">缺点：</p> <ul><li>第一次调用<code>SuperType()</code>：给<code>SubType.prototype</code>写入两个属性name，color。</li> <li>第二次调用<code>SuperType()</code>：给<code>instance1</code>写入两个属性name，color。</li></ul> <p>实例对象<code>instance1</code>上的两个属性就屏蔽了其原型对象SubType.prototype的两个同名属性。所以，组合模式的缺点就是在使用子类创建实例对象时，<strong>其原型中会存在两份相同的属性/方法。让父亲的构造方法执行了两次.</strong></p></div> <h3 id="_4、原型式继承"><a href="#_4、原型式继承" aria-hidden="true" class="header-anchor">#</a> 4、原型式继承</h3> <p>利用一个空对象作为中介，将某个对象直接赋值给空对象构造函数的原型。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>object()对传入其中的对象执行了一次<code>浅复制</code>，将构造函数F的原型直接指向传入的对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span>
  friends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Shelby&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Court&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Van&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Greg&quot;</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Rob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> yetAnotherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
yetAnotherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Linda&quot;</span><span class="token punctuation">;</span>
yetAnotherPerson<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Barbie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//&quot;Shelby,Court,Van,Rob,Barbie&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">缺点：</p> <ul><li>原型链继承多个实例的引用类型属性指向相同，存在篡改的可能。</li> <li>无法传递参数</li></ul> <p>另外，ES5中存在<code>Object.create()</code>的方法，能够代替上面的object方法。</p></div> <h3 id="_5、寄生式继承"><a href="#_5、寄生式继承" aria-hidden="true" class="header-anchor">#</a> 5、寄生式继承</h3> <p>核心：在原型式继承的基础上，增强对象，返回构造函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span><span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> clone <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过调用 object() 函数创建一个新对象</span>
  clone<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 以某种方式来增强对象</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> clone<span class="token punctuation">;</span> <span class="token comment">// 返回这个对象</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>函数的主要作用是为构造函数新增属性和方法，以<strong>增强函数</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span>
  friends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Shelby&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Court&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Van&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">createAnother</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;hi&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">缺点（同原型式继承）：</p> <ul><li>原型链继承多个实例的引用类型属性指向相同，存在篡改的可能。</li> <li>无法传递参数</li></ul></div> <h3 id="_6、寄生组合式继承"><a href="#_6、寄生组合式继承" aria-hidden="true" class="header-anchor">#</a> 6、寄生组合式继承</h3> <p>结合借用构造函数传递参数和寄生模式实现继承</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superType<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建对象，创建父类原型的一个副本</span>
  prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subType<span class="token punctuation">;</span>                    <span class="token comment">// 增强对象，弥补因重写原型而失去的默认的constructor 属性</span>
  subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span>                      <span class="token comment">// 指定对象，将新创建的对象赋值给子类的原型</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父类初始化实例属性和原型属性</span>
<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 借用构造函数传递增强子类实例属性（支持传参和避免篡改）</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将父类原型指向子类</span>
<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>SubType<span class="token punctuation">,</span> SuperType<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新增子类原型属性</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;xyc&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;lxy&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;2&quot;]</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;3&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><img src="/assets/img/1560437715846.beb0a4ef.png" alt="1560437715846"></p> <p>这个例子的高效率体现在它只调用了一次<code>SuperType</code> 构造函数，并且因此避免了在<code>SubType.prototype</code> 上创建不必要的、多余的属性。于此同时，原型链还能保持不变；因此，还能够正常使用<code>instanceof</code> 和<code>isPrototypeOf()</code></p> <p><strong>这是最成熟的方法，也是现在库实现的方法</strong></p> <h3 id="_7、混入方式继承多个对象"><a href="#_7、混入方式继承多个对象" aria-hidden="true" class="header-anchor">#</a> 7、混入方式继承多个对象</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">SuperClass</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">OtherSuperClass</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 继承一个类</span>
<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 混合其它</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token class-name">OtherSuperClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 重新指定constructor</span>
<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> MyClass<span class="token punctuation">;</span>

<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// do something</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>Object.assign</code>会把  <code>OtherSuperClass</code>原型上的函数拷贝到 <code>MyClass</code>原型上，使 MyClass 的所有实例都可用 OtherSuperClass 的方法。</p> <h3 id="_8、es6类继承extends"><a href="#_8、es6类继承extends" aria-hidden="true" class="header-anchor">#</a> 8、ES6类继承extends</h3> <p><code>extends</code>关键字主要用于类声明或者类表达式中，以创建一个类，该类是另一个类的子类。其中<code>constructor</code>表示构造函数，一个类中只能有一个构造函数，有多个会报出<code>SyntaxError</code>错误,如果没有显式指定构造方法，则会添加默认的 <code>constructor</code>方法，使用例子如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token comment">// constructor</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">height<span class="token punctuation">,</span> width</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Getter</span>
    <span class="token keyword">get</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">calcArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Method</span>
    <span class="token function">calcArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> rectangle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">.</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出 200</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// 继承</span>
<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token keyword">extends</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">length</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 如果子类中存在构造函数，则需要在使用“this”之前首先调用 super()。</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Square'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> square <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Square</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>square<span class="token punctuation">.</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出 100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><code>extends</code>继承的核心代码如下，其实现和上述的寄生组合式继承方式一样</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_inherits</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
    <span class="token comment">// 创建对象，创建父类原型的一个副本</span>
    <span class="token comment">// 增强对象，弥补因重写原型而失去的默认的constructor 属性</span>
    <span class="token comment">// 指定对象，将新创建的对象赋值给子类的原型</span>
    subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superType <span class="token operator">&amp;&amp;</span> superType<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        constructor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            value<span class="token punctuation">:</span> subType<span class="token punctuation">,</span>
            enumerable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            writable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            configurable<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>superType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span>setPrototypeOf 
            <span class="token operator">?</span> Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>subType<span class="token punctuation">,</span> superType<span class="token punctuation">)</span> 
            <span class="token punctuation">:</span> subType<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> superType<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <p>1、函数声明和类声明的区别</p> <p>函数声明会提升，类声明不会。首先需要声明你的类，然后访问它，否则像下面的代码会抛出一个ReferenceError。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// ReferenceError</span>

<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2、ES5继承和ES6继承的区别</p> <ul><li>ES5的继承实质上是先创建子类的实例对象，然后再将父类的方法添加到this上（Parent.call(this)）.</li> <li>ES6的继承有所不同，实质上是先创建父类的实例对象this，然后再用子类的构造函数修改this。因为子类没有自己的this对象，所以必须先调用父类的super()方法，否则新建实例报错。</li></ul> <p>作者：木易杨说</p> <p>链接：https://juejin.im/post/5bcb2e295188255c55472db0</p> <p>来源：掘金</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间: </span> <span class="time">6/15/2019, 10:53:58 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.e80300b8.js" defer></script><script src="/assets/js/7.4fa5ddfe.js" defer></script>
  </body>
</html>
