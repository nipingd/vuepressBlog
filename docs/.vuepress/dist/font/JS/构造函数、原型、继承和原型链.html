<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构造函数 | niping</title>
    <meta name="description" content="欢迎来到我的博客">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b8bd58f1.css" as="style"><link rel="preload" href="/assets/js/app.47720706.js" as="script"><link rel="preload" href="/assets/js/8.977aad8c.js" as="script"><link rel="prefetch" href="/assets/js/10.d862b76b.js"><link rel="prefetch" href="/assets/js/100.8bbec48b.js"><link rel="prefetch" href="/assets/js/101.5fbb19df.js"><link rel="prefetch" href="/assets/js/102.d7a151ea.js"><link rel="prefetch" href="/assets/js/103.c85d8967.js"><link rel="prefetch" href="/assets/js/104.c84a7918.js"><link rel="prefetch" href="/assets/js/11.8ffa153b.js"><link rel="prefetch" href="/assets/js/12.9610161e.js"><link rel="prefetch" href="/assets/js/13.cdfd6c38.js"><link rel="prefetch" href="/assets/js/14.83dcfd07.js"><link rel="prefetch" href="/assets/js/15.5e09dc54.js"><link rel="prefetch" href="/assets/js/16.51d1ef80.js"><link rel="prefetch" href="/assets/js/17.f3e307ff.js"><link rel="prefetch" href="/assets/js/18.e50874cd.js"><link rel="prefetch" href="/assets/js/19.5c1b47ca.js"><link rel="prefetch" href="/assets/js/2.9d915eaf.js"><link rel="prefetch" href="/assets/js/20.aa4e295a.js"><link rel="prefetch" href="/assets/js/21.6650d6a3.js"><link rel="prefetch" href="/assets/js/22.070bd54c.js"><link rel="prefetch" href="/assets/js/23.485c0a1f.js"><link rel="prefetch" href="/assets/js/24.d287a72a.js"><link rel="prefetch" href="/assets/js/25.94ede3d6.js"><link rel="prefetch" href="/assets/js/26.3c4b58a8.js"><link rel="prefetch" href="/assets/js/27.bba657b2.js"><link rel="prefetch" href="/assets/js/28.9f1efeba.js"><link rel="prefetch" href="/assets/js/29.5dc60a7e.js"><link rel="prefetch" href="/assets/js/3.29e8bddb.js"><link rel="prefetch" href="/assets/js/30.e348cdc1.js"><link rel="prefetch" href="/assets/js/31.50614c71.js"><link rel="prefetch" href="/assets/js/32.5f5adc65.js"><link rel="prefetch" href="/assets/js/33.4451abc3.js"><link rel="prefetch" href="/assets/js/34.87a94e6e.js"><link rel="prefetch" href="/assets/js/35.1a64df8c.js"><link rel="prefetch" href="/assets/js/36.b2c1576b.js"><link rel="prefetch" href="/assets/js/37.fc875cb0.js"><link rel="prefetch" href="/assets/js/38.41c12750.js"><link rel="prefetch" href="/assets/js/39.c30a86af.js"><link rel="prefetch" href="/assets/js/4.9d3102b3.js"><link rel="prefetch" href="/assets/js/40.a3a42da0.js"><link rel="prefetch" href="/assets/js/41.40bd09ee.js"><link rel="prefetch" href="/assets/js/42.daa5719c.js"><link rel="prefetch" href="/assets/js/43.0dd848e3.js"><link rel="prefetch" href="/assets/js/44.d6831dee.js"><link rel="prefetch" href="/assets/js/45.b28edfe9.js"><link rel="prefetch" href="/assets/js/46.26607309.js"><link rel="prefetch" href="/assets/js/47.db1fd54e.js"><link rel="prefetch" href="/assets/js/48.fe482016.js"><link rel="prefetch" href="/assets/js/49.e68bd6b7.js"><link rel="prefetch" href="/assets/js/5.192c39e9.js"><link rel="prefetch" href="/assets/js/50.bbcbadb5.js"><link rel="prefetch" href="/assets/js/51.4bac396d.js"><link rel="prefetch" href="/assets/js/52.9fc199ad.js"><link rel="prefetch" href="/assets/js/53.50de3c00.js"><link rel="prefetch" href="/assets/js/54.1e850c9f.js"><link rel="prefetch" href="/assets/js/55.5d65aee9.js"><link rel="prefetch" href="/assets/js/56.d67e82bc.js"><link rel="prefetch" href="/assets/js/57.2897ba6f.js"><link rel="prefetch" href="/assets/js/58.9211cbaa.js"><link rel="prefetch" href="/assets/js/59.c5004ac4.js"><link rel="prefetch" href="/assets/js/6.3fc3e4ef.js"><link rel="prefetch" href="/assets/js/60.fa7679dc.js"><link rel="prefetch" href="/assets/js/61.dba99ea2.js"><link rel="prefetch" href="/assets/js/62.38602b18.js"><link rel="prefetch" href="/assets/js/63.d400d558.js"><link rel="prefetch" href="/assets/js/64.bd532c55.js"><link rel="prefetch" href="/assets/js/65.cee15209.js"><link rel="prefetch" href="/assets/js/66.e4d1e755.js"><link rel="prefetch" href="/assets/js/67.532fbbb0.js"><link rel="prefetch" href="/assets/js/68.dd83faf6.js"><link rel="prefetch" href="/assets/js/69.0095de62.js"><link rel="prefetch" href="/assets/js/7.b804001d.js"><link rel="prefetch" href="/assets/js/70.af6a8242.js"><link rel="prefetch" href="/assets/js/71.fe9f03db.js"><link rel="prefetch" href="/assets/js/72.658a7aa7.js"><link rel="prefetch" href="/assets/js/73.09f665a3.js"><link rel="prefetch" href="/assets/js/74.df96b2c9.js"><link rel="prefetch" href="/assets/js/75.45017907.js"><link rel="prefetch" href="/assets/js/76.a40c3b57.js"><link rel="prefetch" href="/assets/js/77.455f2a7e.js"><link rel="prefetch" href="/assets/js/78.74caf5b9.js"><link rel="prefetch" href="/assets/js/79.1c210209.js"><link rel="prefetch" href="/assets/js/80.d40a2273.js"><link rel="prefetch" href="/assets/js/81.44dc3e3a.js"><link rel="prefetch" href="/assets/js/82.7071232f.js"><link rel="prefetch" href="/assets/js/83.d50b4063.js"><link rel="prefetch" href="/assets/js/84.2e09551c.js"><link rel="prefetch" href="/assets/js/85.a7dea885.js"><link rel="prefetch" href="/assets/js/86.ebecdce5.js"><link rel="prefetch" href="/assets/js/87.5e737857.js"><link rel="prefetch" href="/assets/js/88.a717bb23.js"><link rel="prefetch" href="/assets/js/89.cee37181.js"><link rel="prefetch" href="/assets/js/9.a6bb9606.js"><link rel="prefetch" href="/assets/js/90.37276caa.js"><link rel="prefetch" href="/assets/js/91.45e51040.js"><link rel="prefetch" href="/assets/js/92.34bc803a.js"><link rel="prefetch" href="/assets/js/93.dfc2dcff.js"><link rel="prefetch" href="/assets/js/94.20ff79ff.js"><link rel="prefetch" href="/assets/js/95.d1dde844.js"><link rel="prefetch" href="/assets/js/96.f3b3ecc3.js"><link rel="prefetch" href="/assets/js/97.2b44ab4e.js"><link rel="prefetch" href="/assets/js/98.9746dae5.js"><link rel="prefetch" href="/assets/js/99.aba06790.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8bd58f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">niping</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>JS</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/font/JS/this、new、apply、call与bind.html" class="sidebar-link">this、new、apply、call与bind</a></li><li><a href="/font/JS/JS单线程、异步、同步.html" class="sidebar-link">JS单线程、异步、同步</a></li><li><a href="/font/JS/常用正则表达式备忘录.html" class="sidebar-link">常用正则表达式备忘录</a></li><li><a href="/font/JS/Object.defineProperty与Proxy理解整理.html" class="sidebar-link">Object.defineProperty与Proxy理解整理</a></li><li><a href="/font/JS/柯里化.html" class="sidebar-link">柯里化</a></li><li><a href="/font/JS/JS技巧.html" class="sidebar-link">JS技巧</a></li><li><a href="/font/JS/闭包.html" class="sidebar-link">闭包</a></li><li><a href="/font/JS/作用域与作用域链.html" class="sidebar-link">作用域与作用域链</a></li><li><a href="/font/JS/JS运行机制总结.html" class="sidebar-link">JS运行机制总结</a></li><li><a href="/font/JS/赋值、浅拷贝与深拷贝.html" class="sidebar-link">赋值、浅拷贝与深拷贝</a></li><li><a href="/font/JS/构造函数、原型、继承和原型链.html" class="active sidebar-link">构造函数、原型、继承和原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#构造函数" class="sidebar-link">构造函数</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#原型" class="sidebar-link">原型</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#原型链" class="sidebar-link">原型链</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#原型链继承" class="sidebar-link">原型链继承</a></li><li class="sidebar-sub-header"><a href="/font/JS/构造函数、原型、继承和原型链.html#javascript常用八种继承方案" class="sidebar-link">JavaScript常用八种继承方案</a></li></ul></li><li><a href="/font/JS/原生JS知识.html" class="sidebar-link">原生JS知识</a></li><li><a href="/font/JS/防抖与节流.html" class="sidebar-link">防抖与节流</a></li><li><a href="/font/JS/类型转换比较问题.html" class="sidebar-link">类型转换比较问题</a></li><li><a href="/font/JS/JS中有趣的事实.html" class="sidebar-link">JS中有趣的事实</a></li><li><a href="/font/JS/正则表达式必知必会.html" class="sidebar-link">正则表达式必知必会</a></li><li><a href="/font/JS/空对象与空数组相加问题.html" class="sidebar-link">空对象与空数组相加问题</a></li><li><a href="/font/JS/JS面试题.html" class="sidebar-link">JS面试题</a></li><li><a href="/font/JS/JS零散知识整理.html" class="sidebar-link">JS零散知识整理</a></li><li><a href="/font/JS/前端模块化.html" class="sidebar-link">前端模块化</a></li><li><a href="/font/JS/JS操作DOM常用API总结.html" class="sidebar-link">JS操作DOM常用API总结</a></li><li><a href="/font/JS/JS工具函数大全.html" class="sidebar-link">JS工具函数大全</a></li><li><a href="/font/JS/内存泄漏.html" class="sidebar-link">内存泄漏</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>浏览器网络</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h2 id="构造函数"><a href="#构造函数" aria-hidden="true" class="header-anchor">#</a> 构造函数</h2> <h3 id="什么是构造函数"><a href="#什么是构造函数" aria-hidden="true" class="header-anchor">#</a> 什么是构造函数</h3> <p>😋<code>constructor</code> <strong>返回创建实例对象时构造函数的引用</strong>。<strong>此属性的值是对函数本身的引用，而不是一个包含函数名称的字符串。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Parent<span class="token punctuation">;</span> <span class="token comment">// true</span>
p<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>构造函数本身就是一个函数，与普通函数没有任何区别，不过为了规范一般将其<strong>首字母大写</strong>。构造函数和普通函数的区别在于，<strong>使用 <code>new</code> 生成实例的函数就是构造函数，直接调用的就是普通函数</strong>。</p> <p>那是不是意味着<strong>普通函数创建的实例没有 <code>constructor</code> 属性呢？不一定。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 普通函数</span>
<span class="token keyword">function</span> <span class="token function">parent2</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">parent2</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// undefined</span>

<span class="token comment">// 普通函数</span>
<span class="token keyword">function</span> <span class="token function">parent3</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        age<span class="token punctuation">:</span> age
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token function">parent3</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p3<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="symbol-是构造函数吗"><a href="#symbol-是构造函数吗" aria-hidden="true" class="header-anchor">#</a> Symbol 是构造函数吗</h3> <p>MDN 是这样介绍 <code>Symbol</code> 的:</p> <p><strong><code>Symbol</code> 是基本数据类型</strong>，但作为构造函数来说它并不完整，因为它不支持语法 <code>new Symbol()</code>，Chrome 认为其不是构造函数，如果要生成实例直接使用 <code>Symbol()</code> 即可。（来自 MDN）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Symbol is not a constructor </span>

<span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Symbol(123)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>🐂虽然是基本数据类型，但  <code>Symbol(123)</code> 实例可以获取 <code>constructor</code> 属性值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> sym <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Symbol(123)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> sym<span class="token punctuation">.</span>constructor <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ƒ Symbol() { [native code] }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里的  <code>constructor</code> 属性来自哪里？其实是 <code>Symbol</code> 原型上的，即 <code>Symbol.prototype.constructor</code> 返回创建实例原型的函数， 默认为 <code>Symbol</code> 函数。</p> <h3 id="constructor-值只读吗"><a href="#constructor-值只读吗" aria-hidden="true" class="header-anchor">#</a> constructor 值只读吗</h3> <p>这个得分情况，对于引用类型来说 <code>constructor</code> 属性值是可以修改的，但是对于基本类型来说是只读的。</p> <p>引用类型情况其值可修改这个很好理解，比如原型链继承方案中，就需要对 <code>constructor</code>重新赋值进行修正。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">method</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 设置 Bar 的 prototype 属性为 Foo 的实例对象</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">'Hello World'</span><span class="token punctuation">;</span>

<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">;</span>
<span class="token comment">// true</span>

<span class="token comment">// 修正 Bar.prototype.constructor 为 Bar 本身</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Bar<span class="token punctuation">;</span>

<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 创建 Bar 的一个新实例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><img src="/assets/img/1559390882695.58711fb0.png" alt="1559390882695"></p> <p>对于基本类型来说是只读的，比如 <code>1、“muyiy”、true、Symbol</code>，当然 <code>null</code> 和 <code>undefined</code>是没有 <code>constructor</code> 属性的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span>    types <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;muyiy&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> types<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>constructor <span class="token operator">=</span> Type<span class="token punctuation">;</span>
    types<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>constructor<span class="token punctuation">,</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Type</span><span class="token punctuation">,</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> types<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// function Number() { [native code] }, false, 1</span>
<span class="token comment">// function String() { [native code] }, false, muyiy</span>
<span class="token comment">// function Boolean() { [native code] }, false, true</span>
<span class="token comment">// function Symbol() { [native code] }, false, Symbol(123)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>为什么呢？因为创建他们的是只读的原生构造函数（<code>native constructors</code>），这个例子也说明了依赖一个对象的 <code>constructor</code> 属性并不安全。</p> <h2 id="原型"><a href="#原型" aria-hidden="true" class="header-anchor">#</a> 原型</h2> <h3 id="prototype"><a href="#prototype" aria-hidden="true" class="header-anchor">#</a> prototype</h3> <p><code>JavaScript</code> 是一种<strong>基于原型的语言</strong> (prototype-based language)，这个和 <code>Java</code> 等基于类的语言不一样。</p> <p>🌟每个对象拥有一个<strong>原型对象</strong>，<strong>对象以其原型为模板，从原型继承方法和属性，这些属性和方法定义在对象的构造器函数的 <code>prototype</code> 属性上，而非对象实例本身。</strong></p> <p><img src="/assets/img/1559391894598.9b66c780.png" alt="1559391894598"></p> <p>从上面这张图可以发现，<code>Parent</code> 对象有一个原型对象 <code>Parent.prototype</code>，其上有两个属性，分别是 <code>constructor</code> 和 <code>__proto__</code>，其中 <code>__proto__</code> 已被弃用。</p> <p>构造函数 <code>Parent</code> 有一个指向原型的指针，原型 <code>Parent.prototype</code> 有一个指向构造函数的指针 <code>Parent.prototype.constructor</code>，如上图所示，其实就是一个循环引用。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2YAAACJBAMAAAC1ATYHAAAAMFBMVEX////sR0D6+fjbVE306ec6OjrU0tKalpVNTU1iYWHtpJ+1sbH6zMbbfnh+e3qnWVR++Eu+AAAfuElEQVR42uxbz2siWxotLkXeomEg+A9cLjWVCYEGqbcKIyNFtXY63e6clAgSCmMrDvKQtFGE3iWxEFypUQJu0itJQyjy7BIhi+lZiVllJx0GHsYfBNy83YNh5ruazsswptOm7E5lqKNWSVmp6D33fN/57r3FMBYsWLBgwYIFCxYsWLBgwYIFCxYsWLBgwYIFCxYsWLBgwYIFCxb+X4Gt73MNghBiMMam2MEL3dpI8JF5ng/IGSYmg4gntgZyhcwG8YEoQ1LLbBAnCo2NlctqyTzPUrmiPFRgbJ6bDX+fGHbYutdk8GkPJDP2VLDPmwk2x7vJOkvKZVOhIMcfKJuhA5NxNi+8m5jP2GTAXNksJm8+UGzkDkxG2bztNp2tOc3k9JH7AXVmNs5AZxPzmck4Yx6Ms7HObPCwz9vNojPG0tkXwZowNt6SzyydXcVGzpSxcVK/ppyZaSDkoXVmexz5DFs6u6kzm2l4Ex5HbLTy2ePzIA/tG2fb5gY1e0tsRBZnlm+0fOM3940WZ99WZzaLs0eos/tf1EZjIzJ/PnvEvtE+AqgDGnsWKrN84/fzjfZZhUYrNn5bndluRLQb9NkM6gzNZlwfX2/+6wiEtRtbQlef4EfAGbn+kthYbBRsY1zHSRvdGlKazfaF8cbpQogIr9EvpUu6gCNOvEHW6B3BnBMRIn5HzvDvjc+QKf7MFVI+dzljOrMLttFDgHQm0D0cMzrvPat8hp7mMRP+afQ+phG8qnl2Rr+ab4zhZMiqEtbc627/d+RsKX0dRtgt5+f+g++SOno9TAev6B7ls/u2snC97uZMcIz2wF5VMDYTN7PxxsU8g/Sj0dvIPiGRjmeH0J7tzmQycmZbXmdIrBM+TilXx78FZ3QZJIK4BvEXoVF0Xsxi0Bc9wPA559VJiCDy5QjNxjLlXi1I6NmGdLY8Wtv2El4H9jZ92xTeC4dnJvGNi3mMkseSJBHClzScvKyvNWoQI/laI9poJAOgs6ViOLFHVorcPUhzy9pXBEIIv3TmhiDY0X9CFv00NRFazvABcbRHGOHxetwRgZO4Qyi27c1U0iER/tQYZy+q7eq7F9Vq9czuOHzRfvleaI44M5jPZlKfEU+RSIUhQGFweIe78Hq9ss8JjQJdGkVVDRrCldATCWc4t7W1eQ/Ojq+tzeQpNmBFcjVAGy7RVSPE1QhhzEfWQiLiotD4XNQXkkLQidggL8J5wB0XqgVvUHbjUixw5pXVXg16IOXs3i28fCr85d+fToVfIY8Jv506WsIVZybQGbuVzKVd8qBSLmgIL3UXco36bqMBEUkkhLwud4kksifDfmUYD8sZuTi1eXTLm3euiV5JDEp7Co4l+j6RT5XUY7xS8JUV9iSjdsXVslxODxRIvN1YIlWuKBjFympPnHgl7mSbrqmUK+maaKg+A87Oq++a7TbQJCzPiLMZ1Wf8oOCrxLJSSIKchojoKWKatzCKaEHC9S+l47pGUiWvWu7oiWhOmZYy5JYvG3fhWbnX6HeZcDk3FCO5RirndCcDW4pbTX9QNddbeat2EWfIRidSgfOKmC9dfuhvuiZeKnW1ElbtNf52cH9rbqM0tf4BeezUbnN8arZb52cjzmxGXMiM6jM2pGeDG3mIg+EjBPmC1/DIN5KNREphK07PTvIIcZHCnsL1tbl9jKeOjd6yegcyGwEFedZIWNYIe7HJQVpFi1lC9H2R0/OYz4lEzyPUj0d8CnIH8NNdQmI7Ebqw/H+udb18WVbTZwaGBpc/Olrn7fPzT6/swqH0UpJeHhjW2azqM8wki9zFcQ2DdySSSzwZvu0HhsMO2disd7kKp28CZ/xQL1+6Cj89yY5t3XScFe5cHr6xw2A+sx72E2ZJBSnrHWbRT+lDaMFPqG9cyeI5nxLJQqYrKRt5iOK74TsuKvcMcGYHzpq/gr3/7ZXd1n7XPHxZPTNNPmPYQkAauPYI1o+eDMqd+mjB9qCDNuKrlWBlNScCZyf7emIQ9XaeZKf3+h7v8E48yzOEu9DCRUQWdsGqLO6gRT+ws05NI6KcPcmJCwExUgQrWTj6uRsMRXOxiZcqfaZMHTYO7r+wcaQzMI3VQ9CZ8OmA5rPqLPLZTOozfjvTCS1AR9eP5rbe5F2uoBQMBhXgjHyI5txdlDxiB1pYi3pyRTgNTc9ZIhSEhyt0611Wrme/jDmDqmMhC0r+QxbqM4ZX1xHiVWYOOJsriStZFMmD17+IX6jlSlkOBidd6/MtJmo6JBnzII7WITxaoDPgytEUxvWZ3Vg+m4nOsGewt4Y9+RCB2Eie58moZRUCnGFe9yZEktS4GnktopV01jO9bWQ88jG4cPTF4cpnv6ARZx2C3X442ZNFlLOcAl1qzBlKanqeieThKm/iF5W3b4e99Ymp4WR8L06vFsKcAQ9CrWLz3HHuaANnjhblzCYAZzaj+WwW9Rmq14updX2zJ1Lf+Kc81tVMJgN5ayOO3JWMqoHOGMm1J0mrwYq+yUwtNI/37nEQiI2IpZwxzMIa/KzFHaqzOYiNiA+Mx0H0/BsNdAYV94X2ZlMSacU26efERk5/qyZiQgzp7COV1jifLTcFylm72jI44DgbnSFu4MmvioNgav3nI4Z5nsfJy3T6rZ9yxve7lfoegdh4MvRByc2l+kdo+tj4FWNXz3YIAobCHYSWVCdC4SLlDFhk0A9rmOqM8fhLIkM9CFtQNjqImbu8hbNtL62oRWxsntr2Z8hnzRY8X9nnlw/sQvXM3m69F0xRny3tLhZFfpek4lc6S0GIXPAj4EzflSquEvWNg221tA3d3Ld+n9j4FZwFCHLvOqnOuFKcYftxtOIHr19kmHBxzNmCb42QSMCJlnx4Jcvgp/6JZQeKZYZ05IohBsf1gbMqHW9sfrTPU705TunWbjNDfbbQfZpHK4H+dkeHjP/HPFMHuf1AddaTj9mKGAvQ+ix5LPWdxLP2hTvvDcXGUteV3GGeg86QvhuK+RS84Ktht68WzcRBgWmRmdv+K0IRlZ4HZUHC1e9O/CYoSsMibRhkbJ76x4+CcPav5j/HczACDY7CmUGZzao+45WnebKh9k6KukJjI0omQqHXlLNhl1vdJVwP8tlcxflkFyMPdPPp89nX6OyylAkoDNUZOPyM3IUyrOBb55Ly9r4TsXWgHV3Ah5FiHzIsw9XlTO6Wu7SloEhmMef544HQps6DTr9QxbXoDfVNu7F1PDPyjYgAZ6tBcWk/qWAMvjEJFmSbctYR3SXY88DZUiah5zHRZe0esfFrdNZZTQcJ4uEbMMT1oSYiBP6VEP5DQ0EM4UNw4CIOOsuvpo9B62w0HfwPc9f70kaax4eH4L1YOJD5Bx4eBsuRozA874KhYW6I1KTeq3YVQSSksZIlFNFEa9fCQWtCwBfHqgkF3xjuwI23JWhiN7cunKFwuWTLEV/lEnaR2sYTfOPBcuVK7vudxPhjTcwksbujGcfJZIzzmc/3x/P9fJ8Il1Oe1ebaaMs2irurPLoKmBVWOWAGeZo9DWuuqQ60cFQW9SsNOpWfMax5EsrIzCiR9uctY5iZvqUCxPq2ow0IUqZjAoOsx8G6wi+X9BdjmuLZHsSD59QBZ+cVAdSY0OV3IGZV5UNTd047caMIKVkGDaKpX5Y1f6aNivxy6tQa3aSDUTKwUPJWB8jJ/cM4LC63uxSjzLb49FDxBG0rjuuJ9ffYT2qg59QNArkBYQod/+MlspVr0V3xTK6QRcwgN5PRs8Fmzoygia2LHTuWn2naAkFyJRYsbHpyLPAumUwmEl5yPxAOhcPw8MfIWGl5LOQNTZLppeuIGwnk1OccJalIU6qwgcEk5PY9WCPPmpcStWMbAaIoeLQ0jlvxPA5i2XF1ckb5Z+bZb5BnXaG7S0LPikV6Gfbj8ozcfz5bqW6UXnSFlh1sLAHJEQTk1+HPxifoVdKDcYCVePb03DJtYZbleW5KZbloyvFobR6ddbmKWGsdMp3SNzLjBvIsMQtmL0kZc7kRqBjzxEjFSiYcLKkQRiQHY4a47mJMM/6sSyHkolyPnFo/5JnVgsoQHe2QpA1/BhYwBwG+GRJpUe6WT+fR+Wd7OvCO6RtPfD7BSiejrBpOSmCEGAYnKAKpoIeKDOE6eFbRU10CWu36U3xfVJ8zbcKfifV130gLLTkTUf1dCUTk7l+IvpHVlE9nEDn1L6Tq7on+YaumeUaaiCj0//m2Yn1txXll2ENDsKZPFU+AE38uf3bmutWbuI8Q/UPD+nh2ZRhISDORon7M5Mb761Re5BZV4B3up6YVC3T2d9rOTa6LZ4JwhdHVpHL6ICNt5WeXy/PFc9zSX+n52H0xlLSm12+aZ03YT31LfX8my602TIjtOLRr6T+jnbtgOnnWFGQ630V92yieQa4hQHJn2wevhWcNQKMt4tYpnul/Aw38WXupsXxK0ZNxx9Pvj9t/1sD40aYGi66TZ1T/f1Pfn1UueXu1sHqmVf4Y+Vk1HyOnA0YdNY/neKYrI6e0PZgb5WeYbYmy3DSxOmIcO5efVTHDTI1dlQq0yzNd9q3ewW2PN2KWfHx8zMUWLWMLEeO1+DNjyO8PHCoNQFXb5xklVBdktC2n1sCfiQWsYK5WxjXEiqGTz6RdIqTTxRznVSaewCRXEu1a+FItzqB/E8UmZOEdzs+MgytHB0+f18fMeNh23Ig6ZT0vVepahLbzs117NBq1o9BYlLtPC5laE64GDPacpXPVgpl48hz+gl0X2qtEFPecdW/iVaFoZ3lGjCNOVR0bHK1fZhtuNz9jVvdcTMc5euKXeqlJ2r4/E3eznJuj2ZqRkzEiOZlUAq6+KaXCYq8pQERsaRKxelYRE2v7eWFHriV8oih+7PzMOAIvM+w/rPkLchoF4Ca7OUzb45nkShz4J3WcZCB4mSEcuNfsKUgjzHZkGWvQ3drIL4p0KqPAWnDCZR5VGILWL2vPV3dWVtGc1mGNcBd2tGHkbq3fGh7VAy9kgvza/BliJkz9QKzJWSclbjURJxJsCsylupNOwfhyJNnSifuQZ4RIavLAf/cnc4BjK472ASWUCYxUGj4x6cD6wkBQK3dW2jpPenY1zAiWGIRKF2h9yBrybAfuelM/1luKvNucM69rbdOASQ5/mFSmSAjaujkPfk0smvO4XsdVar0Izg5exs2RO0VzThZ5Eb604zgcXkER9mrIymc753nnMSNk6gfDjN8/7zCUPP4g84RCyxY27Qv7n1tuLw6GY61EjthPTZnkngtjB+ZFzAAc1algE6fVqTCmMquqAMBWl8IkT1ClEuyQFPBNKmMENVWSZ1ilDI624IwLPU7aMs+6RXM/N2uFTFM6al81R7F3GjbhR4RJiFlK/e1aJgNmNF2AdT5lBw+XUSB4wW7rVV5I2TNrWZkXMrlMPoXHrUVTGYC0m69zUw7QyuFdsMavJz/TMKNk/6ExEHcvvpH2S+9me0Jed2nSsL/g3R502GZGkqO0NZ4RgysxV+lomrwAO2O2g6FDhdCx0MoGI9uug4CXElsocMg8paF3jm1Xab7PS0jXLKO2UsBrGSsNHSkUDgAr64lPB2mL/mxH5jLwrJAuFvp5r92+loPNfJqb7Oli9JWquDfAMn5ISZli3p4zpzLpdXPK1efMmr9U05HXEdWVSufykf6oFbia+TcckPranjWnH0UATSBc+vh/qwCmqu7AGY/lxjxr3Z85FdXmd9x+ToXxJWl/XmEDQQsdeEb2UYU9IdwcvmrOgHo8m1Tdc9UWo0Gv03pucUrTC0f+CQBh5WDeQkIHK6UFS09p5cgf8ywOrTimZvzL4+DXPtH2HgRwb9ihbTrI5tHQcv0PY3B+dkUMwgtZdE48k+uVVjnqP3gkZ1JzHAMQr1dVvytHWBafMKeypq//qv7JumFf+yb1fWTbqUqqkuOF37+3fpYz2R6Z1WzhLxvZD5nj3W8jGRT/HP/nNRcL/9j4iveqp5FMh23jkM83Vwoym5PSm88M+28o23pLha4F2CRk6wvh18OtDez33fVC7HHSFbZwoV3s0BjYUF8Os/Gg01qaFBaDTlsoZhxyqltLPZ6gS5kKxF23gwL5ZIHeGHFap5esnmEXHdA22aY/Ptaora3cALP+tbUomDfwPrciuV47x+YXQHHHhJuAmcOlqraiEzATe7Pm1KppLa4ta3+OfJ953n9oe+csc8gYVDWdstrTzvXHicd9H6zl3Se76bQ5b/+wOwaYzjx+wiPJLL+m/Oxu2B9eiYHndrvHhw37Mcqm3rpcbr8EsSR9gJgJtJVadd/d2ZmndZsxP/UEGTOOSNMTjI0/ExbfgKGYuDFiITfeUohByNQwZbc1ntEHzyiEJWzgnsC2lhgZmKebw/RXjTo9G2GGM3+sY6BXLAJmEECaM8ViMfo7iCVFc0RVFQz1M6+S3xxDeIl4lmd9c753viflyOd9S3fef/ej7VgsaCKnL+ExkUmpVlu+51Hk20K2mE8pqiKleWH7VdlsLWdOGk47zrOk2+UUqLQd8j8FzEYFw1QgHA4PSvsvBOFBGzwbnJ0L1UAb9J9f5h98ASFHXAqNUnbjU8tiTBC29oyDXpyo6SZgtrknCMizrgVlaoLQnjhiZig9FEhPwLL5B3YDzhEKXP4daIRZGifYAUpFMyklZ8KGJRR3p+5o8T9gxhA0my+5ts7fpwEz8dbfAOZXyle3IhsvJ1+/f/2hD3lULv84919fuRxJ+Hyz8CpVTaayt8z/svom+p4cFxK2cuHvOGXFKc86nJ+hvqkvPJvcRsyIYWrZB4s09eKUZy1h5nUlaky7OIdBfGsPPw7QMGQhkNZbFl8I5MGeYSZw6ERSAc8eImbIMwbvg2AGgJhB6i+FRzf3WFej6RDq9lOLEINwEaPxaHq9mMr13gGeVQSMNcwkRc344opqT+eRZ9089X/2ri+kjWyND4P0PuyTzPPlHg6DffBSGM59kg6RMJhdk7VPrkpBliC2ey12Kdp0N/55ctuy0Kdu11LYl8ouZGNTxGq3dg3sDQreaX1QKOTGG7i09Xq7KNxZrmBNz/3OmZlkojGxMWnsMp9DPTOZjNP5ze/7c873nbO5+eYN2KcJLTQ9unNxxzdJVtuGnw21/iMQeaYN09frs+uhrc1M5K5B6AL97SIlqbkzGX0UgnfrTqoQn7Fo6PwdL4TPjGfi4AC8ar3ioM2z8jr32fwgWl9ow0Rt31whDy+xUKuhuxmhLGZiy8j4jaCJ2ZSATHsmw2vEVDPDbByawu3gg0uY5fPBYTaBz94Nl/Ab6wEcbsQmTMxYiaC64uTZuceMOBr4FDpo0cTw8FooCJjhC366uzykBciqdkFP9E5EVmNaNJ2a84dbhtfWkhC6qQwzMI+zHw8tUkKSd0m14jPmew+CYfmI80x4eEsUTqxji2enzgpYKItnAxADt8xxP2R/TA2YISSeAJ6hD7qbx+8jhhmS+wa/YvYMA2ZMN2KTZ3AmsngmisCzS6jsvqu/8Q5hiNAIsXimg6pMMp5JDDMIzwKvGN3AQfyYcJ4lQHfiNJmYHWh7tOvfXr9gpOSR9Z4ZjQJmF9JRiA4gpnuS0loN1U//e9Egq/Ho5PYySa54zLi68vEZu1rd4IAgDwJmQdZ35EVtZ3l/FlidU1fLgoxjxtbW7J1lVNuHGbwNqO5bbTwooJMdaJxx+nlDjyi2dTRbPIP7QMIfusGewV3e8bZ9AmHkJYw+uOF9cKnoIFsRzAiPqet5T0iTdpdhxn39qKkboxws/0BgNig33sGtDE/yz80t5ot6Jkamv+iZbljv9QNmm29mLmO6ek/T4tHQ1nbL5haNrrcmdaz/ElgCzFKx12dING11hVQ8PuPLzODzV2fmN87yN7lhPDz34nmd5Tee7Ao3l40ZPFi5ZW5k/Nq++bL6v0YAFr7CKpU+wVw3PvdxXxIwwxwzXwcSP+oGv5EVx+M28CQf3kKorQM9+LyoV1RXimcSkGsyGWU8A9PGYmqdcJ7p4PZhbVHTRoK4LSQHmApN/qjNhnv6fl6JLvhf9WjazILPOK0t6FpYZpgl+hfCo9u+cOhRa6b1y5mGuSn/zyQV31neOUMm0qSK/Y2C6B+7duPc18yeCbi/fQxCa3AD8PmbWL7SVdZiqr52a44yLLfMbkzv+7vXp+SHX+HPrjafeDEAmInC+X+d7PpU/KwD+zp6OGaNXfcb/t2NTnUH5cGX+FSHBvFZsOHKLREwK5IQUbS/8TSfO0Qh0YA+GV1pYo4d67uaJE1LoDEjPYCZPOvVfvB6W8DtX1laUXW9N6C36IlYk7dBm+2Z7nt8xlC1kTePX3npxL3A0Dn/f5b0BvBZ7qqtdKfN9EHiTYCZMZFWqhGfiaKGzARw/1wQ/Gw2VypYoRnMk8BF7MWirKHyMMuOn8ktvftgx4OdG+1TuOGb6990eNGLKaEO/MYXnbfbbwqNY11Bhhnsjn97A5+AXwBm41gnrnvRBZ8JDz5HZscxeuscHjb7KRuAIaxP1+yLJ6zNhzGJZ0fzerUhzbRnmhYjiuobvw2xz/huLJPQfro+HfZPxwnRQRWGvXR1PpDs79tp0Xq04EUCmP1vGTAzSGp0d3nnQ3ByqhOf8fkTWUqICD6XlWXA/S/W3S7wtczF8nyQ9ilrQIflbu01P0hs3Lj9Et6K/o3vppEw8ilC56bYsTvNqG5+3TvPQPZtrPe+QvDr9mUkyPPr7EvfDWCh/749clQoCik6bwEfL+OgMfBMc8Pg4mBKxANeyJ+Z24y5XwEXUn3b2sKCFtuNqRFKVX1b76EK+JJricsyx+xp307/r5u+m3GG2Wqc/GUZ/MYLgfjuhzndWOH4LKtjMJv3MpdBzwdDuJTngjh5VrgYG/iLmCbz8leGvR0Yaz1eAfNhGsR1gJcXELAzER+phuiJefio3NyCXF63c6RSylYEst7dAMeMhdaAmQSY+bboy9jpGPHQnclWOtHIMNN17TL4jfHA2rO+oadDm4vPY4BZRqcMM2n151GICkhWN1YlXx/tqz3hxRbinlTwcnhW9C+j/NIYCLocc0iL9jliLovnMOH9Eeo8pVQgqg+ZPPNaPMv4aObX2Ok48aQSSycBM0ORElv08aMlA3z9Z1FZvzi0tfhbjDQFhiEoA3DJahr8/Rhx2rOKYiYgB7ecOU78MAtn0VHtWZEsKjGn4MTc30Wi87asjw4b15esgS9SxS5F0jST8XLMWIqBRACzBojPYrtx8FvuvXya4ezTKY1+6aGraT2x8MPrp0Mhhll05u9pSlSIpVNp0LJbTp5VND7LJlej/IS0w5QZHY1nolVBkc21Eh0lg2KeCrDOtSfJPRLPlGIVaBIQhNIEN2aaBkGc9MfFjH9tbW00FVeX0nRgPrq4ywZADXVilAAo6hqlO8vAs+expkUaXYpEfvw+wjBTFyjHTKl8fqMTH1SICEfArFZr/JTi2YGLIEssHwDCtJRmyhOiEPVJJkYpbYqCbqSGHl6iBgThOo3oVI0mKPFAcB5L0qWJWFPaUJPfR/S/PqKA2WmfUT17ln3b0VFRelt7Vi0p055JtmdCMjz5SgvE4DrqXQNgIU2TlOXyrGWAiKqHTBoRaEQmwbQRoqZVYyVCCShFD2ViJD31gKCU9FQlPquQIjxOPDtsneeBKW6SxyRaq8FA9JhBHOXwACZEIgZsHmgA8ex8cmiyFTDqFcPDIDYg1lPqPUaN6s/eO54dfl45JVfRaVVfWI+YRoFpC62O2XeImTSsWCvIEEmBH4YRW1rGjM0VM4NVYTXYLEvVkalK3o/1z2rMs7eqC5T2Vjr9iYLbQZMreYUwSl6Rp1SwEPsg18blWXXsmZL9B5gDVsljHHU6uXqlavVnvzOeiW+xjgWnkFLgGJsehCj7ypak0nSVrNIMKa/GorLx2e+VZ6Wz6M1TFIdOU/JKr3N5wGZ0kLN5iiM6LxTwSXsOkcrHZ1V522vFM3NdJql07aUNmTkdkmS6DMzDkKT6HFEUyd5XzD2zsKI+62LwKgt+jmL+VkzyKpKUZZ5rzw7FM4saRQTOIPwRWzvskSv2I683YZQscPiHknmaDY31VauZOybxC1sN87vk/VhTXKztGqyleXY4zVkZkVwf5FA8k47yzE0/pJKYFYrP6gY7vPg4Se1i6iOtf5abwqWCTDuQZ12hcGj22GyhLzoHam3PjqIYpUqqxwP9xvbO9rGxsWudIGO1b1xr76yVDwI8g9jKrN+0KjUlvplNyd7NHrGWyrVaCqv4Y183u6UU/sM/5udbLXtxXZJrmWdaV1QcR5QD4jPxp/ZjJl016298YmFlrTQt2dBxHJ2I8U+tR2zBRfhhCwwTeRtMiW12y8TDuqLVUuwvKxxJSbJBUxOFedYXOmYS9taIZyJbQfVYSfSXwjcqa8dMvLhWmMla4pg9i4OqLs3hedEcga9Zw97hqXe1EoxlWcZH96PhGo7Necz6KSbZsg+MxSLjzShvYtpsXsU7bGR3hNohJjLQEKvLyBNWR7PnUBHhlTdWPpGVuZLLZzKzVFDx4pP8lZ0PHmwWBDvDTcw9xXfXMMEyR73FGqKGDkgWO/QdWbO2ifkvpZMbIl+5Xiwk5hMoiZcr+19g/trYzxBldfYBC5znbWJ2wl8kZGfXRY6MGWSbooM5dqhXBdXwxS511++caA7Fk6+GDo+5/X+wprFGTo1nU8mVY0rYYlQRs7YNWemXNv1yLpkr75isDuD2ZKch9wkdT8RQYRRRCX3rkqvGijFPPdrqzg5nnKnzyDoNCUL2LBe9GlANlVKEzgoDlMexkl91pTreh9Xcz5piq6K4ONWWauJ+KMWCiOWRDLngueKKK6644oorrrjiiiuu/H+DHAAAqlXGJI/4IJIAAAAASUVORK5CYII=" alt="1559391962083"></p> <h3 id="proto"><a href="#proto" aria-hidden="true" class="header-anchor">#</a> <strong>proto</strong></h3> <p>上图可以看到  Parent 原型（ <code>Parent.prototype</code> ）上有 <code>__proto__</code> 属性，这是一个<strong>访问器属性</strong>（即 getter 函数和 setter 函数），通过它可以访问到对象的内部 <code>[[Prototype]]</code> (一个对象或  <code>null</code> )。</p> <p><code>__proto__</code> 发音 dunder prototype，最先被 Firefox使用，后来在 ES6 被列为 Javascript 的标准内建属性。</p> <p><code>[[Prototype]]</code> 是对象的一个内部属性，外部代码无法直接访问。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>遵循 ECMAScript 标准，someObject.[[Prototype]] 符号用于指向 someObject 的原型。</p></div> <p><img src="/assets/img/1559392153206.5f65bdce.png" alt="1559392153206"></p> <p>这里用 <code>p.__proto__</code> 获取对象的原型，<code>__proto__</code> 是每个实例上都有的属性，<code>prototype</code> 是构造函数的属性，这两个并不一样，但  <code>p.__proto__</code> 和 <code>Parent.prototype</code> 指向同一个对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype
<span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>所以构造函数  <code>Parent</code>、<code>Parent.prototype</code> 和 <code>p</code> 的关系如下图。</p> <p><img src="/assets/img/1559392289979.48d0555f.png" alt="1559392289979"></p> <h3 id="注意点"><a href="#注意点" aria-hidden="true" class="header-anchor">#</a> 注意点</h3> <p><code>__proto__</code> 属性在 <code>ES6</code> 时才被标准化，以确保 Web 浏览器的兼容性，但是不推荐使用，除了标准化的原因之外还有性能问题。为了更好的支持，推荐使用 <code>Object.getPrototypeOf()</code>。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>通过改变一个对象的 <code>[[Prototype]]</code> 属性来改变和继承属性会对性能造成非常严重的影响，并且性能消耗的时间也不是简单的花费在 <code>obj.__proto__ = ...</code> 语句上, 它还会影响到所有继承自该 <code>[[Prototype]]</code> 的对象，如果你关心性能，你就不应该修改一个对象的 <code>[[Prototype]]</code>。</p></div> <p>如果要读取或修改对象的 <code>[[Prototype]]</code> 属性，建议使用如下方案，但是此时设置对象的 <code>[[Prototype]]</code> 依旧是一个缓慢的操作，如果性能是一个问题，就要避免这种操作。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 获取</span>
Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Reflect<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 修改</span>
Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Reflect<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果要创建一个新对象，同时继承另一个对象的  <code>[[Prototype]]</code> ，推荐使用 <code>Object.create()</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    age<span class="token punctuation">:</span> <span class="token number">50</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里 <code>child</code> 是一个新的空对象，有一个指向对象 p 的指针 <code>__proto__</code>。</p> <h2 id="原型链"><a href="#原型链" aria-hidden="true" class="header-anchor">#</a> 原型链</h2> <p>每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中继承方法和属性，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>。这种关系被称为<strong>原型链 (prototype chain)</strong>，😋通过原型链一个对象会拥有定义在其他对象中的属性和方法。</p> <p>我们看下面一个例子</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
parent<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Parent<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里 <code>parent.constructor</code> 指向 <code>Parent</code>，那是不是意味着 <code>parent</code> 实例存在 <code>constructor</code>属性呢？并不是。</p> <p>我们打印下 <code>parent</code> 值就知道了。</p> <p><img src="/assets/img/1559393278296.b3ac0c84.png" alt="1559393278296"></p> <p>由图可以看到实例对象 <code>p</code> 本身没有 <code>constructor</code> 属性，是通过原型链向上查找 <code>__proto__</code>，最终查找到 <code>constructor</code> 属性，该属性指向 <code>Parent</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">;</span>    <span class="token comment">// Parent {age: 50}</span>
p<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// true</span>
p<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// true</span>
p<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>下图展示了原型链的运作机制。</p> <p><img src="data:image/png;base64,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" alt="1559394033162"></p> <p><img src="/assets/img/1559394058160.b73f5e49.png" alt="1559394058160"></p> <p><img src="/assets/img/1559394070193.a3933514.png" alt="1559394070193"></p> <p><img src="/assets/img/1559394082367.c8fd5a69.png" alt="1559394082367"></p> <h3 id="小结"><a href="#小结" aria-hidden="true" class="header-anchor">#</a> 小结</h3> <ul><li><p><code>Symbol</code> 作为构造函数来说并不完整，因为不支持语法 <code>new Symbol()</code>，但其原型上拥有 <code>constructor</code> 属性，即 <code>Symbol.prototype.constructor</code>。</p></li> <li><p>引用类型 <code>constructor</code> 属性值是可以修改的，但是对于基本类型来说是只读的，当然 <code>null</code> 和 <code>undefined</code> 没有 <code>constructor</code> 属性。</p></li> <li><p><code>__proto__</code> 是每个实例上都有的属性，<code>prototype</code> 是构造函数的属性，这两个并不一样，但  <code>p.__proto__</code> 和 <code>Parent.prototype</code> 指向同一个对象。</p></li> <li><p><code>__proto__</code> 属性在 <code>ES6</code> 时被标准化，但因为性能问题并不推荐使用，推荐使用 <code>Object.getPrototypeOf()</code>。</p></li> <li><p>每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中继承方法和属性，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这就是原型链。</p></li></ul> <p><img src="/assets/img/1559396015465.6ef810d8.png" alt="1559396015465"></p> <p>我们介绍了原型链的概念，即每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中<strong>继承方法和属性</strong>，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这种关系被称为**原型链 **(prototype chain)。</p> <p>根据规范不建议直接使用 <code>__proto__</code>，推荐使用 <code>Object.getPrototypeOf()</code>，不过为了行文方便逻辑清晰，下面都以 <code>__proto__</code> 代替。</p> <p>注意上面的说法，原型上的方法和属性被 <strong>继承</strong> 到新对象中，并不是被复制到新对象，我们看下面这个例子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'muyiy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 相当于 foo.__proto__ = Foo.prototype</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><img src="/assets/img/1559396199933.1ca76e77.png" alt="1559396199933"></p> <p>原型上的属性和方法定义在 <code>prototype</code> 对象上，而非对象实例本身。<strong>当访问一个对象的属性 / 方法时，它不仅仅在该对象上查找，还会查找该对象的原型，以及该对象的原型的原型，一层一层向上查找，直到找到一个名字匹配的属性 / 方法或到达原型链的末尾（<code>null</code>）。</strong></p> <div class="tip custom-block"><p class="custom-block-title">比如调用 `foo.valueOf()` 会发生什么？</p> <ul><li>首先检查 <code>foo</code> 对象是否具有可用的 <code>valueOf()</code> 方法。</li> <li>如果没有，则检查 <code>foo</code> 对象的原型对象（即 <code>Foo.prototype</code>）是否具有可用的 <code>valueof()</code> 方法。</li> <li>如果没有，则检查 <code>Foo.prototype</code> 所指向的对象的原型对象（即 <code>Object.prototype</code>）是否具有可用的 <code>valueOf()</code> 方法。这里有这个方法，于是该方法被调用。</li></ul></div> <p><img src="/assets/img/1559396278219.e5335e1c.png" alt="1559396278219"></p> <h3 id="prototype-和-proto"><a href="#prototype-和-proto" aria-hidden="true" class="header-anchor">#</a> prototype 和 __ proto __</h3> <p>上篇文章介绍了 <code>prototype</code> 和 <code>__proto__</code> 的区别，其中原型对象 <code>prototype</code> 是构造函数的属性，<code>__proto__</code> 是每个实例上都有的属性，这两个并不一样，但 <code>foo.__proto__</code> 和 <code>Foo.prototype</code> 指向同一个对象。</p> <p>这次我们再深入一点，原型链的构建是依赖于 <code>prototype</code> 还是 <code>__proto__</code> 呢？</p> <p><img src="/assets/img/1559396594173.37d26347.png" alt="1559396594173"></p> <p><code>Foo.prototype</code> 中的 <code>prototype</code> 并没有构建成一条原型链，其只是指向原型链中的某一处。原型链的构建依赖于 <code>__proto__</code>，如上图通过 <code>foo.__proto__</code> 指向 <code>Foo.prototype</code>，<code>foo.__proto__.__proto__</code> 指向 <code>Bichon.prototype</code>，如此一层一层最终链接到 <code>null</code>。</p> <div class="tip custom-block"><p class="custom-block-title">可以这么理解 Foo:</p> <p>我是一个 constructor，我也是一个 function，我身上有着 prototype 的 reference，只要随时调用 foo = new Foo()，我就会将 <code>foo.__proto__</code> 指向到我的 prototype 对象。</p></div> <p>不要使用 <code>Bar.prototype = Foo</code>，因为这不会执行 <code>Foo</code> 的原型，而是指向函数 <code>Foo</code>。 因此原型链将会回溯到 <code>Function.prototype</code> 而不是 <code>Foo.prototype</code>，因此 <code>method</code> 方法将不会在 Bar 的原型链上。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'foo'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">method</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'method'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">'bar'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Foo<span class="token punctuation">;</span> <span class="token comment">// Bar.prototype 指向到函数</span>
<span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span>

bar<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Uncaught TypeError: bar.method is not a function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><img src="/assets/img/1559396959116.096201f4.png" alt="1559396959116"></p> <h3 id="instanceof-原理及实现"><a href="#instanceof-原理及实现" aria-hidden="true" class="header-anchor">#</a> instanceof 原理及实现</h3> <p><code>instanceof</code> 运算符用来检测 <code>constructor.prototype</code> 是否存在于参数 <code>object</code> 的原型链上。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 
<span class="token keyword">function</span> <span class="token constant">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

o <span class="token keyword">instanceof</span> <span class="token class-name">C</span><span class="token punctuation">;</span> <span class="token comment">// true，因为 Object.getPrototypeOf(o) === C.prototype</span>
o <span class="token keyword">instanceof</span> <span class="token class-name">D</span><span class="token punctuation">;</span> <span class="token comment">// false，因为 D.prototype 不在 o 的原型链上</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>instanceof 原理就是一层一层查找 <code>__proto__</code>，如果和 <code>constructor.prototype</code> 相等则返回 true，如果一直没有查找成功则返回 false。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>instance<span class="token punctuation">.</span><span class="token punctuation">[</span>__proto__<span class="token operator">...</span><span class="token punctuation">]</span> <span class="token operator">===</span> instance<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>prototype
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>知道了原理后我们来实现 instanceof，代码如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">instance_of</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token constant">R</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//L 表示左表达式，R 表示右表达式</span>
   <span class="token keyword">var</span> <span class="token constant">O</span> <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span><span class="token comment">// 取 R 的显示原型</span>
   <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span><span class="token comment">// 取 L 的隐式原型</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
       <span class="token comment">// Object.prototype.__proto__ === null</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> 
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">O</span> <span class="token operator">===</span> <span class="token constant">L</span><span class="token punctuation">)</span><span class="token comment">// 这里重点：当 O 严格等于 L 时，返回 true </span>
         <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
       <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span> 
   <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>

<span class="token comment">// 测试</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 
<span class="token keyword">function</span> <span class="token constant">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> 

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">instance_of</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> <span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token function">instance_of</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> <span class="token constant">D</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="原型链继承"><a href="#原型链继承" aria-hidden="true" class="header-anchor">#</a> 原型链继承</h2> <p>原型链继承的本质是<strong>重写原型对象，代之以一个新类型的实例</strong>。如下代码，新原型 <code>Cat</code> 不仅有 <code>new Animal()</code> <strong>实例</strong>上的全部属性和方法，并且由于指向了 <code>Animal</code> 原型，所以还继承了<code>Animal</code> <strong>原型</strong>上的属性和方法。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 这里是关键，创建 Animal 的实例，并将该实例赋值给 Cat.prototype</span>
<span class="token comment">// 相当于 Cat.prototype.__proto__ = Animal.prototype</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'cat'</span><span class="token punctuation">;</span> <span class="token comment">// 创建 instance 的自身属性 value</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cat is runing</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">原型链继承方案有以下缺点：</p> <ul><li>1、多个实例对引用类型的操作会被篡改</li> <li>2、子类型的原型上的 constructor 属性被重写了</li> <li>3、给子类型原型添加属性和方法必须在替换原型之后</li> <li>4、创建子类型实例时无法向父类型的构造函数传参</li></ul></div> <h3 id="问题-1"><a href="#问题-1" aria-hidden="true" class="header-anchor">#</a> 问题 1</h3> <p>原型链继承方案中，原型实际上会变成另一个类型的实例，如下代码，<code>Cat.prototype</code> 变成了 <code>Animal</code> 的一个实例，所以 <code>Animal</code> 的实例属性 <code>names</code> 就变成了 <code>Cat.prototype</code> 的属性。</p> <p>而原型属性上的引用类型值会被所有实例共享，所以多个实例对引用类型的操作会被篡改。如下代码，改变了 <code>instance1.names</code> 后影响了 <code>instance2</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;cat&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dog&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>names<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;tiger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;cat&quot;, &quot;dog&quot;, &quot;tiger&quot;]</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;cat&quot;, &quot;dog&quot;, &quot;tiger&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="问题-2"><a href="#问题-2" aria-hidden="true" class="header-anchor">#</a> 问题 2</h3> <p>子类型原型上的 constructor 属性被重写了，执行 <code>Cat.prototype = new Animal()</code> 后原型被覆盖，<code>Cat.prototype</code> 上丢失了 constructor 属性， <code>Cat.prototype</code> 指向了 <code>Animal.prototype</code>，而 <code>Animal.prototype.constructor</code> 指向了 <code>Animal</code>，所以 <code>Cat.prototype.constructor</code> 指向了 <code>Animal</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Animal
<span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/1559485740685.2c0357d6.png" alt="1559485740685"></p> <p>解决办法就是重写 <code>Cat.prototype.constructor</code> 属性，指向自己的构造函数 <code>Cat</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// 新增，重写 Cat.prototype 的 constructor 属性，指向自己的构造函数 Cat</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Cat<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="/assets/img/1559485762895.19d50e01.png" alt="1559485762895"></p> <h3 id="问题-3"><a href="#问题-3" aria-hidden="true" class="header-anchor">#</a> 问题 3</h3> <p>给子类型原型添加属性和方法必须在替换原型之后，原因在第二点已经解释过了，因为子类型的原型会被覆盖。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Cat<span class="token punctuation">;</span> 

<span class="token comment">// 新增</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'cat'</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="属性遮蔽"><a href="#属性遮蔽" aria-hidden="true" class="header-anchor">#</a> 属性遮蔽</h3> <p>改造上面的代码，在 <code>Cat.prototype</code> 上添加 <code>run</code> 方法，但是 <code>Animal.prototype</code> 上也有一个 <code>run</code> 方法，不过它不会被访问到，这种情况称为属性遮蔽 (property shadowing)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 木易杨</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'animal'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token string">' is runing'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Cat<span class="token punctuation">;</span> 

<span class="token comment">// 新增</span>
<span class="token class-name">Cat</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'cat cat cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'cat'</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cat cat cat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>那如何访问被遮蔽的属性呢？通过 <code>__proto__</code> 调用原型链上的属性即可。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 接上</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined is runing</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="小结-2"><a href="#小结-2" aria-hidden="true" class="header-anchor">#</a> 小结</h3> <ul><li><p>每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中<strong>继承方法和属性</strong>，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这种关系被称为<strong>原型链</strong></p></li> <li><p>当访问一个对象的属性 / 方法时，它不仅仅在该对象上查找，还会查找该对象的原型，以及该对象的原型的原型，一层一层向上查找，直到找到一个名字匹配的属性 / 方法或到达原型链的末尾（<code>null</code>）。</p></li> <li><p>原型链的构建依赖于 <code>__proto__</code>，一层一层最终链接到 <code>null</code>。</p></li> <li><p>instanceof 原理就是一层一层查找 <code>__proto__</code>，如果和 <code>constructor.prototype</code> 相等则返回 true，如果一直没有查找成功则返回 false。</p></li> <li><p>原型链继承的本质是<strong>重写原型对象，代之以一个新类型的实例</strong>。</p></li></ul> <h2 id="javascript常用八种继承方案"><a href="#javascript常用八种继承方案" aria-hidden="true" class="header-anchor">#</a> JavaScript常用八种继承方案</h2> <h3 id="_1、原型链继承"><a href="#_1、原型链继承" aria-hidden="true" class="header-anchor">#</a> 1、原型链继承</h3> <p>构造函数、原型和实例之间的关系：每个构造函数都有一个原型对象，原型对象都包含一个指向构造函数的指针，而实例都包含一个原型对象的指针。</p> <p>继承的本质就是<strong>复制，即重写原型对象，代之以一个新类型的实例</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>property<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这里是关键，创建SuperType的实例，并将该实例赋值给SubType.prototype</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSubValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">getSuperValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><img src="/assets/img/1560435925530.528a1718.png" alt="1560435925530"></p> <p>原型链方案存在的缺点：🐂<strong>多个实例对引用类型的操作会被篡改</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green,black&quot;</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green,black&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_2、借用构造函数继承"><a href="#_2、借用构造函数继承" aria-hidden="true" class="header-anchor">#</a> 2、借用构造函数继承</h3> <p>使用父类的构造函数来增强子类<strong>实例</strong>，等同于复制父类的实例给子类（不使用原型）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span>  <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span>  <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//继承自SuperType</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;red,green,blue,black&quot;</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//&quot;red,green,blue&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>核心代码是<code>SuperType.call(this)</code>，创建子类实例时调用<code>SuperType</code>构造函数，于是<code>SubType</code>的每个实例都会将SuperType中的属性复制一份。</p> <div class="tip custom-block"><p class="custom-block-title">缺点：</p> <ul><li>😋只能继承父类的<strong>实例</strong>属性和方法，不能继承原型属性/方法</li> <li>无法实现复用，每个子类都有父类实例函数的副本，影响性能</li></ul></div> <h3 id="_3、组合继承"><a href="#_3、组合继承" aria-hidden="true" class="header-anchor">#</a> 3、组合继承</h3> <p>组合上述两种方法就是组合继承。<strong>用原型链实现对原型属性和方法的继承</strong>，<strong>用借用构造函数技术来实现实例属性的继承。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 继承属性</span>
  <span class="token comment">// 第二次调用SuperType()</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 继承方法</span>
<span class="token comment">// 构建原型链</span>
<span class="token comment">// 第一次调用SuperType()</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 重写SubType.prototype的constructor属性，指向自己的构造函数SubType</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span> 
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green,black&quot;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;Nicholas&quot;;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//29</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;Greg&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;red,blue,green&quot;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;Greg&quot;;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//27</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><img src="/assets/img/1560435535094.03c129d3.png" alt="1560435535094"></p> <div class="tip custom-block"><p class="custom-block-title">缺点：</p> <ul><li>第一次调用<code>SuperType()</code>：给<code>SubType.prototype</code>写入两个属性name，color。</li> <li>第二次调用<code>SuperType()</code>：给<code>instance1</code>写入两个属性name，color。</li></ul> <p>实例对象<code>instance1</code>上的两个属性就屏蔽了其原型对象SubType.prototype的两个同名属性。所以，组合模式的缺点就是在使用子类创建实例对象时，<strong>其原型中会存在两份相同的属性/方法。让父亲的构造方法执行了两次.</strong></p></div> <h3 id="_4、原型式继承"><a href="#_4、原型式继承" aria-hidden="true" class="header-anchor">#</a> 4、原型式继承</h3> <p>利用一个空对象作为中介，将某个对象直接赋值给空对象构造函数的原型。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>object()对传入其中的对象执行了一次<code>浅复制</code>，将构造函数F的原型直接指向传入的对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span>
  friends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Shelby&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Court&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Van&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Greg&quot;</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Rob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> yetAnotherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
yetAnotherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Linda&quot;</span><span class="token punctuation">;</span>
yetAnotherPerson<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Barbie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//&quot;Shelby,Court,Van,Rob,Barbie&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">缺点：</p> <ul><li>原型链继承多个实例的引用类型属性指向相同，存在篡改的可能。</li> <li>无法传递参数</li></ul> <p>另外，ES5中存在<code>Object.create()</code>的方法，能够代替上面的object方法。</p></div> <h3 id="_5、寄生式继承"><a href="#_5、寄生式继承" aria-hidden="true" class="header-anchor">#</a> 5、寄生式继承</h3> <p>核心：在原型式继承的基础上，增强对象，返回构造函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span><span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> clone <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过调用 object() 函数创建一个新对象</span>
  clone<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 以某种方式来增强对象</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> clone<span class="token punctuation">;</span> <span class="token comment">// 返回这个对象</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>函数的主要作用是为构造函数新增属性和方法，以<strong>增强函数</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span>
  friends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Shelby&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Court&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Van&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">createAnother</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&quot;hi&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">缺点（同原型式继承）：</p> <ul><li>原型链继承多个实例的引用类型属性指向相同，存在篡改的可能。</li> <li>无法传递参数</li></ul></div> <h3 id="_6、寄生组合式继承"><a href="#_6、寄生组合式继承" aria-hidden="true" class="header-anchor">#</a> 6、寄生组合式继承</h3> <p>结合借用构造函数传递参数和寄生模式实现继承</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superType<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建对象，创建父类原型的一个副本</span>
  prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subType<span class="token punctuation">;</span>                    <span class="token comment">// 增强对象，弥补因重写原型而失去的默认的constructor 属性</span>
  subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span>                      <span class="token comment">// 指定对象，将新创建的对象赋值给子类的原型</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父类初始化实例属性和原型属性</span>
<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 借用构造函数传递增强子类实例属性（支持传参和避免篡改）</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将父类原型指向子类</span>
<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>SubType<span class="token punctuation">,</span> SuperType<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新增子类原型属性</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;xyc&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;lxy&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;2&quot;]</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;3&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><img src="/assets/img/1560437715846.87430329.png" alt="1560437715846"></p> <p>这个例子的高效率体现在它只调用了一次<code>SuperType</code> 构造函数，并且因此避免了在<code>SubType.prototype</code> 上创建不必要的、多余的属性。于此同时，原型链还能保持不变；因此，还能够正常使用<code>instanceof</code> 和<code>isPrototypeOf()</code></p> <p><strong>这是最成熟的方法，也是现在库实现的方法</strong></p> <h3 id="_7、混入方式继承多个对象"><a href="#_7、混入方式继承多个对象" aria-hidden="true" class="header-anchor">#</a> 7、混入方式继承多个对象</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">SuperClass</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">OtherSuperClass</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 继承一个类</span>
<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 混合其它</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token class-name">OtherSuperClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 重新指定constructor</span>
<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> MyClass<span class="token punctuation">;</span>

<span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// do something</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>Object.assign</code>会把  <code>OtherSuperClass</code>原型上的函数拷贝到 <code>MyClass</code>原型上，使 MyClass 的所有实例都可用 OtherSuperClass 的方法。</p> <h3 id="_8、es6类继承extends"><a href="#_8、es6类继承extends" aria-hidden="true" class="header-anchor">#</a> 8、ES6类继承extends</h3> <p><code>extends</code>关键字主要用于类声明或者类表达式中，以创建一个类，该类是另一个类的子类。其中<code>constructor</code>表示构造函数，一个类中只能有一个构造函数，有多个会报出<code>SyntaxError</code>错误,如果没有显式指定构造方法，则会添加默认的 <code>constructor</code>方法，使用例子如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token comment">// constructor</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">height<span class="token punctuation">,</span> width</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Getter</span>
    <span class="token keyword">get</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">calcArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Method</span>
    <span class="token function">calcArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> rectangle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">.</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出 200</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// 继承</span>
<span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token keyword">extends</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">length</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 如果子类中存在构造函数，则需要在使用“this”之前首先调用 super()。</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Square'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> square <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Square</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>square<span class="token punctuation">.</span>area<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出 100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><code>extends</code>继承的核心代码如下，其实现和上述的寄生组合式继承方式一样</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">_inherits</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
    <span class="token comment">// 创建对象，创建父类原型的一个副本</span>
    <span class="token comment">// 增强对象，弥补因重写原型而失去的默认的constructor 属性</span>
    <span class="token comment">// 指定对象，将新创建的对象赋值给子类的原型</span>
    subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superType <span class="token operator">&amp;&amp;</span> superType<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        constructor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            value<span class="token punctuation">:</span> subType<span class="token punctuation">,</span>
            enumerable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            writable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            configurable<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>superType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span>setPrototypeOf 
            <span class="token operator">?</span> Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>subType<span class="token punctuation">,</span> superType<span class="token punctuation">)</span> 
            <span class="token punctuation">:</span> subType<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> superType<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <p>1、函数声明和类声明的区别</p> <p>函数声明会提升，类声明不会。首先需要声明你的类，然后访问它，否则像下面的代码会抛出一个ReferenceError。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// ReferenceError</span>

<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2、ES5继承和ES6继承的区别</p> <ul><li>ES5的继承实质上是先创建子类的实例对象，然后再将父类的方法添加到this上（Parent.call(this)）.</li> <li>ES6的继承有所不同，实质上是先创建父类的实例对象this，然后再用子类的构造函数修改this。因为子类没有自己的this对象，所以必须先调用父类的super()方法，否则新建实例报错。</li></ul> <p>作者：木易杨说</p> <p>链接：https://juejin.im/post/5bcb2e295188255c55472db0</p> <p>来源：掘金</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间: </span> <span class="time">6/15/2019, 10:53:58 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.47720706.js" defer></script><script src="/assets/js/8.977aad8c.js" defer></script>
  </body>
</html>
