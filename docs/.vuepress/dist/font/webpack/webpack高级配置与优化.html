<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>niping</title>
    <meta name="description" content="欢迎来到我的博客">
    <link rel="icon" href="/nipingd/logo.jpg">
    
    <link rel="preload" href="/nipingd/assets/css/0.styles.6f96a58e.css" as="style"><link rel="preload" href="/nipingd/assets/js/app.99af4659.js" as="script"><link rel="preload" href="/nipingd/assets/js/2.be962301.js" as="script"><link rel="preload" href="/nipingd/assets/js/101.27e563c2.js" as="script"><link rel="prefetch" href="/nipingd/assets/js/10.bcc2dbd8.js"><link rel="prefetch" href="/nipingd/assets/js/100.2f547b65.js"><link rel="prefetch" href="/nipingd/assets/js/102.5bdd192c.js"><link rel="prefetch" href="/nipingd/assets/js/103.113baa56.js"><link rel="prefetch" href="/nipingd/assets/js/104.83225c36.js"><link rel="prefetch" href="/nipingd/assets/js/105.97f3df80.js"><link rel="prefetch" href="/nipingd/assets/js/106.8f27db50.js"><link rel="prefetch" href="/nipingd/assets/js/107.e1b73cde.js"><link rel="prefetch" href="/nipingd/assets/js/108.06c1d811.js"><link rel="prefetch" href="/nipingd/assets/js/109.b63d38c8.js"><link rel="prefetch" href="/nipingd/assets/js/11.1d37c885.js"><link rel="prefetch" href="/nipingd/assets/js/110.fac446ce.js"><link rel="prefetch" href="/nipingd/assets/js/12.e3bb55dc.js"><link rel="prefetch" href="/nipingd/assets/js/13.29c368ea.js"><link rel="prefetch" href="/nipingd/assets/js/14.b707283a.js"><link rel="prefetch" href="/nipingd/assets/js/15.81619704.js"><link rel="prefetch" href="/nipingd/assets/js/16.7eb4d057.js"><link rel="prefetch" href="/nipingd/assets/js/17.d2d73fb9.js"><link rel="prefetch" href="/nipingd/assets/js/18.d7d37e0b.js"><link rel="prefetch" href="/nipingd/assets/js/19.24d136d4.js"><link rel="prefetch" href="/nipingd/assets/js/20.8ee5823f.js"><link rel="prefetch" href="/nipingd/assets/js/21.c4404772.js"><link rel="prefetch" href="/nipingd/assets/js/22.34c2ea42.js"><link rel="prefetch" href="/nipingd/assets/js/23.9956f100.js"><link rel="prefetch" href="/nipingd/assets/js/24.7fb991c3.js"><link rel="prefetch" href="/nipingd/assets/js/25.d74c3297.js"><link rel="prefetch" href="/nipingd/assets/js/26.6bafac97.js"><link rel="prefetch" href="/nipingd/assets/js/27.b237b6df.js"><link rel="prefetch" href="/nipingd/assets/js/28.0ba6360a.js"><link rel="prefetch" href="/nipingd/assets/js/29.b187d32c.js"><link rel="prefetch" href="/nipingd/assets/js/3.c3259b4a.js"><link rel="prefetch" href="/nipingd/assets/js/30.8c2a27df.js"><link rel="prefetch" href="/nipingd/assets/js/31.6c500513.js"><link rel="prefetch" href="/nipingd/assets/js/32.6d955403.js"><link rel="prefetch" href="/nipingd/assets/js/33.ebe33ea7.js"><link rel="prefetch" href="/nipingd/assets/js/34.4b59aa47.js"><link rel="prefetch" href="/nipingd/assets/js/35.b55310c3.js"><link rel="prefetch" href="/nipingd/assets/js/36.d2a174a9.js"><link rel="prefetch" href="/nipingd/assets/js/37.5a7c7177.js"><link rel="prefetch" href="/nipingd/assets/js/38.303f02a5.js"><link rel="prefetch" href="/nipingd/assets/js/39.beffd281.js"><link rel="prefetch" href="/nipingd/assets/js/4.5295cd07.js"><link rel="prefetch" href="/nipingd/assets/js/40.b7149b0c.js"><link rel="prefetch" href="/nipingd/assets/js/41.c1c1e1a4.js"><link rel="prefetch" href="/nipingd/assets/js/42.8da1ca44.js"><link rel="prefetch" href="/nipingd/assets/js/43.b6200fcb.js"><link rel="prefetch" href="/nipingd/assets/js/44.af99a614.js"><link rel="prefetch" href="/nipingd/assets/js/45.e1314428.js"><link rel="prefetch" href="/nipingd/assets/js/46.5be5576e.js"><link rel="prefetch" href="/nipingd/assets/js/47.45d324ea.js"><link rel="prefetch" href="/nipingd/assets/js/48.ceed8430.js"><link rel="prefetch" href="/nipingd/assets/js/49.1767681c.js"><link rel="prefetch" href="/nipingd/assets/js/5.88e36e75.js"><link rel="prefetch" href="/nipingd/assets/js/50.4537231f.js"><link rel="prefetch" href="/nipingd/assets/js/51.90c57b4c.js"><link rel="prefetch" href="/nipingd/assets/js/52.3c8e389b.js"><link rel="prefetch" href="/nipingd/assets/js/53.8b0e56e6.js"><link rel="prefetch" href="/nipingd/assets/js/54.a21dc7c7.js"><link rel="prefetch" href="/nipingd/assets/js/55.497ec95c.js"><link rel="prefetch" href="/nipingd/assets/js/56.51464be0.js"><link rel="prefetch" href="/nipingd/assets/js/57.3962555c.js"><link rel="prefetch" href="/nipingd/assets/js/58.a6252c57.js"><link rel="prefetch" href="/nipingd/assets/js/59.5b81f276.js"><link rel="prefetch" href="/nipingd/assets/js/6.b8431b5d.js"><link rel="prefetch" href="/nipingd/assets/js/60.14815d8c.js"><link rel="prefetch" href="/nipingd/assets/js/61.70081c66.js"><link rel="prefetch" href="/nipingd/assets/js/62.2a55e1a0.js"><link rel="prefetch" href="/nipingd/assets/js/63.06747186.js"><link rel="prefetch" href="/nipingd/assets/js/64.fc18d9a2.js"><link rel="prefetch" href="/nipingd/assets/js/65.d903eb91.js"><link rel="prefetch" href="/nipingd/assets/js/66.399a04d3.js"><link rel="prefetch" href="/nipingd/assets/js/67.4470a24f.js"><link rel="prefetch" href="/nipingd/assets/js/68.a6748984.js"><link rel="prefetch" href="/nipingd/assets/js/69.31f54459.js"><link rel="prefetch" href="/nipingd/assets/js/7.89f604f4.js"><link rel="prefetch" href="/nipingd/assets/js/70.cec157d6.js"><link rel="prefetch" href="/nipingd/assets/js/71.842dcd19.js"><link rel="prefetch" href="/nipingd/assets/js/72.6594745d.js"><link rel="prefetch" href="/nipingd/assets/js/73.4b29091b.js"><link rel="prefetch" href="/nipingd/assets/js/74.986a9a8a.js"><link rel="prefetch" href="/nipingd/assets/js/75.92e2aa2f.js"><link rel="prefetch" href="/nipingd/assets/js/76.fee05abe.js"><link rel="prefetch" href="/nipingd/assets/js/77.02729afd.js"><link rel="prefetch" href="/nipingd/assets/js/78.e1272616.js"><link rel="prefetch" href="/nipingd/assets/js/79.e00fc400.js"><link rel="prefetch" href="/nipingd/assets/js/8.d72a1762.js"><link rel="prefetch" href="/nipingd/assets/js/80.576b6ee5.js"><link rel="prefetch" href="/nipingd/assets/js/81.34624f3d.js"><link rel="prefetch" href="/nipingd/assets/js/82.110af9a2.js"><link rel="prefetch" href="/nipingd/assets/js/83.8d951a6e.js"><link rel="prefetch" href="/nipingd/assets/js/84.fe0aafc5.js"><link rel="prefetch" href="/nipingd/assets/js/85.c796e702.js"><link rel="prefetch" href="/nipingd/assets/js/86.807aa0c9.js"><link rel="prefetch" href="/nipingd/assets/js/87.74041dab.js"><link rel="prefetch" href="/nipingd/assets/js/88.75cae175.js"><link rel="prefetch" href="/nipingd/assets/js/89.c9c11cef.js"><link rel="prefetch" href="/nipingd/assets/js/9.cdb1e4da.js"><link rel="prefetch" href="/nipingd/assets/js/90.38c14115.js"><link rel="prefetch" href="/nipingd/assets/js/91.bd61216b.js"><link rel="prefetch" href="/nipingd/assets/js/92.95ac86ba.js"><link rel="prefetch" href="/nipingd/assets/js/93.a6667d33.js"><link rel="prefetch" href="/nipingd/assets/js/94.9d758c8e.js"><link rel="prefetch" href="/nipingd/assets/js/95.8db8b910.js"><link rel="prefetch" href="/nipingd/assets/js/96.925add3c.js"><link rel="prefetch" href="/nipingd/assets/js/97.744d731e.js"><link rel="prefetch" href="/nipingd/assets/js/98.a0a8a7bd.js"><link rel="prefetch" href="/nipingd/assets/js/99.de1c29ab.js">
    <link rel="stylesheet" href="/nipingd/assets/css/0.styles.6f96a58e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nipingd/" class="home-link router-link-active"><!----> <span class="site-name">niping</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nipingd/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/nipingd/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/nipingd/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/nipingd/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nipingd/" class="nav-link">HOME</a></div><div class="nav-item"><a href="/nipingd/font/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/nipingd/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/nipingd/other/" class="nav-link">个人学习笔记</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.instagram.com/nipingd/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  instagram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/nipingd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nipingd/font/webpack/慕课webpack.html" class="sidebar-link">慕课webpack</a></li><li><a href="/nipingd/font/webpack/webpack基础知识.html" class="sidebar-link">webpack基础知识</a></li><li><a href="/nipingd/font/webpack/webpack面试题.html" class="sidebar-link">webpack面试题</a></li><li><a href="/nipingd/font/webpack/webpack高级配置与优化.html" class="active sidebar-link">webpack高级配置与优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#一、打包多页面应用" class="sidebar-link">一、打包多页面应用</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#二、配置source-map" class="sidebar-link">二、⭐️配置source-map</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#三、watch和watchoptions配置" class="sidebar-link">三、watch和watchOptions配置</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#四、三个常见小插件的使用" class="sidebar-link">四、三个常见小插件的使用</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#五、webpack跨域问题" class="sidebar-link">五、⭐️webpack跨域问题</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#六、resolve配置" class="sidebar-link">六、⭐️resolve配置</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#七、设置环境变量" class="sidebar-link">七、⭐️设置环境变量</a></li><li class="sidebar-sub-header"><a href="/nipingd/font/webpack/webpack高级配置与优化.html#八、webpack优化" class="sidebar-link">八、⭐️webpack优化</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>转载自：<a href="https://segmentfault.com/a/1190000020320871" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/1190000020320871<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="一、打包多页面应用"><a href="#一、打包多页面应用" class="header-anchor">#</a> 一、打包多页面应用</h2> <p>所谓打包多页面，就是<strong>同时打包出多个html页面</strong>，打包多页面也是使用html-webpack-plugin，只不过，在引入插件的时候是<strong>创建多个插件对象</strong>，因为<strong>一个html-webpack-plugin插件对象只能打包出一个html页面</strong>。如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        index<span class="token punctuation">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 指定打包输出的chunk名为index</span>
        foo<span class="token punctuation">:</span> <span class="token string">&quot;./src/foo.js&quot;</span> <span class="token comment">// 指定打包输出的chunk名为foo</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token string">&quot;./src/index.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 要打包输出哪个文件，可以使用相对路径</span>
            filename<span class="token punctuation">:</span> <span class="token string">&quot;index.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 打包输出后该html文件的名称</span>
            chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 数组元素为chunk名称，即entry属性值为对象的时候指定的名称，index页面只引入index.js</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            template<span class="token punctuation">:</span> <span class="token string">&quot;./src/index.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 要打包输出哪个文件，可以使用相对路径</span>
            filename<span class="token punctuation">:</span> <span class="token string">&quot;foo.html&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 打包输出后该html文件的名称</span>
            chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 数组元素为chunk名称，即entry属性值为对象的时候指定的名称，foo页面只引入foo.js</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">chunks属性</p> <p>打包多页面时，关键在于<strong>chunks属性的配置</strong>，因为在没有配置chunks属性的情况下，打包输出的index.html和foo.html都会同时引入index.js和foo.js,所以必须配置chunks属性，<strong>来指定打包输出后的html文件中要引入的输出模块，数组的元素为entry属性值为对象的时候指定的chunk名</strong>，如上配置，才能实现，index.html只引入index.js，foo.html只引入foo.js文件</p></div> <h2 id="二、配置source-map"><a href="#二、配置source-map" class="header-anchor">#</a> 二、⭐️配置source-map</h2> <p>source-map就是<strong>源码映射</strong>，主要是为了<strong>方便代码调试</strong>，因为我们打包上线后的代码会被压缩等处理，导致所有代码都被压缩成了一行，如果代码中出现错误，那么<strong>浏览器只会提示出错位置在第一行</strong>，这样我们无法真正知道出错地方在源码中的具体位置。webpack提供了一个<strong>devtool</strong>属性来配置源码映射。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> foo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">lg</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">console对象的方法名log写成了lg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 源文件第二行出错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>index.js:1 Uncaught TypeError: console.lg is not a function
    at Object.&lt;anonymous&gt; (index.js:1)
    at o (index.js:1)
    at Object.&lt;anonymous&gt; (index.js:1)
    at o (index.js:1)
    at index.js:1
    at index.js:1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p><strong>源码中出错的位置明明是第二行代码，而浏览器中提示的错误确实在第一行</strong>，所以如果代码很复杂的情况下，我们就无法找到出错的具体位置</p></blockquote> <p>devtool常见的有4种配置:
① <strong>source-map</strong>: 这种模式会<strong>产生一个.map文件，出错了会提示具体的行和列</strong>，文件里面保留了打包后的文件与原始文件之间的映射关系，打包输出文件中会指向生成的.map文件，告诉js引擎源码在哪里，由于源码与.map文件分离，所以<strong>需要浏览器发送请求去获取.map文件</strong>,常用于<strong>生产环境</strong>，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//# sourceMappingURL=index.js.map</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>② <strong>eval</strong>: 这种模式打包速度最快，不会生成.map文件，会使用eval将模块包裹，在末尾加入sourceURL，常用于<strong>开发环境</strong>，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//# sourceURL=webpack:///./src/index.js</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>③ <strong>eval-source-map</strong>: 每个 module 会通过 eval() 来执行，并且生成一个 <strong>DataUrl</strong> 形式的 SourceMap(即<strong>base64编码形式内嵌到eval语句末尾</strong>), 但是<strong>不会生成.map文件，可以</strong>减少网络请求**，但是**打包文件会非常大。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanM/YjYzNSJdLCJuYW1lcyI6WyJmb28iLCJjb25zb2xlIiwibGciXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLEdBQUcsR0FBRyxDQUFWO0FBQ0FDLE9BQU8sQ0FBQ0MsRUFBUix1RSxDQUFxQyIsImZpbGUiOiIuL3NyYy9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBmb28gPSAxO1xuY29uc29sZS5sZyhgY29uc29sZeWvueixoeeahOaWueazleWQjWxvZ+WGmeaIkOS6hmxnYCk7IC8vIOa6kOaWh+S7tuesrOS6jOihjOWHuumUmVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/index.js</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>④ <strong>cheap-source-map</strong>: 加上 cheap，就<strong>只会提示到第几行报错，少了列信息提示，同时不会对引入的库做映射</strong>，可以提高打包性能，但是<strong>会产生.map文件</strong>。</p> <p>③ <strong>cheap-module-source-map</strong>: 和cheap-source-map相比，<strong>加上了module，就会对引入的库做映射</strong>，并且<strong>也会产生.map文件</strong>，用于<strong>生产环境</strong>。</p> <p>④ <strong>cheap-module-eval-source-map</strong>: 常用于<strong>开发环境</strong>，使用 cheap 模式可以大幅提高 souremap 生成的效率，加上module同时会对引入的库做映射，eval提高打包构建速度，并且不会产生.map文件减少网络请求。</p> <blockquote><p>凡是带eval的模式都不能用于生产环境，因为其不会产生.map文件，会导致<strong>打包后的文件变得非常大</strong>。通常我们并<strong>不关心列信息</strong>，所以都会使用cheap模式，但是我们也还是需要对第三方库做映射，以便精准找到错误的位置。</p></blockquote> <h2 id="三、watch和watchoptions配置"><a href="#三、watch和watchoptions配置" class="header-anchor">#</a> 三、watch和watchOptions配置</h2> <p>webpack 可以监听文件变化，当它们修改后会重新编译，如果需要开启该功能，那么需要将<strong>watch设置为true</strong>，具体监听配置通过<strong>watchOptions</strong>进行相应的设置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    watch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    watchOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        poll<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 每隔一秒轮询一次文件是否发生变化</span>
        aggregateTimeout<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 当第一个文件更改，会在重新构建前增加延迟。这个选项允许 webpack 将这段时间内进行的任何其他更改都聚合到一次重新构建里</span>
        ignored<span class="token punctuation">:</span> <span class="token operator">/</span>node_modules<span class="token operator">/</span> <span class="token comment">// 排除一些文件的监听</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="四、三个常见小插件的使用"><a href="#四、三个常见小插件的使用" class="header-anchor">#</a> 四、三个常见小插件的使用</h2> <p>① <strong>clean-webpack-plugin</strong>: 其作用就是<strong>每次打包前先先将输出目录中的内容进行清空</strong>，然后再将打包输出的文件输出到输出目录中。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>CleanWebpackPlugin<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;clean-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 打包前清空输出目录</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>需要注意的是，require(&quot;clean-webpack-plugin)的结果是一个对象而不是类，<strong>这个对象中的CleanWebpackPlugin属性才是一个类</strong>，我们就是用这个类去创建插件对象</p></blockquote> <p>② <strong>copy-webpack-plugin</strong>: 其作用就是<strong>打包的时候带上一些readMe.md、history.md等等一起输出到输出目录中</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">&quot;./readMe.md&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 将项目根目录下的readMe.md文件一起拷贝到输出目录中</span>
                to<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span> <span class="token comment">// 属性值为空字符串则表示是输出目录</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>③ <strong>BannerPlugin</strong>: 其作用就是<strong>在打包输出的js文件的头部添加一些文字注释</strong>，比如版权说明等等，<strong>BannerPlugin是webpack内置的插件</strong>，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>BannerPlugin</span><span class="token punctuation">(</span><span class="token string">&quot;Copyright © 2019&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 在js文件头部添加版权说明</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="五、webpack跨域问题"><a href="#五、webpack跨域问题" class="header-anchor">#</a> 五、⭐️webpack跨域问题</h2> <p>为什么webpack会存在跨域问题？因为webpack打包的是前端代码，其最终会被部署到前端服务器上，而<strong>前后端代码通常部署在不同的服务器上，即使是部署在同一个服务器上，所使用的端口也是不一样的</strong>，当前端代码通过ajax等手段向后端服务器获取数据的时候，由于前后端代码不在同一个域中，故存在跨域问题。比如，我们通过webpack的devServer来运行部署我们的前端应用代码，devServer启动在<strong>8080</strong>端口上，而前端应用代码中会通过ajax请求后端数据，后端服务器启动在<strong>3000</strong>端口上。
// index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// xhr.open(&quot;get&quot;, &quot;http://localhost:3000/api/test&quot;); // 由于跨域问题无法直接访问到http://localhost:3000下的资源</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/api/test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 本来是要访问http://localhost:3000/api/test</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>由于前端代码是运行在浏览器中的，如果在前端代码中直接通过ajax向<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:3000/api/test发起请求获取数据，那么由于<strong>浏览器同源策略</strong>的影响，会存在跨域的问题，所以必须访问/api/test，但是这样访问又会出现404问题，因为其实访问的是<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:8080/api/test，8080服务器上是没有该资源的，解决办法就是<strong>通过devServer配置一个代理服务器</strong></p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;/api&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:3000&quot;</span> <span class="token comment">// 路径以/api开头则代理到localhost:3000上</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>访问<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:8080/api/test就会被代理到<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:3000/api/test上，proxy还支持路径的重写，如果3000端口服务器上并没有/api/test路径，只有/test路径，那么就可以对路径进行重写，将/api替换掉</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;/api&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
                target<span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:3000&quot;</span><span class="token punctuation">,</span>
                pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">}</span> <span class="token comment">// 将/api替换掉</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>访问<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:8080/api/test就会被代理到<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:3000/test上</p></blockquote> <p>如果前端只是想mock一些数据，并不需要真正的去访问后台服务器，那么我们可以通过devServer提供的<strong>before钩子函数</strong>获取到内置的服务器对象进行处理请求，<strong>这个内置的服务器对象就是webpack的devServer即8080端口的server</strong>，因为是在同一个服务器中请求数据所以也不会出现跨域问题。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">before</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 此app即webpack的devServer</span>
            app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/test&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">&quot;even&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>我们还可以不通过webpack提供的devServer来启动webpack，而是<strong>使用自己服务器来启动webapck</strong>。
// server.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 引入webpack</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./webpack.config.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 引入配置文件</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建webpack的编译器</span>
<span class="token keyword">const</span> middleWare <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-dev-middleware&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//引入webpack的中间件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">middleWare</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将compiler编译器交给中间件处理</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/api/test&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">&quot;lhb&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>通过自定义服务器启动webpack，这样webpack中的前端代码请求数据就和服务器的资源在同一个域中了。</p></blockquote> <h2 id="六、resolve配置"><a href="#六、resolve配置" class="header-anchor">#</a> 六、⭐️resolve配置</h2> <p>resolve用于配置模块的解析相关参数的，其属性值为<strong>一个对象</strong>。
① <strong>modules</strong>: 告诉webpack 解析模块时应该搜索的目录，即require或import模块的时候，只写模块名的时候，到哪里去找，其<strong>属性值为数组</strong>，因为<strong>可配置多个模块搜索路径</strong>，其搜索路径<strong>必须为绝对路径</strong>，比如，src目录下面有一个foo.js文件和index.js文件:
// index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 必须写全foo.js模块的路径</span>
<span class="token comment">// const foo = require(&quot;foo&quot;); // resolve.modules中配置了模块解析路径为.src目录，则可用只写foo即可搜索到foo.js模块</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        modules<span class="token punctuation">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>由于resolve.modules中配置了./src目录作为模块的搜索目录，所以index.js中可以只写模块名即可搜索到foo.js模块</p></blockquote> <p>② <strong>alias</strong>: 用于给路径或者文件取别名，当import或者require的模块的<strong>路径非常长</strong>时，我们可以给该模块的<strong>路径</strong>或者<strong>整个路径名+文件名</strong>都设置成一个别名，然后直接引入别名即可找到该模块，比如，有一个模块位置非常深</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// const foo = require(&quot;./a/b/c/foo&quot;); // foo.js在./src/a/b/c/foo.js</span>
<span class="token comment">// const foo = require(&quot;foo&quot;); // foo被映射成了./src/a/b/c/foo.js文件</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;bar/foo.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bar被映射成了./src/a/b/c/路径</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;foo&quot;</span><span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/a/b/c/foo.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">&quot;bar&quot;</span><span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/a/b/c/&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>需要注意的就是，<strong>alias可以映射文件也可以映射路径</strong></p></blockquote> <p>③ <strong>mainFields</strong>: 我们的package.json中可以有多个字段，用于决定优先使用哪个字段来导入模块，比如bootstrap模块中含有js也含有css，其package.json文件中main字段对应的是&quot;dist/js/bootstrap&quot;，style字段中对应的是&quot;dist/css/bootstrap.css&quot;,我们可以通过设置mainFields字段来改变默认引入，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;main&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>④ <strong>extensions</strong>: 用于设置引入模块的时候，如果没有写模块后缀名，webpack会自动添加后缀去查找，extensions就是用于设置自动添加后缀的顺序，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>如果项目中引入了foo模块，require(&quot;./foo&quot;),其会优先找./foo.js,如果没有找到./foo.js则会去找./foo.vue文件</p></blockquote> <h2 id="七、设置环境变量"><a href="#七、设置环境变量" class="header-anchor">#</a> 七、⭐️设置环境变量</h2> <p>设置环境变量需要用到webpack提供的一个内置插件<strong>DefinePlugin</strong>插件，其作用是将一个字符串值设置为全局变量，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token constant">DEV_MODE</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token comment">// 将'development'设置为全局变量DEV_MODE</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>这样配置之后任何一个模块中都可以直接使用DEV_MODE变量了，并且其值为'development',与ProvidePlugin有点相似，<strong>ProvidePlugin是将一个模块注入到所有模块中</strong>，<strong>实现模块不需要引入即可直接使用</strong>。</p></blockquote> <h2 id="八、webpack优化"><a href="#八、webpack优化" class="header-anchor">#</a> 八、⭐️webpack优化</h2> <h3 id="①-noparse"><a href="#①-noparse" class="header-anchor">#</a> ① noParse</h3> <p>该配置是<strong>作为module的一个属性值</strong>，即<strong>不解析某些模块</strong>，所谓不解析，就是<strong>不去分析某个模块中的依赖关系，即不去管某个文件是否import(依赖)了某个文件</strong>，对于一些独立的库，比如jquery，其根本不存在依赖关系，jquery不会去引入其他的库(<strong>要根据自己对某个模块的了解去判断是否要解析该模块</strong>)，所以我们可以让webpack不去解析jquery的依赖关系，提高打包速度，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        noParse<span class="token punctuation">:</span><span class="token regex">/jquery/</span><span class="token punctuation">,</span><span class="token comment">//不去解析jquery中的依赖库</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>noParse是<strong>module配置中的一个属性</strong>，其属性值为一个正则表达式，<strong>填入不被解析的模块名称</strong>。</p></blockquote> <p>为了更清楚的展示noParse的作用，假设我们在入口文件index.js中引入bar.js模块，<strong>同时这个bar.js模块中也引入了foo.js模块</strong>，foo.js不再依赖其他模块了，那么在不使用noParse的情况下，webpack打包的时候，会先去分析index.js模块，发现其引入了bar.js模块，然后接着分析bar.js模块，<strong>发现其引入了foo.js模块，接着分析foo.js模块</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Entrypoint index <span class="token operator">=</span> index<span class="token punctuation">.</span>js
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>bar<span class="token punctuation">.</span>js<span class="token punctuation">]</span> <span class="token number">55</span> bytes <span class="token punctuation">{</span>index<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>foo<span class="token punctuation">.</span>js<span class="token punctuation">]</span> <span class="token number">21</span> bytes <span class="token punctuation">{</span>index<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">]</span> <span class="token number">81</span> bytes <span class="token punctuation">{</span>index<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>而此时如果使用了<strong>noParse: /bar/</strong>，那么webpack打包的时候，会先去分析index.js模块，发现其引入了bar.js模块，但是由于noParse的作用，<strong>将不再继续解析bar.js模块了，即不会去分析bar.js中引入的foo.js模块了</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Entrypoint index <span class="token operator">=</span> index<span class="token punctuation">.</span>js
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>bar<span class="token punctuation">.</span>js<span class="token punctuation">]</span> <span class="token number">55</span> bytes <span class="token punctuation">{</span>index<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">]</span> <span class="token number">81</span> bytes <span class="token punctuation">{</span>index<span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="②-exclude"><a href="#②-exclude" class="header-anchor">#</a> ② exclude</h3> <p>在loader中使用exclude排除对某些目录中的文件处理，即<strong>引入指定目录下的文件时候，不使用对应的loader进行处理</strong>，exclude是loader配置中的一个属性，属性值为正则表达式，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">]</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="③-ignoreplugin"><a href="#③-ignoreplugin" class="header-anchor">#</a> <strong>③</strong> IgnorePlugin</h3> <p>使用<strong>IgnorePlugin</strong>来<strong>忽略某个模块中某些目录中的模块引用</strong>，比如在引入某个模块的时候，该模块会引入大量的语言包，而我们不会用到那么多语言包，如果都打包进项目中，那么就会影响打包速度和最终包的大小，然后再引入需要使用的语言包即可，如:
项目根目录下有一个time包，其中有一个lang包，lang包中包含了各种语言输出对应时间的js文件，time
包下的index.js会引入lang包下所有的js文件，那么当我们引入time模块的时候，就会将lang包下的所有js文件都打包进去，添加如下配置:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>IgnorePlugin</span><span class="token punctuation">(</span><span class="token regex">/lang/</span><span class="token punctuation">,</span> <span class="token regex">/time/</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>引入time模块的时候，如果time模块中引入了其中的lang模块中的内容，那么就忽略掉，即不引入lang模块中的内容，需要注意的是，<strong>这/time/只是匹配文件夹和time模块的具体目录位置无关，即只要是引入了目录名为time中的内容就会生效</strong>。</p></blockquote> <h3 id="④-使用happypack"><a href="#④-使用happypack" class="header-anchor">#</a> ④ 使用HappyPack</h3> <p>由于在打包过程中有大量的文件<strong>需要交个loader进行处理</strong>，包括<strong>解析</strong>和<strong>转换</strong>等操作，而由于js是单线程的，所以这些文件<strong>只能一个一个地处理</strong>，而HappyPack的工作原理就是<strong>充分发挥CPU的多核功能，将任务分解给多个子进程去并发执行，子进程处理完后再将结果发送给主进程</strong>，happypack主要起到一个<strong>任务劫持</strong>的作用，在创建HappyPack实例的时候要<strong>传入对应文件的loader</strong>，即<strong>use部分</strong>，<strong>loader配置中将使用经过HappyPack包装后的loader进行处理</strong>，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> HappyPack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;happypack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 安装并引入happypack模块</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 这里对处理css文件的loader进行包装</span>
            id<span class="token punctuation">:</span> <span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span><span class="token comment">// 之前的loader根据具体的id进行引入</span>
            use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            threads<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment">// 设置开启的进程数</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> <span class="token comment">// 匹配以.css结尾的文件</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;happypack/loader?id=css&quot;</span><span class="token punctuation">]</span> <span class="token comment">//根据happypack实例中配置的id引入包装后的laoder，这里的happyPack的h可以大写也可以小写</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><blockquote><p>webpack要打包的文件非常多的时候才需要使用happypack进行优化，因为<strong>开启多进程也是需要耗时间的，所以文件少的时候，使用happypack返回更耗时</strong></p></blockquote> <h3 id="⑤-抽离公共模块"><a href="#⑤-抽离公共模块" class="header-anchor">#</a> ⑤ 抽离公共模块</h3> <p>对于多入口情况，如果某个或某些模块，<strong>被两个以上文件所依赖</strong>，那么可以将这个模块单独抽离出来，<strong>不需要将这些公共的代码都打包进每个输出文件中</strong>，这样会造成代码的重复和流量的浪费，即如果有两个入口文件index.js和other.js，它们都依赖了foo.js，那么如果不抽离公共模块，那么<strong>foo.js中的代码都会打包进最终输出的index.js和other.js中去</strong>，即有两份foo.js了。抽离公共模块也很简单，<strong>直接在optimization中配置即可</strong>，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
     splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 分割代码块，即抽离公共模块</span>
         cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 缓存组</span>
             common<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 组名为common可自定义</span>
                    chunks<span class="token punctuation">:</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">,</span>
                    minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 文件大小为0字节以上才抽离</span>
                    minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 被引用过两次才抽离</span>
                    name<span class="token punctuation">:</span> <span class="token string">&quot;common/foo&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 定义抽离出的文件的名称</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>这样就会将公共的foo.js模块抽离到common目录下foo.js中了，但是如果我们也有多个文件依赖了第三方模块如jquery，如果按以上配置，那么jquery也会被打包进foo.js中，<strong>会导致代码混乱</strong>，所以我们希望将jquery单独抽出来，即与foo.js分开，我们可以复制一份以上配置，并通过设置抽离代码权重的方式来实现，即优先抽离出jquery，如:</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
     splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 分割代码块，即抽离公共模块</span>
         cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 缓存组</span>
             common<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// 组名为common可自定义</span>
                    chunks<span class="token punctuation">:</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">,</span>
                    minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 文件大小为0字节以上才抽离</span>
                    minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 被引用过两次才抽离</span>
                    name<span class="token punctuation">:</span> <span class="token string">&quot;common/foo&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 定义抽离出的文件的名称</span>
             <span class="token punctuation">}</span><span class="token punctuation">,</span>
             verdor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    test<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
                    priority<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 设置打包权重，即优先抽离第三方模块</span>
                    chunks<span class="token punctuation">:</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">,</span>
                    minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 文件大小为0字节以上才抽离</span>
                    minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 被引用过两次才抽离</span>
                    name<span class="token punctuation">:</span> <span class="token string">&quot;common/jquery&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 定义抽离出的文件的名称</span>
                <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>这样就会在common目录下同时抽离出foo.js和jquery.js了，需要注意的是，代码的抽离<strong>必须是该模块没有被排除打包，即该模块会被打包进输出bundle中</strong>，如果第三方模块已经通过externals排除打包，则以上vendor配置无效。</p></blockquote> <h3 id="⑥-按需加载"><a href="#⑥-按需加载" class="header-anchor">#</a> ⑥ 按需加载</h3> <p>即在需要使用的时候才打包输出，<strong>webpack提供了import()方法，传入要动态加载的模块，来动态加载指定的模块</strong>，当webpack遇到import()语句的时候，不会立即去加载该模块，而是在用到该模块的时候，再去加载，也就是说<strong>打包的时候会一起打包出来</strong>，但是<strong>在浏览器中加载的时候并不会立即加载</strong>，而是等到用到的时候再去加载，比如，点击按钮后才会加载某个模块，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;点我&quot;</span>
button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 点击按钮后加载foo.js</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// import()返回的是一个Promise对象</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>从中可以看到，import()返回的是一个Promise对象，其主要就是利用JSONP实现动态加载，返回的res结果不同的export方式会有不同，如果使用的module.exports输出，那么返回的res就是module.exports输出的结果；如果使用的是ES6模块输出，即export default输出，那么返回的res结果就是res.default，如:</p></blockquote> <p>// ES6模块输出，res结果为</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> __esModule<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token function">Symbol</span><span class="token punctuation">(</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token string">&quot;Module&quot;</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="⑦-开启模块热更新"><a href="#⑦-开启模块热更新" class="header-anchor">#</a> ⑦ 开启模块热更新</h3> <p>模块热更新可以做到在不刷新网页的情况下，更新修改的模块，<strong>只编译变化的模块，而不用全部模块重新打包</strong>，大大提高开发效率，在未开启热更新的情况下，每次修改了模块，都会重新打包。要开启模块热更新，那么<strong>只需要在devServer配置中添加hot:true</strong>即可。当然仅仅开启模块热更新是不够的，我们需要做一些类似监听的操作，当监听的模块发生变化的时候，重新加载该模块并执行，如:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        hot<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 开启热更新</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>


<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">&quot;./foo&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">&quot;./foo&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 监听到foo模块发生变化的时候</span>
        <span class="token keyword">const</span> foo <span class="token operator">=</span>  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 重新引入该模块并执行</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><p><strong>如果不使用module.hot.accept监听</strong>，那么当修改foo模块的时候还是会刷新页面的。</p></blockquote> <p>(以下内容来源于公众号：前端瓶子君 ，作者瓶子君)</p> <h3 id="⑧thread-loader（webpack4-官方推荐）"><a href="#⑧thread-loader（webpack4-官方推荐）" class="header-anchor">#</a> ⑧<strong>thread-loader</strong>（webpack4 官方推荐）</h3> <p>把这个 loader 放置在其他 loader 之前， 放置在这个 loader 之后的 loader 就会在一个单独的 worker【worker pool】 池里运行，一个worker 就是一个nodeJS 进程【node.js proces】，每个单独进程处理时间上限为600ms，各个进程的数据交换也会限制在这个时间内。</p> <p>thread-loader 使用起来也非常简单，只要把 thread-loader 放置在其他 loader 之前， 那 thread-loader 之后的 loader 就会在一个单独的 worker 池(worker pool)中运行。</p> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        <span class="token comment">// 创建一个 js worker 池</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span> 
          <span class="token string">'thread-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'babel-loader'</span>
        <span class="token punctuation">]</span> 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.s?css$/</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        <span class="token comment">// 创建一个 css worker 池</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'thread-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              modules<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              localIdentName<span class="token punctuation">:</span> <span class="token string">'[name]__[local]--[hash:base64:5]'</span><span class="token punctuation">,</span>
              importLoaders<span class="token punctuation">:</span> <span class="token number">1</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">]</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>注意：thread-loader 放在了 style-loader 之后，这是因为 thread-loader 没法存取文件也没法获取 webpack 的选项设置。</p> <p>官方上说每个 worker 大概都要花费 600ms ，所以官方为了防止启动 worker 时的高延迟，提供了对 worker 池的优化：<strong>预热</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ...</span>
<span class="token keyword">const</span> threadLoader <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'thread-loader'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> jsWorkerPool <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// options</span>

  <span class="token comment">// 产生的 worker 的数量，默认是 (cpu 核心数 - 1)</span>
  <span class="token comment">// 当 require('os').cpus() 是 undefined 时，则为 1</span>
  workers<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>

  <span class="token comment">// 闲置时定时删除 worker 进程</span>
  <span class="token comment">// 默认为 500ms</span>
  <span class="token comment">// 可以设置为无穷大， 这样在监视模式(--watch)下可以保持 worker 持续存在</span>
  poolTimeout<span class="token punctuation">:</span> <span class="token number">2000</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cssWorkerPool <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 一个 worker 进程中并行执行工作的数量</span>
  <span class="token comment">// 默认为 20</span>
  workerParallelJobs<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  poolTimeout<span class="token punctuation">:</span> <span class="token number">2000</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

threadLoader<span class="token punctuation">.</span><span class="token function">warmup</span><span class="token punctuation">(</span>jsWorkerPool<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
threadLoader<span class="token punctuation">.</span><span class="token function">warmup</span><span class="token punctuation">(</span>cssWorkerPool<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'thread-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> jsWorkerPool
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'babel-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.s?css$/</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'thread-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> cssWorkerPool
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              modules<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              localIdentName<span class="token punctuation">:</span> <span class="token string">'[name]__[local]--[hash:base64:5]'</span><span class="token punctuation">,</span>
              importLoaders<span class="token punctuation">:</span> <span class="token number">1</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">]</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><p><strong>注意：请仅在耗时的 loader 上使用。</strong></p> <h3 id="⑨合理利用缓存（缩短连续构建时间，增加初始构建时间）"><a href="#⑨合理利用缓存（缩短连续构建时间，增加初始构建时间）" class="header-anchor">#</a> ⑨合理利用缓存（缩短连续构建时间，增加初始构建时间）</h3> <p>使用 webpack 缓存的方法有几种，例如使用 <code>cache-loader</code>，<code>HardSourceWebpackPlugin</code> 或 <code>babel-loader</code> 的 <code>cacheDirectory</code> 标志。所有这些缓存方法都有启动的开销。重新运行期间在本地节省的时间很大，但是初始（冷）运行实际上会更慢。</p> <p>如果你的项目生产版本每次都必须进行初始构建的话，缓存会增加构建时间，减慢你的速度。如果不是，那它们就会大大缩减你二次构建的时间。</p> <h4 id="_1-cache-loader"><a href="#_1-cache-loader" class="header-anchor">#</a> 1. cache-loader</h4> <p>cache-loader 和 thread-loader 一样，使用起来也很简单，仅仅需要在一些性能开销较大的 loader 之前添加此 loader，以将结果缓存到磁盘里，显著提升二次构建速度。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.ext$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'cache-loader'</span><span class="token punctuation">,</span> <span class="token operator">...</span>loaders<span class="token punctuation">]</span><span class="token punctuation">,</span>
        include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>⚠️ 请注意，保存和读取这些缓存文件会有一些时间开销，所以请只对性能开销较大的 loader 使用此 loader。</strong></p> <h4 id="_2-hardsourcewebpackplugin"><a href="#_2-hardsourcewebpackplugin" class="header-anchor">#</a> 2. HardSourceWebpackPlugin</h4> <ul><li>第一次构建将花费正常的时间</li> <li>第二次构建将显着加快（大概提升90%的构建速度）。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> HardSourceWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'hard-source-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> clientWebpackConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// cacheDirectory是在高速缓存写入。默认情况下，将缓存存储在node_modules下的目录中</span>
      <span class="token comment">// 'node_modules/.cache/hard-source/[confighash]'</span>
      cacheDirectory<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./lib/.cache/hard-source/[confighash]'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// configHash在启动webpack实例时转换webpack配置，</span>
      <span class="token comment">// 并用于cacheDirectory为不同的webpack配置构建不同的缓存</span>
      <span class="token function-variable function">configHash</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">webpackConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// node-object-hash on npm can be used to build this.</span>
        <span class="token keyword">return</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node-object-hash'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>sort<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>webpackConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 当加载器、插件、其他构建时脚本或其他动态依赖项发生更改时，</span>
      <span class="token comment">// hard-source需要替换缓存以确保输出正确。</span>
      <span class="token comment">// environmentHash被用来确定这一点。如果散列与先前的构建不同，则将使用新的缓存</span>
      environmentHash<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        root<span class="token punctuation">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        directories<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        files<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'package-lock.json'</span><span class="token punctuation">,</span> <span class="token string">'yarn.lock'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// An object. 控制来源</span>
      info<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 'none' or 'test'.</span>
        mode<span class="token punctuation">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
        <span class="token comment">// 'debug', 'log', 'info', 'warn', or 'error'.</span>
        level<span class="token punctuation">:</span> <span class="token string">'debug'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// Clean up large, old caches automatically.</span>
      cachePrune<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// Caches younger than `maxAge` are not considered for deletion. They must</span>
        <span class="token comment">// be at least this (default: 2 days) old in milliseconds.</span>
        maxAge<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
        <span class="token comment">// All caches together must be larger than `sizeThreshold` before any</span>
        <span class="token comment">// caches will be deleted. Together they must be at least this</span>
        <span class="token comment">// (default: 50 MB) big in bytes.</span>
        sizeThreshold<span class="token punctuation">:</span> <span class="token number">50</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin<span class="token punctuation">.</span>ExcludeModulePlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/.*\.DS_Store/</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h3 id="⑩优化压缩时间"><a href="#⑩优化压缩时间" class="header-anchor">#</a> ⑩优化压缩时间</h3> <p>webpack4 默认内置使用 <code>terser-webpack-plugin</code> 插件压缩优化代码，而该插件使用 <code>terser</code> 来缩小  <code>JavaScript</code> 。</p> <h5 id="terser-是什么？"><a href="#terser-是什么？" class="header-anchor">#</a> terser 是什么？</h5> <p>所谓 terser，官方给出的定义是：</p> <blockquote><p>用于 ES6+ 的 JavaScript 解析器、mangler/compressor（压缩器）工具包。</p></blockquote> <p>为什么 webpack 选择 terser？</p> <blockquote><p>不再维护 uglify-es ，并且 uglify-js 不支持 ES6 +。</p> <p>terser 是 uglify-es 的一个分支，主要保留了与 uglify-es 和 uglify-js@3 的 API 和 CLI 兼容性。</p></blockquote> <h5 id="terser-启动多进程"><a href="#terser-启动多进程" class="header-anchor">#</a> terser 启动多进程</h5> <p>使用多进程并行运行来提高构建速度。并发运行的默认数量为 <code>os.cpus().length - 1</code> 。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        parallel<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>可以显著加快构建速度，因此强烈推荐开启多进程</strong></p> <h3 id="⑪优化搜索时间-缩小文件搜索范围-减小不必要的编译工作"><a href="#⑪优化搜索时间-缩小文件搜索范围-减小不必要的编译工作" class="header-anchor">#</a> ⑪优化搜索时间- 缩小文件搜索范围 减小不必要的编译工作</h3> <p>webpack 打包时，会从配置的 <code>entry</code> 触发，解析入口文件的导入语句，再递归的解析，在遇到导入语句时 webpack 会做两件事情：</p> <ul><li>根据导入语句去寻找对应的要导入的文件。例如 <code>require('react')</code> 导入语句对应的文件是 <code>./node_modules/react/react.js</code>，<code>require('./util')</code> 对应的文件是 <code>./util.js</code>。</li> <li>根据找到的要导入文件的后缀，使用配置中的 Loader 去处理文件。例如使用 ES6 开发的 JavaScript 文件需要使用 babel-loader 去处理。</li></ul> <p>以上两件事情虽然对于处理一个文件非常快，但是当项目大了以后文件量会变的非常多，这时候构建速度慢的问题就会暴露出来。虽然以上两件事情无法避免，但需要尽量减少以上两件事情的发生，以提高速度。</p> <p>接下来一一介绍可以优化它们的途径。</p> <h4 id="_1-优化-loader-配置"><a href="#_1-优化-loader-配置" class="header-anchor">#</a> 1. 优化 loader 配置</h4> <p>使用 Loader 时可以通过 <code>test</code> 、 <code>include</code> 、 <code>exclude</code> 三个配置项来命中 Loader 要应用规则的文件</p> <h4 id="_2-优化-resolve-module-配置"><a href="#_2-优化-resolve-module-配置" class="header-anchor">#</a> 2. 优化 resolve.module 配置</h4> <p><code>resolve.modules</code> 用于配置 webpack 去哪些目录下寻找第三方模块，<code>resolve.modules</code> 的默认值是 <code>['node_modules']</code> ，含义是先去当前目录下的 <code>./node_modules</code> 目录下去找想找的模块，如果没找到就去上一级目录 <code>../node_modules</code> 中找，再没有就去 <code>../../node_modules</code> 中找，以此类推。</p> <h4 id="_3-优化-resolve-alias-配置"><a href="#_3-优化-resolve-alias-配置" class="header-anchor">#</a> 3. 优化 resolve.alias 配置</h4> <p><code>resolve.alias</code> 配置项通过别名来把原导入路径映射成一个新的导入路径，减少耗时的递归解析操作。</p> <h4 id="_4-优化-resolve-extensions-配置"><a href="#_4-优化-resolve-extensions-配置" class="header-anchor">#</a> 4. 优化 resolve.extensions 配置</h4> <p>在导入语句没带文件后缀时，webpack 会根据 resolve.extension 自动带上后缀后去尝试询问文件是否存在，所以在配置 <code>resolve.extensions</code> 应尽可能注意以下几点：</p> <ul><li><code>resolve.extensions</code> 列表要尽可能的小，不要把项目中不可能存在的情况写到后缀尝试列表中。</li> <li>频率出现最高的文件后缀要优先放在最前面，以做到尽快的退出寻找过程。</li> <li>在源码中写导入语句时，要尽可能的带上后缀，从而可以避免寻找过程。</li></ul> <h4 id="_5-优化-resolve-mainfields-配置"><a href="#_5-优化-resolve-mainfields-配置" class="header-anchor">#</a> 5. 优化 resolve.mainFields 配置</h4> <p>有一些第三方模块会针对不同环境提供几分代码。例如分别提供采用 ES5 和 ES6 的2份代码，这2份代码的位置写在 <code>package.json</code> 文件里，如下：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;jsnext:main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es/index.js&quot;</span><span class="token punctuation">,</span><span class="token comment">// 采用 ES6 语法的代码入口文件</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib/index.js&quot;</span> <span class="token comment">// 采用 ES5 语法的代码入口文件</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>webpack 会根据 <code>mainFields</code> 的配置去决定优先采用那份代码，<code>mainFields</code> 默认如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'browser'</span><span class="token punctuation">,</span> <span class="token string">'main'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>webpack 会按照数组里的顺序去 <code>package.json</code> 文件里寻找，只会使用找到的第一个。</p> <p>假如你想优先采用 ES6 的那份代码，可以这样配置：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mainFields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'jsnext:main'</span><span class="token punctuation">,</span> <span class="token string">'browser'</span><span class="token punctuation">,</span> <span class="token string">'main'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_6-优化-module-noparse-配置"><a href="#_6-优化-module-noparse-配置" class="header-anchor">#</a> 6. 优化 module.noParse 配置</h4> <p><code>module.noParse</code> 配置项可以让 Webpack 忽略对部分没采用模块化的文件的递归解析处理，这样做的好处是能提高构建性能。原因是一些库，例如 jQuery 、ChartJS， 它们庞大又没有采用模块化标准，让 Webpack 去解析这些文件耗时又没有意义。</p> <h4 id="_7-详细配置"><a href="#_7-详细配置" class="header-anchor">#</a> 7. 详细配置</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 编译代码的基础配置</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 项目中使用的 jquery 并没有采用模块化标准，webpack 忽略它</span>
    noParse<span class="token punctuation">:</span> <span class="token regex">/jquery/</span><span class="token punctuation">,</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 这里编译 js、jsx</span>
        <span class="token comment">// 注意：如果项目源码中没有 jsx 文件就不要写 /\.jsx?$/，提升正则表达式性能</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(js|jsx)$/</span><span class="token punctuation">,</span>
        <span class="token comment">// babel-loader 支持缓存转换出的结果，通过 cacheDirectory 选项开启</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 排除 node_modules 目录下的文件</span>
        <span class="token comment">// node_modules 目录下的文件都是采用的 ES5 语法，没必要再通过 Babel 去转换</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置模块导入规则，import/require时会直接在这些目录找文件</span>
    <span class="token comment">// 可以指明存放第三方模块的绝对路径，以减少寻找</span>
    modules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>project<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/client/components</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
      path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'h5_commonr/components'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
      <span class="token string">'node_modules'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// import导入时省略后缀</span>
    <span class="token comment">// 注意：尽可能的减少后缀尝试的可能性</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.react.js'</span><span class="token punctuation">,</span> <span class="token string">'.css'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// import导入时别名，减少耗时的递归解析操作</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'@compontents'</span><span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>project<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/compontents</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>以上就是所有和缩小文件搜索范围相关的构建性能优化了，在根据自己项目的需要去按照以上方法改造后，你的构建速度一定会有所提升。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">4/6/2020, 10:42:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nipingd/font/webpack/webpack面试题.html" class="prev">webpack面试题</a></span> <span class="next"><a href="/nipingd/font/其他/Nginx反向代理与负载均衡.html">Nginx反向代理与负载均衡</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/nipingd/assets/js/app.99af4659.js" defer></script><script src="/nipingd/assets/js/2.be962301.js" defer></script><script src="/nipingd/assets/js/101.27e563c2.js" defer></script>
  </body>
</html>
